/*
  filename: integralui.listview.js
  version : 1.6.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(g,b){function a(){this.constructor=g}for(var d in b)b.hasOwnProperty(d)&&(g[d]=b[d]);g.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)},__decorate=this&&this.__decorate||function(g,b,a,d){var f=arguments.length,c=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,a):d,e;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)c=Reflect.decorate(g,b,a,d);else for(var h=g.length-1;0<=h;h--)if(e=g[h])c=(3>f?e(c):3<f?e(b,a,c):
e(b,a))||c;return 3<f&&c&&Object.defineProperty(b,a,c),c},__metadata=this&&this.__metadata||function(g,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(g,b)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),integralui_dragdrop_service_1=require("../services/integralui.dragdrop.service"),
integralui_filter_service_1=require("../services/integralui.filter.service"),integralui_base_list_1=require("./integralui.base.list"),integralui_listitem_1=require("./integralui.listitem"),IntegralUIListView=function(g){function b(a,d,f,c,b,h,k,l){var e=g.call(this,a,d,f,c,b,h)||this;e.dataService=a;e.dragDropService=d;e.elemRef=f;e.elemRenderer=c;e.commonService=b;e.filterService=h;e.cmpResolver=k;e.baseService=l;e.clientSpace={width:0,height:0};e.contentPos={top:0,left:0};e.currentItemSize={width:0,
height:0};e.itemsPerColumn=0;e.itemsPerRow=0;e.numColumns=0;e.numRows=0;e.currentScrollMode=integralui_core_1.IntegralUIScrollMode.Horizontal;e.overflowSettings={horizontal:"auto",vertical:"auto"};e.trialRef=null;e.itemList=[];return e}__extends(b,g);Object.defineProperty(b.prototype,"itemSize",{get:function(){return this.currentItemSize},set:function(a){a&&(this.currentItemSize={width:0<a.width?a.width+4:0,height:0<a.height?a.height+4:0},this.updateLayout())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"scrollMode",{get:function(){return this.currentScrollMode},set:function(a){this.currentScrollMode!=a&&(this.currentScrollMode=a,this.contentPos={top:0,left:0},this.currentIndex=0,this.currentScrollPos={x:0,y:0},this.updateLayout())},enumerable:!0,configurable:!0});b.prototype.updateOverflowSettings=function(){this.overflowSettings=0!=this.virtualMode?{horizontal:"hidden",vertical:"hidden"}:this.currentScrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?{horizontal:"auto",vertical:"hidden"}:
{horizontal:"hidden",vertical:"auto"}};b.prototype.ngOnInit=function(){this.baseService.setComponent(this);this.updateData();this.updateCurrentList();this.generalClassName="iui-listview";this.itemClassName="iui-listitem";this.itemContentClassName=this.itemClassName+"-content";this.initStyle()};b.prototype.updateData=function(){this.dataService.init([{data:this.items}])};b.prototype.ngAfterViewInit=function(){var a=this,d=setTimeout(function(){var f=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);
f&&a.contentRef&&(a.trialRef=a.contentRef.createComponent(f));clearTimeout(d)},100)};b.prototype.ngAfterContentInit=function(){this.updateLayout()};b.prototype.ngOnDestroy=function(){this.removeDropMark();this.resetLayoutTimer();this.trialRef&&this.trialRef.destroy()};b.prototype.ngAfterContentChecked=function(){this.clientRect={width:this.elemRef.nativeElement.firstElementChild.clientWidth,height:this.elemRef.nativeElement.firstElementChild.clientHeight};this.clientRect.width!=this.prevClientRect.width?
(this.updateLayout(),this.prevClientRect.width=this.clientRect.width):this.clientRect.height!=this.prevClientRect.height&&(this.updateLayout(),this.prevClientRect.height=this.clientRect.height)};b.prototype.addItem=function(a){this.callEventAdd("add",a)};b.prototype.clearItems=function(){this.dataService.clear();this.clear.emit(null)};b.prototype.insertItemAt=function(a,d){this.callEventAdd("at",a,d)};b.prototype.removeItemAt=function(a){return this.callEventRemove(null,a)};b.prototype.itemDragOver=
function(a,d,f,c){if(this.isEnabled){var b=this.getItemElemList();b&&0<=f&&f<b.length&&(f=this.commonService.getPageRect(b[f].nativeElement),this.processDragOver(a,d.data,{x:f.left,y:f.top,width:f.right-f.left,height:f.bottom-f.top},c))}a.stopPropagation()};b.prototype.updateCurrentList=function(){var a=this;a.currentList.length=0;var d=a.dataService.getList();d&&(a.applySorting(d),d.forEach(function(d){a.addItemToCurrentList(d)}))};b.prototype.addItemToCurrentList=function(a){a.type="item";a[this.options.dataFields.id]||
(a[this.options.dataFields.id]=this.commonService.getUniqueId());this.isItemAllowed(a)&&this.currentList.push({data:a})};b.prototype.updateScrollItemList=function(){this.scrollItemList.length=0;for(var a={x:0,y:0},d=0,b=this.currentIndex;b<this.currentList.length&&b<this.currentIndex+this.visibleRange;b++,d++){var c=this.currentList[b];c={data:c.data,index:b-this.currentIndex,position:{x:0,y:0},inlineStyle:this.getItemInlineStyle(c),style:{},tabIndex:d};this.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?
(a.y+this.currentItemSize.height>this.clientSpace.height&&(a={x:a.x+this.currentItemSize.width,y:0}),c.position={x:a.x,y:a.y},a.y+=this.currentItemSize.height):(a.x+this.currentItemSize.width>this.clientSpace.width&&(a={x:0,y:a.y+this.currentItemSize.height}),c.position={x:a.x,y:a.y},a.x+=this.currentItemSize.width);this.updateItemStyle(c);this.scrollItemList.push(c)}};b.prototype.getItem=function(a){return this.items&&(this.updateItemList(),a=this.itemList.indexOf(a),0<=a&&a<this.items.length)?this.items[a]:
null};b.prototype.getItemFromComponent=function(a){return a&&a.data?a.data:this.items&&(this.updateItemList(),a=this.itemList.indexOf(a),0<=a&&a<this.items.length)?this.items[a]:null};b.prototype.getItemIndex=function(a){return this.itemList&&0<this.itemList.length?this.itemList.indexOf(a):-1};b.prototype.updateItemList=function(){this.contentList&&(this.itemList=this.contentList.toArray())};b.prototype.invokeEvent=function(a,d){if(this.isEnabled&&d)switch(a){case "ITEM_HOVER":this.itemHover.emit({item:d})}return!0};
b.prototype.processDownArrowKey=function(a,d){var b=this.getDownItem(a);if(b){this.currentFocusItem=b.data;var c=this,e=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(e)},1),h=Math.floor(this.visibleRange/2);c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?b.index>=h-this.itemsPerColumn&&this.scrollPos({x:this.currentScrollPos.x+this.itemSize.width,y:this.currentScrollPos.y}):b.index>=h-this.itemsPerRow&&this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y+
this.itemSize.height})}return b};b.prototype.processEndKey=function(a,d){var b=null,c=this;0<c.scrollItemList.length&&(c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?c.scrollPos({x:c.maxScrollPos.x,y:c.currentScrollPos.y}):c.scrollPos({x:c.currentScrollPos.x,y:c.maxScrollPos.y}),setTimeout(function(){b=c.scrollItemList[c.scrollItemList.length-1];c.currentFocusItem=b.data;var a=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(a)},1)},1));return b};b.prototype.processHomeKey=
function(a,d){var b=null,c=this;0<c.scrollItemList.length&&(c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?c.scrollPos({x:0,y:c.currentScrollPos.y}):c.scrollPos({x:c.currentScrollPos.x,y:0}),setTimeout(function(){b=c.scrollItemList[0];c.currentFocusItem=b.data;var a=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(a)},1)},1));return b};b.prototype.processLeftArrowKey=function(a,d){var b=this.getLeftItem(a);if(b){this.currentFocusItem=b.data;var c=this,e=setTimeout(function(){c.processSelection(d,
b.data);clearTimeout(e)},1);c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?b.index<this.itemsPerColumn&&this.scrollPos({x:this.currentScrollPos.x-this.itemSize.width,y:this.currentScrollPos.y}):b.index<this.itemsPerRow&&this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y-this.itemSize.height})}return b};b.prototype.processPageDownKey=function(a,d){var b=null,c=this;if(0<c.scrollItemList.length){var e=0;c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?
(e=Math.floor((this.visibleRange-2*this.itemsPerColumn)/2),0<c.itemsPerColumn&&c.scrollPos({x:c.currentScrollPos.x+Math.floor(e*c.itemSize.width/this.itemsPerColumn),y:c.currentScrollPos.y})):(e=Math.floor((this.visibleRange-2*this.itemsPerRow)/2),0<c.itemsPerRow&&c.scrollPos({x:c.currentScrollPos.x,y:c.currentScrollPos.y+Math.floor(e*c.itemSize.height/this.itemsPerRow)}));setTimeout(function(){var e=0<=a.index&&a.index<c.scrollItemList.length?a.index:c.scrollItemList.length-1;e=c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?
c.currentScrollPos.x==c.maxScrollPos.x?c.scrollItemList.length-1:e:c.currentScrollPos.y==c.maxScrollPos.y?c.scrollItemList.length-1:e;b=c.scrollItemList[e];c.currentFocusItem=b.data;var f=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(f)},1)},1)}return b};b.prototype.processPageUpKey=function(a,d){var b=null,c=this;if(0<c.scrollItemList.length){var e=0;c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?(e=Math.floor((this.visibleRange-2*this.itemsPerColumn)/2),0<c.itemsPerColumn&&
c.scrollPos({x:c.currentScrollPos.x-Math.floor(e*c.itemSize.width/this.itemsPerColumn),y:c.currentScrollPos.y})):(e=Math.floor((this.visibleRange-2*this.itemsPerRow)/2),0<c.itemsPerRow&&c.scrollPos({x:c.currentScrollPos.x,y:c.currentScrollPos.y-Math.floor(e*c.itemSize.height/this.itemsPerRow)}));setTimeout(function(){var e=0<=a.index&&a.index<c.scrollItemList.length?a.index:0;e=c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?0==c.currentScrollPos.x?0:e:0==c.currentScrollPos.y?0:e;
b=c.scrollItemList[e];c.currentFocusItem=b.data;var f=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(f)},1)},1)}return b};b.prototype.processRightArrowKey=function(a,b){var d=this.getRightItem(a);if(d){this.currentFocusItem=d.data;var c=this,e=setTimeout(function(){c.processSelection(b,d.data);clearTimeout(e)},1),h=Math.floor(this.visibleRange/2);c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?d.index>=h-this.itemsPerColumn&&this.scrollPos({x:this.currentScrollPos.x+
this.itemSize.width,y:this.currentScrollPos.y}):d.index>=h-this.itemsPerRow&&this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y+this.itemSize.height})}return d};b.prototype.processUpArrowKey=function(a,d){var b=this.getUpItem(a);if(b){this.currentFocusItem=b.data;var c=this,e=setTimeout(function(){c.processSelection(d,b.data);clearTimeout(e)},1);c.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?b.index<this.itemsPerColumn&&this.scrollPos({x:this.currentScrollPos.x-this.itemSize.width,
y:this.currentScrollPos.y}):b.index<this.itemsPerRow&&this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y-this.itemSize.height})}return b};b.prototype.getDownItem=function(a){var b=0<=a.index&&a.index<this.scrollItemList.length-1?a.index+1:-1;this.scrollMode!=integralui_core_1.IntegralUIScrollMode.Horizontal&&(b=a.index+this.itemsPerRow,b=0<=b&&b<this.scrollItemList.length?b:-1);return 0<=b?this.scrollItemList[b]:null};b.prototype.getLeftItem=function(a){var b=a.index-this.itemsPerColumn;
b=0<=b&&b<this.scrollItemList.length?b:-1;this.scrollMode!=integralui_core_1.IntegralUIScrollMode.Horizontal&&(b=0<a.index?a.index-1:-1);return 0<=b&&b<this.scrollItemList.length?this.scrollItemList[b]:null};b.prototype.getRightItem=function(a){var b=a.index+this.itemsPerColumn;b=0<=b&&b<this.scrollItemList.length?b:-1;this.scrollMode!=integralui_core_1.IntegralUIScrollMode.Horizontal&&(b=0<=a.index&&a.index<this.scrollItemList.length-1?a.index+1:-1);return 0<=b&&b<this.scrollItemList.length?this.scrollItemList[b]:
null};b.prototype.getUpItem=function(a){var b=0<a.index?a.index-1:-1;this.scrollMode!=integralui_core_1.IntegralUIScrollMode.Horizontal&&(b=a.index-this.itemsPerRow,b=0<=b&&b<this.scrollItemList.length?b:-1);return 0<=b?this.scrollItemList[b]:null};b.prototype.getContentSize=function(){return this.contentElem?{width:this.contentElem.nativeElement.offsetWidth,height:this.contentElem.nativeElement.offsetHeight}:{width:0,height:0}};b.prototype.updateLayout=function(){this.allowUpdate&&(this.updateOverflowSettings(),
0!=this.virtualMode?this.updateLayoutVirtual():this.updateLayoutNormal())};b.prototype.updateLayoutNormal=function(){var a=this;a.resetLayoutTimer();a.updateTimer=setTimeout(function(){a.updateCurrentList();a.updateItemList();if(a.itemList&&0<a.itemList.length){var b={x:0,y:0},f=0,c=0;a.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?a.itemList.forEach(function(c){var d=c.getSize();b.y+d.height>a.elemRef.nativeElement.firstElementChild.clientHeight&&(b={x:b.x+f,y:0},f=0);f<d.width&&
(f=d.width);c.updatePos(b);b.y+=d.height}):a.itemList.forEach(function(d){var e=d.getSize();b.x+e.width>a.elemRef.nativeElement.firstElementChild.clientWidth&&(b={x:0,y:b.y+c},c=0);c<e.height&&(c=e.height);d.updatePos(b);b.x+=e.width})}a.selectedItem&&a.updateSelectedItem(a.selectedItem);a.updateComplete.emit(null);clearTimeout(a.updateTimer)},10)};b.prototype.updateLayoutVirtual=function(){var a=this;a.resetLayoutTimer();a.updateTimer=setTimeout(function(){a.updateCurrentList();0==a.currentList.length&&
(a.currentScrollPos={x:0,y:0});a.clientRect={width:a.elemRef.nativeElement.firstElementChild.clientWidth,height:a.elemRef.nativeElement.firstElementChild.clientHeight};a.updateScrollItemList();var b=setTimeout(function(){a.updateBlockSize();a.avgItemHeight=a.itemSize.height;a.updateScrollSize();a.updateVisibleRange();a.updateScrollItemList();a.refresh();a.updateComplete.emit(null);clearTimeout(b)},1);clearTimeout(a.updateTimer)},100)};b.prototype.updateScrollSize=function(){this.contentSize={width:this.clientRect.width,
height:this.clientRect.height};if(this.currentScrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal){this.itemsPerColumn=Math.floor(this.clientRect.height/this.itemSize.height);var a=0<this.itemsPerColumn?this.currentList.length/this.itemsPerColumn:0;this.numColumns=Math.floor(a);this.numColumns<a&&this.numColumns++;a=this.numColumns*this.itemSize.width-this.clientRect.width+2;0<a&&(this.itemsPerColumn=Math.floor((this.clientRect.height-16)/this.itemSize.height),a=0<this.itemsPerColumn?this.currentList.length/
this.itemsPerColumn:0,this.numColumns=Math.floor(a),this.numColumns<a&&this.numColumns++,a=this.numColumns*this.itemSize.width-this.clientRect.width+2);this.scrollSize.width=a;this.contentSize.width+=this.itemSize.width}else this.itemsPerRow=Math.floor(this.clientRect.width/this.itemSize.width),a=0<this.itemsPerRow?this.currentList.length/this.itemsPerRow:0,this.numRows=Math.floor(a),this.numRows<a&&this.numRows++,a=this.numRows*this.itemSize.height-this.clientRect.height+2,0<a&&(this.itemsPerRow=
Math.floor((this.clientRect.width-16)/this.itemSize.width),a=0<this.itemsPerRow?this.currentList.length/this.itemsPerRow:0,this.numRows=Math.floor(a),this.numRows<a&&this.numRows++,a=this.numRows*this.itemSize.height-this.clientRect.height+2),this.scrollSize.height=a,this.contentSize.height+=this.itemSize.height;this.isVerScrollVisible()&&(this.contentSize.width-=18,0<this.scrollSize.width&&(this.scrollSize.width+=16));this.isHorScrollVisible()&&(this.scrollSize.height+=16);this.scrollSize.width=
0<this.scrollSize.width?this.scrollSize.width:0;this.scrollSize.height=0<this.scrollSize.height?this.scrollSize.height:0;this.maxScrollPos={x:this.scrollSize.width,y:this.scrollSize.height};this.currentScrollPos.x>this.maxScrollPos.x&&this.changeHorizontalScrollPos(this.maxScrollPos.x);this.currentScrollPos.y>this.maxScrollPos.y&&this.changeVerticalScrollPos(this.maxScrollPos.y);this.scrollBarSize={width:this.isVerScrollVisible()?this.clientRect.width-20:this.clientRect.width-4,height:this.isHorScrollVisible()?
this.clientRect.height-20:this.clientRect.height-4};this.scrollLargeChange={x:this.scrollBarSize.width,y:this.scrollBarSize.height};this.clientSpace={width:this.clientRect.width,height:this.clientRect.height};this.isHorScrollVisible()&&(this.clientSpace.height-=16);this.isVerScrollVisible()&&(this.clientSpace.width-=16)};b.prototype.updateVisibleRange=function(){this.visibleRange=1;var a=this.getItemElemList();a&&0<a.length&&(this.visibleRange=this.currentScrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?
2*Math.floor(this.clientSpace.height/this.itemSize.height)*(Math.floor(this.clientSpace.width/this.itemSize.width)+1):2*(Math.floor(this.clientSpace.height/this.itemSize.height)+1)*Math.floor(this.clientSpace.width/this.itemSize.width))};b.prototype.getItemElemList=function(){return this.itemElems?this.itemElems.toArray():null};b.prototype.changeHorizontalScrollPos=function(a){this.currentScrollPos.x=Math.max(0,Math.min(a,this.maxScrollPos.x));this.currentScrollPos.x!=this.prevScrollPos.x&&(this.updateView(),
this.scrollPosChanged.emit({value:this.scrollPos()}),this.prevScrollPos.x=this.currentScrollPos.x)};b.prototype.isVerScrollVisible=function(){return this.virtualMode&&this.currentScrollMode!=integralui_core_1.IntegralUIScrollMode.Horizontal?this.isEnabled&&0<this.scrollSize.height?!0:!1:!1};b.prototype.isHorScrollVisible=function(){return this.virtualMode&&this.currentScrollMode!=integralui_core_1.IntegralUIScrollMode.Vertical?this.isEnabled&&0<this.scrollSize.width?!0:!1:!1};b.prototype.onHorizontalScrollChanged=
function(a){this.changeHorizontalScrollPos(a.value)};b.prototype.updateView=function(){if(this.currentScrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal){var a=Math.floor(this.clientSpace.height/this.itemSize.height),b=Math.floor(this.currentScrollPos.x/this.itemSize.width);this.contentPos.left=this.currentScrollPos.x-b*this.itemSize.width;this.currentIndex=b*a}else a=Math.floor(this.clientSpace.width/this.itemSize.width),b=Math.floor(this.currentScrollPos.y/this.itemSize.height),this.contentPos.top=
this.currentScrollPos.y-b*this.itemSize.height,this.currentIndex=b*a;this.currentIndex!=this.prevIndex&&(this.updateScrollItemList(),this.prevIndex=this.currentIndex)};b.prototype.listViewMouseWheel=function(a){this.isEnabled&&this.processMouseWheel(a,this.scrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal)};b.prototype.scrollTo=function(a){0!=this.virtualMode&&a&&(a=this.getItemCurrentIndex(a),0<=a&&(this.currentScrollMode==integralui_core_1.IntegralUIScrollMode.Horizontal?0<this.itemsPerColumn&&
0<this.itemSize.width&&(a=this.itemSize.width*(a/this.itemsPerColumn-Math.floor(this.clientSpace.width/this.itemSize.width)+1),this.scrollPos({x:a,y:this.currentScrollPos.y})):0<this.itemsPerRow&&0<this.itemSize.height&&(a=this.itemSize.height*(a/this.itemsPerRow-Math.floor(this.clientSpace.height/this.itemSize.height)+1),this.scrollPos({x:this.currentScrollPos.x,y:a})),this.updateLayout()))};b.prototype.clearSelection=function(){this.updateItemList();this.itemList&&0<this.itemList.length&&this.itemList.forEach(function(a){a.state&=
~integralui_core_1.IntegralUIObjectState.selected})};b.prototype.selectItem=function(a){a&&(this.clearSelection(),a.state|=integralui_core_1.IntegralUIObjectState.selected)};b.prototype.updateSelectedItemFromElem=function(a){if(this.itemList&&0<this.itemList.length){var b=-1;a&&(b=this.itemList.indexOf(a));0<=b&&b<this.items.length&&(this.selectedItem=this.items[b])}};b.prototype.updateSelectedItem=function(a){if(this.items&&0<this.items.length){var b=-1;a&&(b=this.items.indexOf(a));0<=b&&b<this.itemList.length&&
this.selectItem(this.itemList[b])}};b.prototype.getControlStyle=function(){var a={cursor:this.ctrlCursor,"overflow-x":this.overflowSettings.horizontal,"overflow-y":this.overflowSettings.vertical};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};b.prototype.getItemInlineStyle=function(a){var b=a.data[this.options.dataFields.style]||{};b.position="absolute";a.position&&(b.top=a.position.y+"px",b.left=a.position.x+"px");
b.width=this.currentItemSize.width-4+"px";b.height=this.currentItemSize.height-4+"px";return b};b.prototype.resetRefresh=function(){this.refreshTimer&&clearTimeout(this.refreshTimer);this.refreshTimer=null};b.prototype.refresh=function(a){this.resetRefresh();if(0!=this.virtualMode)for(this.updateControlClass(),a=0;a<this.scrollItemList.length;a++)this.updateItemStyle(this.scrollItemList[a]);else for(this.updateItemList(),this.clearComponentSelection(),a=0;a<this.currentSelectedItems.length;a++){var b=
this.getItemCurrentIndex(this.currentSelectedItems[a]);this.isComponentIndexInRange(b)&&(this.itemList[b].state|=integralui_core_1.IntegralUIObjectState.selected)}};return b}(integralui_base_list_1.IntegralUIBaseList);__decorate([core_1.ContentChildren(integralui_listitem_1.IntegralUIListItem),__metadata("design:type",core_1.QueryList)],IntegralUIListView.prototype,"contentList",void 0);
__decorate([core_1.ViewChild("content",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUIListView.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("content",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIListView.prototype,"contentElem",void 0);__decorate([core_1.ViewChildren("itemElem",{read:core_1.ElementRef}),__metadata("design:type",core_1.QueryList)],IntegralUIListView.prototype,"itemElems",void 0);
__decorate([core_1.ContentChild(core_1.TemplateRef),__metadata("design:type",Object)],IntegralUIListView.prototype,"itemTemplate",void 0);__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUIListView.prototype,"itemSize",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIListView.prototype,"scrollMode",null);
IntegralUIListView=__decorate([core_1.Component({selector:"iui-listview",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()" (DOMMouseScroll)="listViewMouseWheel($event)" (mousewheel)="listViewMouseWheel($event)" (mouseenter)="onCtrlMouseEnter($event)" (mouseleave)="onCtrlMouseLeave($event)" (dragenter)="ctrlDragEnter($event)" (dragleave)="ctrlDragLeave($event)" (dragover)="ctrlDragOver($event)" (drop)="ctrlDragDrop($event)" (dragend)="ctrlDragEnd($event)" (scroll)="onScroll($event)">\n            <div [ngSwitch]="virtualMode" #content>\n                <span *ngSwitchCase="true">\n\t                <ul (touchstart)="ctrlTouchStart($event)" (touchend)="ctrlTouchEnd($event)" style="position:absolute;margin:0;padding:0;" [ngStyle]="{ \'left\': -contentPos.left + \'px\', \'top\': -contentPos.top + \'px\', width: contentSize.width + \'px\', height: contentSize.height + \'px\' }">\n\t\t\t\t        <li [ngClass]="item.style.general" *ngFor="let item of scrollItemList; let i = index" (click)="itemClickEvent($event, item)" (dblclick)="itemDblClickEvent($event, item)" (contextmenu)="itemRightClickEvent($event, item)" (mousedown)="itemMouseDown($event, item)" (mouseup)="itemMouseUp($event, item)" (mouseenter)="itemMouseEnter($event, item)" (mouseleave)="itemMouseLeave($event, item)" draggable="true" (dragstart)="itemDragStart($event, item)" (dragover)="itemDragOver($event, item, i, true)" (drop)="itemDragDrop($event, item)" [ngStyle]="item.inlineStyle" #itemElem>\n\t\t\t\t            <div [ngClass]="item.style.content" tabindex="{{item.tabIndex}}" [iuiFocus]="item.data == this.currentFocusItem" (focus)="itemGotFocus(item)" (blur)="itemLostFocus(item)" (keydown)="itemKeyDown($event, item)" (keypress)="itemKeyPress($event, item)" (keyup)="itemKeyUp($event, item)">\n\t\t\t\t\t\t\t\t<span [iuiTemplateOutlet]="itemTemplate" [iuiTemplateOutletContext]="{$implicit: (item.data)}"></span>\n\t\t\t\t            </div>\n\t\t\t\t        </li>\n\t\t\t\t    </ul>\n\t\t            <iui-scrollbar *ngIf="isVerScrollVisible()" [enabled]="enabled" [value]="currentScrollPos.y" [max]="maxScrollPos.y" [largeChange]="scrollLargeChange.y" [height]="scrollBarSize.height" (valueChanged)="onVerticalScrollChanged($event)" (scrollStart)="onVerticalScrollStart($event)" (scrollEnd)="onVerticalScrollEnd($event)" #verScroll></iui-scrollbar>\n\t\t            <iui-scrollbar *ngIf="isHorScrollVisible()" [enabled]="enabled" [orientation]="horScrollOrientation" [value]="currentScrollPos.x" [max]="maxScrollPos.x" [width]="scrollBarSize.width" (valueChanged)="onHorizontalScrollChanged($event)" (scrollStart)="onHorizontalScrollStart($event)" (scrollEnd)="onHorizontalScrollEnd($event)" #horScroll></iui-scrollbar>\n\t\t            <div *ngIf="isVerScrollVisible() && isHorScrollVisible()" style="background:#f5f5f5;position:absolute;right:0;bottom:0;width:16px;height:16px;"></div>\n\t            </span>\n                <span *ngSwitchDefault>\n\t\t\t\t\t<ul style="margin:0;padding:0;" #content>\n\t\t\t\t\t\t<ng-content></ng-content>\n\t\t\t\t\t</ul>\n\t            </span>\n            </div>\n\t\t</div>\n\t',
inputs:"allowDrag allowDrop allowFilter allowFocus appRef controlStyle data enabled items name selectedItem sorting state virtualMode".split(" "),outputs:"afterSelect beforeEdit beforeSelect change clear dragEnter dragDrop dragLeave dragOver itemAdding itemAdded itemHover itemRemoving itemRemoved keyDown keyPress keyUp loadComplete scrollPosChanged selectionChanged updateComplete".split(" "),providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService]}),__metadata("design:paramtypes",
[integralui_data_service_1.IntegralUIDataService,integralui_dragdrop_service_1.IntegralUIDragDropService,core_1.ElementRef,core_1.Renderer,integralui_common_service_1.IntegralUICommonService,integralui_filter_service_1.IntegralUIFilterService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],IntegralUIListView);exports.IntegralUIListView=IntegralUIListView;