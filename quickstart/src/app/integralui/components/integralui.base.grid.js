/*
  filename: integralui.base.grid.js
  version : 3.4.0
  Copyright Â© 2016-2020 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var l=function(c,a){l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,d){a.__proto__=d}||function(a,d){for(var b in d)d.hasOwnProperty(b)&&(a[b]=d[b])};return l(c,a)};return function(c,a){function b(){this.constructor=c}l(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}}();Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),integralui_dragdrop_service_1=require("../services/integralui.dragdrop.service"),integralui_filter_service_1=require("../services/integralui.filter.service"),integralui_datepicker_1=require("./integralui.datepicker"),integralui_colorpicker_1=require("./integralui.colorpicker"),
i0=require("@angular/core"),i1=require("../services/integralui.data.service"),i2=require("../services/integralui.dragdrop.service"),i3=require("../services/integralui.common.service"),i4=require("../services/integralui.filter.service"),IntegralUIGridLines;(function(l){l[l.None=0]="None";l[l.Horizontal=1]="Horizontal";l[l.Vertical=2]="Vertical";l[l.Both=3]="Both"})(IntegralUIGridLines=exports.IntegralUIGridLines||(exports.IntegralUIGridLines={}));
var IntegralUIBaseGrid=function(l){function c(a,b,d,c,h,g,f,k){var e=l.call(this,h)||this;e.dataService=a;e.dragDropService=b;e.elemRef=d;e.elemRenderer=c;e.commonService=h;e.filterService=g;e.changeRef=f;e.cmpResolver=k;e.animateColumnSize={width:0,height:0};e.animateRowSize={width:0,height:0};e.prevClickedObj=null;e.headerData=[];e.rowData=[];e.rowHoverData=[];e.rowSelectData=[];e.cellData=[];e.footerData=[];e.completeColumnList=[];e.completeLeftColumnList=[];e.completeRightColumnList=[];e.currentColumnList=
[];e.currentLeftColumnList=[];e.currentRightColumnList=[];e.currentRowList=[];e.dataColumns=[];e.dataRows=[];e.flatCompleteColumnList=[];e.flatCompleteLeftColumnList=[];e.flatCompleteRightColumnList=[];e.flatCurrentColumnList=[];e.flatCurrentLeftColumnList=[];e.flatCurrentRightColumnList=[];e.maxColumnLevels=0;e.options={};e.scrollColumnList=[];e.scrollLeftColumnList=[];e.scrollRightColumnList=[];e.scrollFooterList=[];e.scrollLeftFooterList=[];e.scrollRightFooterList=[];e.scrollRowList=[];e.scrollLeftRowList=
[];e.scrollRightRowList=[];e.columnDataKey="columns";e.rowDataKey="rows";e.dropMarkElem=null;e.dragCmpRef=null;e.dragCmp=null;e.cloneElem=null;e.cloneElemStartPos={x:0,y:0};e.isCtrlDragEntered=!1;e.isFirstDragEnter=!1;e.isDragHandleVisible=!1;e.dragRowList=[];e.targetDropRow=null;e.targetDropPos=-1;e.prevTargetDropPos=-1;e.dragHandlePos={top:-9999999,left:0};e.dragHandleShiftPos={x:0,y:0};e.dragObjIndent=0;e.isDragActive=!1;e.dragStartPos={x:0,y:0};e.dragEndPos={x:0,y:0};e.clickedCell=null;e.dropList=
null;e.dropListRef=null;e.calendar=null;e.calendarRef=null;e.colorPopup=null;e.colorPopupRef=null;e.colorPanelSize={width:240,height:270};e.currentEditorCell=null;e.isPopupDelayed=!1;e.isEditorFocused=!1;e.originalEditorText="";e.originalEditorValue=null;e.expandColIndex=0;e.hoverCell=null;e.hoverColumn=null;e.hoverRow=null;e.isGridHovered=!1;e.currentIndex=0;e.prevIndex=0;e.tabIndexCount=0;e.ctrlCursor="default";e.blockHoverRect={height:30,left:0,top:-9999999,width:880};e.blockSelectRect=[];e.blockSelectHeight=
0;e.hoverRowObj={data:{}};e.columnStartPos={x:0,y:0};e.resizeColumn=null;e.resizeColumnIndex=-1;e.reorderColumn=null;e.columnReorderActive=!1;e.currentFocusCell=null;e.isKeyboardActive=!1;e.allowUpdate=!0;e.avgRowHeight=0;e.blockMarginTop=0;e.blockSize={width:0,height:0};e.leftBlockSize={width:0,height:0};e.rightBlockSize={width:0,height:0};e.columnPadding={top:0,right:0,bottom:0,left:0};e.currentGridLines=IntegralUIGridLines.Both;e.currentHeaderHeight=0;e.currentFooterHeight=0;e.isExpandBoxVisible=
!0;e.isLayoutUpdating=!1;e.isHoverTemplatePresent=!1;e.isSelectedTemplatePresent=!1;e.numVisibleCells=0;e.viewIndexRange={left:0,middle:999,right:999};e.fixedLeftViewIndexRange=0;e.fixedRightViewIndexRange=0;e.visibleRange=1;e.isAutoSizeColumnsActive=!1;e.isHeaderVisible=!0;e.isFooterVisible=!0;e.isUpdateActive=!1;e.scrollSize={width:0,height:0};e.contentLeftPos=0;e.initialContentLeftPos=0;e.allColWidth=0;e.horScrollElemPos={bottom:0};e.cornerScrollElemPos={bottom:0};e.paginatorPos={top:0,left:0};
e.currentPageNumber=1;e.onlyCurrentPage=!1;e.currentPageList=[];e.pageNumber=0;e.pageList=[];e.pageRowCount=0;e.paginatorHeight=0;e.originalScrollColumnList=[];e.reorderColumnObj=null;e.reorderColumnObjPos={top:0,left:0};e.reorderColumnStartPos={top:0,left:0};e.reorderColumnCurrentPos={top:0,left:0};e.reorderColIndex=-1;e.reorderNewColIndex=-1;e.startColumnReorder=!1;e.isColumnResizing=!1;e.currentScrollPos={x:0,y:0};e.isKeyPressed=!1;e.maxScrollPos={x:0,y:0};e.accelerator=.5;e.scrollTimerID=null;
e.isScrollTimerActive=!1;e.scrollCount=0;e.isScrollActive=!1;e.prevScrollPos={x:0,y:0};e.scrollBarSize={width:0,height:0};e.scrollLargeChange={x:0,y:0};e.currentSelectedColumn=null;e.currentSelectedRow=null;e.currentSelectionMode=integralui_core_1.IntegralUISelectionMode.One;e.shiftFirstSelectedRow=null;e.removeIndex=-1;e.currentSelectedRows=[];e.isExpandBoxTouched=!1;e.touchStartPos={x:0,y:0};e.touchEndPos={x:0,y:0};e.footerHeight=0;e.headerHeight=0;e.mouseWheelSpeed=integralui_core_1.IntegralUISpeedMode.Normal;
e.rowContentVisibility=integralui_core_1.IntegralUIContentVisibility.Both;e.rowHeight=0;e.showHoverRow=!1;e.afterSelect=new core_1.EventEmitter;e.beforeEdit=new core_1.EventEmitter;e.beforeSelect=new core_1.EventEmitter;e.beforeUpdate=new core_1.EventEmitter;e.cellClick=new core_1.EventEmitter;e.cellDblClick=new core_1.EventEmitter;e.cellHover=new core_1.EventEmitter;e.cellRightClick=new core_1.EventEmitter;e.cellValueChanging=new core_1.EventEmitter;e.cellValueChanged=new core_1.EventEmitter;e.change=
new core_1.EventEmitter;e.columnAdding=new core_1.EventEmitter;e.columnAdded=new core_1.EventEmitter;e.columnClick=new core_1.EventEmitter;e.columnDblClick=new core_1.EventEmitter;e.columnHover=new core_1.EventEmitter;e.columnRightClick=new core_1.EventEmitter;e.columnOrderChanged=new core_1.EventEmitter;e.columnRemoving=new core_1.EventEmitter;e.columnRemoved=new core_1.EventEmitter;e.columnsCleared=new core_1.EventEmitter;e.columnSizeChanged=new core_1.EventEmitter;e.dragEnd=new core_1.EventEmitter;
e.dragEnter=new core_1.EventEmitter;e.dragDrop=new core_1.EventEmitter;e.dragDropComplete=new core_1.EventEmitter;e.dragLeave=new core_1.EventEmitter;e.dragOver=new core_1.EventEmitter;e.dragStart=new core_1.EventEmitter;e.keyDown=new core_1.EventEmitter;e.keyPress=new core_1.EventEmitter;e.keyUp=new core_1.EventEmitter;e.pageChanged=new core_1.EventEmitter;e.rowAdding=new core_1.EventEmitter;e.rowAdded=new core_1.EventEmitter;e.rowClick=new core_1.EventEmitter;e.rowDblClick=new core_1.EventEmitter;
e.rowHover=new core_1.EventEmitter;e.rowRemoving=new core_1.EventEmitter;e.rowRemoved=new core_1.EventEmitter;e.rowRightClick=new core_1.EventEmitter;e.rowsCleared=new core_1.EventEmitter;e.loadComplete=new core_1.EventEmitter;e.scrollPosChanged=new core_1.EventEmitter;e.selectionChanged=new core_1.EventEmitter;e.updateComplete=new core_1.EventEmitter;e.dragGhost=null;e.dragMode=integralui_core_1.IntegralUIDragDropDisplayMode.Popup;e.emptyRowObj={cells:[],draggable:!1,isEmpty:!0,status:1,style:{}};
e.sortColumn=null;e.sortComparer=null;e.updateOptions();return e}__extends(c,l);Object.defineProperty(c.prototype,"allowColumnReorder",{set:function(a){},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"allowDrag",{set:function(a){this.options.allowDrag=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"allowDrop",{set:function(a){this.options.allowDrop=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"allowFilter",{set:function(a){this.options.allowFilter=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"allowFocus",{set:function(a){this.options.allowFocus=a;a||(this.currentFocusCell=null);this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"autoSizeColumns",{get:function(){return this.isAutoSizeColumnsActive},set:function(a){this.isAutoSizeColumnsActive!=a&&(this.isAutoSizeColumnsActive=a,this.updateLayout())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"columns",{get:function(){return this.dataColumns},
set:function(a){this.dataColumns=a;this.updateData()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataFields",{set:function(a){this.updateDataFields(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"focusedCell",{get:function(){return this.currentFocusCell?this.currentFocusCell.data:null},set:function(a){this.currentFocusCell!=a&&this.updateFocusCell(this.getObjFromCell(a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"gridLines",{get:function(){return this.currentGridLines},
set:function(a){this.currentGridLines!=a&&(this.currentGridLines=a,this.refresh())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"paging",{set:function(a){this.updatePaging(a);this.resetPageNumber();this.updateCurrentLayout()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"rows",{get:function(){return this.dataRows},set:function(a){this.dataRows=a;this.updateData()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedColumn",{get:function(){return this.currentSelectedColumn},
set:function(a){this.currentSelectedColumn!=a&&this.processColumnSelection(null,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedRow",{get:function(){return this.currentSelectedRow},set:function(a){this.currentSelectedRow!=a&&(this.processRowSelection(null,a),this.updateSelectContentPos())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectionMode",{get:function(){return this.currentSelectionMode},set:function(a){this.currentSelectionMode!=a&&(this.currentSelectionMode=
a,this.clearPrevSelection(this.currentSelectionMode!=integralui_core_1.IntegralUISelectionMode.None?this.currentSelectedRow:null),this.refresh(),this.currentSelectionMode==integralui_core_1.IntegralUISelectionMode.None&&(this.currentSelectedRow=null,this.selectionChanged.emit(null)))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"showExpandBox",{get:function(){return this.isExpandBoxVisible},set:function(a){this.isExpandBoxVisible!=a&&(this.isExpandBoxVisible=a,this.updateLayout())},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"showScroll",{get:function(){return this.options.showScroll},set:function(a){this.updateShowScroll(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sorting",{set:function(a){this.options.sorting=a},enumerable:!0,configurable:!0});c.prototype.ngOnInit=function(){this.dataService.init([{data:this.columns,fields:this.options.columnFields,key:this.columnDataKey},{data:this.rows,fields:this.options.rowFields,key:this.rowDataKey}])};
c.prototype.addColumn=function(a){this.callEventAddColumn("add",a)};c.prototype.clearColumns=function(){this.dataService.clear(null,this.columnDataKey);this.columnsCleared.emit(null);this.currentScrollPos.x=0};c.prototype.insertColumnAt=function(a,b){this.callEventAddColumn("at",a,b)};c.prototype.insertColumnBefore=function(a,b){this.callEventAddColumn("ref",a,-1,b)};c.prototype.insertColumnAfter=function(a,b){this.callEventAddColumn("ref",a,-1,b,!0)};c.prototype.removeColumn=function(a){return this.callEventRemoveColumn(a)};
c.prototype.removeColumnAt=function(a){return this.callEventRemoveColumn(null,a)};c.prototype.callEventAddColumn=function(a,b,d,e,c){var h={cancel:!1,column:b};this.columnAdding.emit(h);if(1!=h.cancel){switch(a){case "at":this.dataService.insert(b,d,null,null,!1,this.columnDataKey);break;case "ref":this.dataService.insertByRef(b,e,c,this.columnDataKey);break;default:this.dataService.insert(b,-1,null,null,!1,this.columnDataKey)}this.columnAdded.emit({column:b})}};c.prototype.callEventRemoveColumn=
function(a,b){var d={cancel:!1,column:a};this.columnRemoving.emit(d);return 1!=d.cancel&&(this.removeIndex=this.columns?this.columns.indexOf(a):-1,d=this.dataService.removeAt(a,b,null,this.columnDataKey),d.result)?(this.columnRemoved.emit({column:d.obj}),!0):!1};c.prototype.addRow=function(a,b){this.callEventAddRow("add",a,-1,b)};c.prototype.clearRows=function(a){this.dataService.clear(a,this.rowDataKey);this.rowsCleared.emit({parent:a});this.clearSelection();this.currentScrollPos.y=0};c.prototype.insertRowAt=
function(a,b,d){this.callEventAddRow("at",a,b,d)};c.prototype.insertRowBefore=function(a,b){this.callEventAddRow("ref",a,-1,null,b)};c.prototype.insertRowAfter=function(a,b){this.callEventAddRow("ref",a,-1,null,b,!0)};c.prototype.removeRow=function(a){return this.callEventRemoveRow(a)};c.prototype.removeRowAt=function(a,b){return this.callEventRemoveRow(null,a,b)};c.prototype.callEventAddRow=function(a,b,d,e,c,g){var h={cancel:!1,row:b};this.rowAdding.emit(h);if(1!=h.cancel){switch(a){case "at":this.dataService.insert(b,
d,e,null,!1,this.rowDataKey);break;case "ref":this.dataService.insertByRef(b,c,g,this.rowDataKey);break;default:this.dataService.insert(b,-1,e,null,!1,this.rowDataKey)}this.rowAdded.emit({row:b})}};c.prototype.callEventRemoveRow=function(a,b,d){var e={cancel:!1,row:a};this.rowRemoving.emit(e);return 1!=e.cancel&&(this.removeIndex=this.rows?this.rows.indexOf(a):-1,b=this.dataService.removeAt(a,b,d,this.rowDataKey),b.result)?(a&&a[this.options.rowFields.selected]&&(a[this.options.rowFields.selected]=
!1,this.currentSelectedRows=this.currentSelectedRows.filter(function(b){return b!=a}),this.currentSelectedRow&&this.commonService.isEqual(this.currentSelectedRow[this.options.rowFields.id],a[this.options.rowFields.id])&&(this.currentSelectedRow=null),this.selectionChanged.emit({row:this.currentSelectedRow})),this.rowRemoved.emit({row:b.obj}),!0):!1};c.prototype.cellClickEvent=function(a,b){this.isEnabled&&1==a.which&&this.cellClick.emit({cell:b.data,event:a})};c.prototype.cellDblClickEvent=function(a,
b){this.isEnabled&&1==a.which&&this.cellDblClick.emit({cell:b.data,event:a})};c.prototype.cellRightClickEvent=function(a,b){this.isEnabled&&this.cellRightClick.emit({cell:b.data,event:a})};c.prototype.columnClickEvent=function(a,b){var d=this;if(d.isEnabled&&1==a.which)if(d.allowAnimation)var e=setTimeout(function(){d.columnClick.emit({column:b.data,event:a});clearTimeout(e)},250);else d.columnClick.emit({column:b.data,event:a})};c.prototype.columnDblClickEvent=function(a,b){this.isEnabled&&1==a.which&&
this.columnDblClick.emit({column:b.data,event:a})};c.prototype.columnRightClickEvent=function(a,b){this.isEnabled&&this.columnRightClick.emit({column:b.data,event:a})};c.prototype.rowClickEvent=function(a,b){this.isEnabled&&1==a.which&&this.rowClick.emit({event:a,row:b.data})};c.prototype.rowDblClickEvent=function(a,b){if(this.isEnabled&&1==a.which){var d={cancel:!1,event:a,row:b.data};this.rowDblClick.emit(d);1!=d.cancel&&this.toggle(b.data)}};c.prototype.rowRightClickEvent=function(a,b){this.isEnabled&&
this.rowRightClick.emit({event:a,row:b.data})};c.prototype.updateData=function(){};c.prototype.updateDataFields=function(a){a?(this.updateColumnFields(a.column),this.updateRowFields(a.row),this.updateCellFields(a.cell)):(this.updateColumnFields(),this.updateRowFields(),this.updateCellFields())};c.prototype.updateOptions=function(a){a?(this.options={allowAnimation:this.commonService.isFieldAvailable(a.allowAnimation,!0),allowCellFocus:this.commonService.isFieldAvailable(a.allowCellFocus,!0),allowColumnReorder:this.commonService.isFieldAvailable(a.allowColumnReorder,
!1),allowDrag:this.commonService.isFieldAvailable(a.allowDrag,!1),allowDrop:this.commonService.isFieldAvailable(a.allowDrop,!0),allowFilter:this.commonService.isFieldAvailable(a.allowFilter,!1),allowFocus:this.commonService.isFieldAvailable(a.allowFocus,!1),animationSpeed:200,autoExpand:this.commonService.isFieldAvailable(a.autoExpand,!0),displayMode:this.commonService.isFieldAvailable(a.displayMode,"normal"),editorSettings:{activate:"click"},enabled:this.commonService.isFieldAvailable(a.enabled,
!0),expandColIndex:this.commonService.isFieldAvailable(a.expandColIndex,void 0!=this.options.expandColIndex?this.options.expandColIndex:0),fillSpace:this.commonService.isFieldAvailable(a.fillSpace,!1),gridLines:this.commonService.isFieldAvailable(a.gridLines,"both"),hoverSelection:this.commonService.isFieldAvailable(a.hoverSelection,!1),indent:this.commonService.isFieldAvailable(a.indent,15),labelEdit:this.commonService.isFieldAvailable(a.labelEdit,!1),loadRows:[],mouseWheelSpeed:this.commonService.isFieldAvailable(a.mouseWheelSpeed,
"normal"),pathSeparator:this.commonService.isFieldAvailable(a.pathSeparator,"\\"),rowHeight:this.commonService.isFieldAvailable(a.rowHeight,-1),rtl:this.commonService.isFieldAvailable(a.rtl,!1),selectedColumn:this.commonService.isFieldAvailable(a.selectedColumn,this.currentSelectedColumn?this.currentSelectedColumn:null),selectedIndex:-1,selectedRow:this.commonService.isFieldAvailable(a.selectedRow,this.currentSelectedRow?this.currentSelectedRow:null),selectedRows:[],selectionMode:this.commonService.isFieldAvailable(a.selectionMode,
integralui_core_1.IntegralUISelectionMode.One),showFooter:this.commonService.isFieldAvailable(a.showFooter,!0),showHeader:this.commonService.isFieldAvailable(a.showHeader,!0),showIcons:this.commonService.isFieldAvailable(a.showIcons,!0),sorting:this.commonService.isFieldAvailable(a.sorting,integralui_core_1.IntegralUISortOrder.None)},this.updatePaging(a.paging),this.updateDataFields(a.dataFields),this.updateShowScroll(a.showScroll)):(this.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,
allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!1,animationSpeed:200,autoExpand:!0,displayMode:"normal",editorSettings:{activate:"click"},enabled:!0,expandColIndex:0,fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],mouseWheelSpeed:"normal",pathSeparator:"\\",rowHeight:-1,rtl:!1,selectedColumn:null,selectedIndex:-1,selectedRow:null,selectedRows:[],selectionMode:integralui_core_1.IntegralUISelectionMode.One,showFooter:!0,showHeader:!0,showIcons:!0,sorting:integralui_core_1.IntegralUISortOrder.None},
this.updatePaging(),this.updateDataFields(),this.updateShowScroll())};c.prototype.updateColumnFields=function(a){this.options.columnFields=a?{aggregation:a.aggregation?a.aggregation:"aggregation",allowDrag:a.allowDrag?a.allowDrag:"allowDrag",allowDrop:a.allowDrop?a.allowDrop:"allowDrop",allowFilter:a.allowFilter?a.allowFilter:"allowFilter",allowGrouping:a.allowGrouping?a.allowGrouping:"allowGrouping",allowResize:a.allowResize?a.allowResize:"allowResize",canSelect:a.canSelect?a.canSelect:"canSelect",
cellTemplateUrl:a.cellTemplateUrl?a.cellTemplateUrl:"cellTemplateUrl",columns:a.columns?a.columns:"columns",comparer:a.comparer?a.comparer:"comparer",contentAlignment:a.contentAlignment?a.contentAlignment:"contentAlignment",contextMenu:a.contextMenu?a.contextMenu:"contextMenu",editorType:a.editorType?a.editorType:"editorType",editorSettings:a.editorSettings?a.editorSettings:"editorSettings",editorTemplate:a.editorTemplate?a.editorTemplate:"editorTemplate",expanded:a.expanded?a.expanded:"expanded",
filterParams:a.filterParams?a.filterParams:"filterParams",filterTemplate:a.filterTemplate?a.filterTemplate:"filterTemplate",fixed:a.fixed?a.fixed:"fixed",fixedWidth:a.fixedWidth?a.fixedWidth:"fixedWidth",footerAlignment:a.footerAlignment?a.footerAlignment:"footerAlignment",footerContent:a.footerContent?a.footerContent:"footerContent",footerTemplate:a.footerTemplate?a.footerTemplate:"footerTemplate",footerTemplateModel:a.footerTemplateModel?a.footerTemplateModel:"footerTemplateModel",footerText:a.footerText?
a.footerText:"footerText",footerTooltip:a.footerTooltip?a.footerTooltip:"footerTooltip",groupText:a.groupText?a.groupText:"groupText",headerAlignment:a.headerAlignment?a.headerAlignment:"headerAlignment",headerContent:a.headerContent?a.headerContent:"headerContent",headerTemplate:a.headerTemplate?a.headerTemplate:"headerTemplate",headerTemplateModel:a.headerTemplateModel?a.headerTemplateModel:"headerTemplateModel",headerText:a.headerText?a.headerText:"headerText",headerTooltip:a.headerTooltip?a.headerTooltip:
"headerTooltip",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",minWidth:a.minWidth?a.minWidth:"minWidth",maxWidth:a.maxWidth?a.maxWidth:"maxWidth",name:a.name?a.name:"name",objects:a.columns?a.columns:"columns",pid:a.pid?a.pid:"pid",selected:a.selected?a.selected:"selected",style:a.style?a.style:"style",templateSettings:a.templateSettings?a.templateSettings:"templateSettings",visible:a.visible?a.visible:"visible",width:a.width?a.width:"width"}:{aggregation:"aggregation",allowDrag:"allowDrag",allowDrop:"allowDrop",
allowFilter:"allowFilter",allowGrouping:"allowGrouping",allowResize:"allowResize",canSelect:"canSelect",cellTemplateUrl:"cellTemplateUrl",columns:"columns",comparer:"comparer",contentAlignment:"contentAlignment",contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",editorTemplate:"editorTemplate",expanded:"expanded",filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",
footerContent:"footerContent",footerTemplate:"footerTemplate",footerText:"footerText",footerTooltip:"footerTooltip",groupText:"groupText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",headerTemplateModel:"headerTemplateModel",headerText:"headerText",headerTooltip:"headerTooltip",icon:"icon",id:"id",minWidth:"minWidth",maxWidth:"maxWidth",name:"name",objects:"columns",pid:"pid",selected:"selected",style:"style",templateSettings:"templateSettings",visible:"visible",
width:"width"};this.dataService&&this.dataService.updateDataFields(this.options.columnFields,this.columnDataKey)};c.prototype.updateRowFields=function(a){this.options.rowFields=a?{allowDrag:a.allowDrag?a.allowDrag:"allowDrag",allowDrop:a.allowDrop?a.allowDrop:"allowDrop",allowEdit:a.allowEdit?a.allowEdit:"allowEdit",allowFocus:a.allowFocus?a.allowFocus:"allowFocus",autoCheck:a.autoCheck?a.autoCheck:"autoCheck",canSelect:a.canSelect?a.canSelect:"canSelect",cells:a.cells?a.cells:"cells",checkBoxSettings:a.checkBoxSettings?
a.checkBoxSettings:"checkBoxSettings",checked:a.checked?a.checked:"checked",checkState:a.checkState?a.checkState:"checkState",content:a.content?a.content:"content",contentVisibility:a.contentVisibility?a.contentVisibility:"contentVisibility",contextMenu:a.contextMenu?a.contextMenu:"contextMenu",gid:a.gid?a.gid:"gid",enabled:a.enabled?a.enabled:"enabled",expanded:a.expanded?a.expanded:"expanded",fixed:a.fixed?a.fixed:"fixed",hasChildren:a.hasChildren?a.hasChildren:"hasChildren",icon:a.icon?a.icon:
"icon",id:a.id?a.id:"id",name:a.name?a.name:"name",objects:a.rows?a.rows:"rows",pid:a.pid?a.pid:"pid",rows:a.rows?a.rows:"rows",selected:a.selected?a.selected:"selected",statusIcon:a.statusIcon?a.statusIcon:"statusIcon",style:a.style?a.style:"style",subobjects:a.cells?a.cells:"cells",templateObj:a.templateObj?a.templateObj:"templateObj",text:a.text?a.text:"text",tooltip:a.tooltip?a.tooltip:"tooltip",value:a.value?a.value:"value",visible:a.visible?a.visible:"visible"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",
allowFocus:"allowFocus",canSelect:"canSelect",cells:"cells",content:"content",contentVisibility:"contentVisibility",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",fixed:"fixed",gid:"gid",hasChildren:"hasChildren",icon:"icon",id:"id",name:"name",objects:"rows",pid:"pid",rows:"rows",selected:"selected",statusIcon:"statusIcon",style:"style",subobjects:"cells",text:"text",tooltip:"tooltip",value:"value",visible:"visible"};this.dataService&&this.dataService.updateDataFields(this.options.rowFields,
this.rowDataKey)};c.prototype.updateCellFields=function(a){this.options.cellFields=a?{allowDrag:a.allowDrag?a.allowDrag:"allowDrag",allowEdit:a.allowEdit?a.allowEdit:"allowEdit",cid:a.cid?a.cid:"cid",content:a.content?a.content:"content",contextMenu:a.contextMenu?a.contextMenu:"contextMenu",editorSettings:a.editorSettings?a.editorSettings:"editorSettings",enabled:a.enabled?a.enabled:"enabled",expanded:a.expanded?a.expanded:"expanded",isGroup:a.isGroup?a.isGroup:"isGroup",labelEdit:a.labelEdit?a.labelEdit:
"labelEdit",rid:a.rid?a.rid:"rid",selected:a.selected?a.selected:"selected",style:a.style?a.style:"style",tag:a.tag?a.tag:"tag",templateObj:a.templateObj?a.templateObj:"templateObj",text:a.text?a.text:"text",tooltip:a.tooltip?a.tooltip:"tooltip",value:a.value?a.value:"value",valueID:a.valueID?a.valueID:"valueID",valueType:a.valueType?a.valueType:"valueType"}:{allowDrag:"allowDrag",allowEdit:"allowEdit",cid:"cid",content:"content",contextMenu:"contextMenu",editorSettings:"editorSettings",enabled:"enabled",
expanded:"expanded",isGroup:"isGroup",labelEdit:"labelEdit",rid:"rid",selected:"selected",style:"style",tag:"tag",templateObj:"templateObj",text:"text",tooltip:"tooltip",value:"value",valueID:"valueID",valueType:"valueType"}};c.prototype.updateShowScroll=function(a){this.options.showScroll=a?{horizontal:this.commonService.isFieldAvailable(a.horizontal,!0),vertical:this.commonService.isFieldAvailable(a.vertical,!0)}:{horizontal:!0,vertical:!0}};c.prototype.processLoadData=function(a,b,d,e){var c=this;
c.clearRows(b);c.updateRowFields(d);var g=[];if(a)if(e||void 0==e){var f=[];a.forEach(function(a,b){var d=a[c.options.rowFields.pid];f[d]?(f[d][c.options.rowFields.rows]||(f[d][c.options.rowFields.rows]=[]),f[a[c.options.rowFields.id]]=a,f[d][c.options.rowFields.rows].push(a)):(f[a[c.options.rowFields.id]]=a,g.push(a))});f.length=0}else g=a;if(b)for(b[c.options.rowFields.rows]=g,a=0;a<b[c.options.rowFields.rows].length;a++)b[c.options.rowFields.rows][a][c.options.rowFields.pid]=b[c.options.rowFields.id];
else if(c.rows)for(a=c.rows.length=0;a<g.length;a++)c.rows.push(g[a]);c.loadComplete.emit(null);this.updateLayout()};c.prototype.calcMaxColumnLevels=function(a,b){if(a&&0!=a.length)for(var d=0;d<a.length;d++)this.isColumnExpanded(a[d])&&this.isColumnWithChildrenVisible(a[d])&&(this.maxColumnLevels<b&&(this.maxColumnLevels=b),this.calcMaxColumnLevels(a[d][this.options.columnFields.columns],b+1))};c.prototype.getColumnSpan=function(a){var b=0;if(!a[this.options.columnFields.columns]||0==a[this.options.columnFields.columns].length)return 1;
for(var d=0;d<a[this.options.columnFields.columns].length;d++)b+=this.getColumnSpan(a[this.options.columnFields.columns][d]);return b};c.prototype.isColumnWithChildrenVisible=function(a){var b=!1;if(a&&(b=this.isColumnVisible(a))&&(a=a[this.options.columnFields.columns])&&0<a.length){for(var d=b=0;d<a.length;d++)this.isColumnWithChildrenVisible(a[d])&&b++;b=0<b?!0:!1}return b};c.prototype.createColumnLevel=function(a,b,d,e){if(a&&!(b>=this.maxColumnLevels))for(var c=0;c<a.length;){if((0<b?this.isColumnExpanded(a[c]):
1)&&this.isColumnWithChildrenVisible(a[c])){a[c][this.options.columnFields.id]||(a[c][this.options.columnFields.id]=this.commonService.getUniqueId());e&&(a[c][this.options.columnFields.pid]=e);var g=a[c][this.options.columnFields.columns];g={colSpan:g?this.getColumnSpan(a[c]):0,data:a[c],isRoot:0==b?!0:!1,isVisible:this.isColumnExpanded(a[c])&&g&&0!=g.length?!1:!0,rowSpan:this.isColumnExpanded(a[c])&&g&&0!=g.length?0:this.maxColumnLevels-b};switch(d){case "left":this.completeLeftColumnList[b].push(g);
break;case "right":this.completeRightColumnList[b].push(g);break;default:this.completeColumnList[b].push(g)}this.createColumnLevel(a[c][this.options.columnFields.columns],b+1,d,a[c][this.options.columnFields.id])}c++}};c.prototype.updateColumnCompleteList=function(){var a=this.currentColumnList.map(function(a){return a.data}),b=this.currentLeftColumnList.map(function(a){return a.data}),d=this.currentRightColumnList.map(function(a){return a.data});this.calcMaxColumnLevels(a,1);this.calcMaxColumnLevels(b,
1);this.calcMaxColumnLevels(d,1);for(var e=1;e<=this.maxColumnLevels;e++)this.completeColumnList.push([]),this.completeLeftColumnList.push([]),this.completeRightColumnList.push([]);this.createColumnLevel(a,0);this.createColumnLevel(b,0,"left");this.createColumnLevel(d,0,"right");this.flatCompleteColumnList=this.createFlatColumnList(this.completeColumnList);this.flatCompleteLeftColumnList=this.createFlatColumnList(this.completeLeftColumnList);this.flatCompleteRightColumnList=this.createFlatColumnList(this.completeRightColumnList)};
c.prototype.createScrollRowList=function(){this.createScrollNormalRowList();this.createScrollLeftRowList();this.createScrollRightRowList()};c.prototype.createScrollNormalRowList=function(){for(var a=this.scrollRowList.length=0;100>a;a++){var b=this.createEmptyRowObj();this.scrollRowList.push(b)}};c.prototype.createScrollLeftRowList=function(){for(var a=this.scrollLeftRowList.length=0;100>a;a++){var b=this.createEmptyRowObj();this.scrollLeftRowList.push(b)}};c.prototype.createScrollRightRowList=function(){for(var a=
this.scrollRightRowList.length=0;100>a;a++){var b=this.createEmptyRowObj();this.scrollRightRowList.push(b)}};c.prototype.createEmptyRowObj=function(){for(var a={clickPos:{x:0,y:0},cells:[],data:{},draggable:!1,indent:0,inlineStyle:{},isEmpty:!0,isGroup:!1,style:{}},b=0;1>b;b++)a.cells.push(this.createEmptyCellObj());return a};c.prototype.createEmptyCellObj=function(){return{align:"",colIndex:-1,data:{},display:"none",editorClass:"",editorList:[],editorSettings:{},editorStyle:"",editorType:null,editorValue:null,
expandBoxAllowed:!1,indent:0,inlineStyle:{},isEditorEnabled:!0,isEditorVisible:!0,isEmpty:!0,rowIndex:-1,style:{content:"iui-grid-row-cell-content"},tabIndex:-1,width:100,height:"auto"}};c.prototype.updateScrollRowListLimit=function(a){this.updateScrollNormalRowListLimit(a);this.updateScrollLeftRowListLimit(a);this.updateScrollRightRowListLimit(a)};c.prototype.updateScrollNormalRowListLimit=function(a){for(var b=0;b<this.scrollRowList.length;b++)for(var d=0;d<a;d++)this.scrollRowList[b].cells.push(this.createEmptyCellObj())};
c.prototype.updateScrollLeftRowListLimit=function(a){for(var b=0;b<this.scrollLeftRowList.length;b++)for(var d=0;d<a;d++)this.scrollLeftRowList[b].cells.push(this.createEmptyCellObj())};c.prototype.updateScrollRightRowListLimit=function(a){for(var b=0;b<this.scrollRightRowList.length;b++)for(var d=0;d<a;d++)this.scrollRightRowList[b].cells.push(this.createEmptyCellObj())};c.prototype.getNumScrollColumns=function(a){switch(a){case "left":return 0<this.scrollLeftRowList.length?this.scrollLeftRowList[0].cells.length:
0;case "right":return 0<this.scrollRightRowList.length?this.scrollRightRowList[0].cells.length:0}return 0<this.scrollRowList.length?this.scrollRowList[0].cells.length:0};c.prototype.getNumVisibleColumns=function(a){switch(a){case "left":return this.flatCompleteLeftColumnList.filter(function(a){return a.isVisible}).length;case "right":return this.flatCompleteRightColumnList.filter(function(a){return a.isVisible}).length}return this.flatCompleteColumnList.filter(function(a){return a.isVisible}).length};
c.prototype.resetRowObj=function(a){a&&(a.clickPos={x:0,y:0},a.data={},a.draggable=!1,a.indent=0,a.inlineStyle={},a.isEmpty=!0,a.isGroup=!1,a.style={})};c.prototype.resetCellObj=function(a){a&&(a.align="",a.colIndex=-1,a.data={},a.display="none",a.editorClass="",a.editorList=[],a.editorSettings={},a.editorStyle="",a.editorType=null,a.editorValue=null,a.expandBoxAllowed=!1,a.indent=0,a.inlineStyle={},a.isEditorEnabled=!0,a.isEditorVisible=!0,a.isEmpty=!0,a.rowIndex=-1,a.style={content:"iui-grid-row-cell-content"},
a.tabIndex=-1,a.width=0,a.height="auto")};c.prototype.updateScrollColumnList=function(){};c.prototype.updateScrollRowList=function(a){};c.prototype.addDropMark=function(a){this.appRef&&(this.removeDropMark(),a=this.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUIDragWindow))&&(this.dragCmpRef=this.appRef.createComponent(a),this.dragCmpRef.instance&&(this.dragCmp=this.dragCmpRef.instance))};c.prototype.removeDropMark=function(){this.dragCmpRef&&this.dragCmpRef.destroy();this.dragCmp=
null};c.prototype.callDragDropEvent=function(a,b,d){var e=this;b={action:b.action,cancel:!1,dragRow:b.source,dropPos:b.dropPos,event:a,isDropAllowed:b.allow,mousePos:this.commonService.getMousePos(a),resume:function(){e.drop(a,e.dragDropService.getData());e.dragDropService.clearData()},sourceCtrl:b.sourceCtrl,targetCtrl:b.targetCtrl,targetRow:b.target};d?this.dragDrop.emit(b):this.dragOver.emit(b);return b};c.prototype.checkEmptySpace=function(a){var b=this.getContentSize(),d=this.commonService.getPageRect(this.elemRef.nativeElement.firstElementChild);
b=d.top+b.height;d=d.bottom;a=this.commonService.getMousePos(a);var e=this.commonService.getShiftPos();a.x-=e.x;a.y-=e.y;return a.y>=b&&a.y<=d};c.prototype.ctrlDragEnter=function(a){this.isEnabled&&this.processDragEnter(a)};c.prototype.ctrlDragDrop=function(a){this.isEnabled&&this.processDragDrop(a);this.removeDropMark();a.stopPropagation()};c.prototype.ctrlDragLeave=function(a){this.isEnabled&&this.processDragLeave(a)};c.prototype.ctrlDragOver=function(a){this.isEnabled&&this.processDragOver(a);
a.stopPropagation()};c.prototype.ctrlDragEnd=function(a){this.removeDropMark();var b=this.dragDropService.getData();b.targetCtrl&&b.targetCtrl.removeDropMark&&b.targetCtrl.removeDropMark();this.rowDragEnd(a,null)};c.prototype.removeDragHandle=function(){this.isDragHandleVisible=!1;this.targetDropRow=null;this.targetDropPos=-1};c.prototype.dropMark=function(a,b){if(this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle)b||this.removeDragHandle(),this.updateScrollRowListDragOver(null);
else if(this.dragCmp||this.isScrollTimerActive||this.addDropMark({x:a.pageX,y:a.pageY}),this.dragCmp){var d="none";this.options.allowDrop&&(d=b?"block":"none");this.dragCmp.display=d}};c.prototype.updateDragComponent=function(a){this.dragCmp&&this.dragCmp.updatePos(a)};c.prototype.isDragAllowed=function(a){return this.options.allowDrag?a&&(a[this.options.rowFields.allowDrag]||void 0===a[this.options.rowFields.allowDrag])?!0:!1:!1};c.prototype.isDropAllowed=function(a,b,d){var e=this.options.allowDrop;
if(e&&a&&b&&(e=b[this.options.rowFields.allowDrop]||void 0===b[this.options.rowFields.allowDrop]?!0:!1))if(Array.isArray(a))for(var c=0;c<a.length;c++){if(this.commonService.isEqual(a[c][this.options.rowFields.id],b[this.options.rowFields.id])||0===d&&this.isParentOf(b,a[c])||this.isChildOf(b,a[c])){e=!1;break}if(!e)break}else if(this.commonService.isEqual(a[this.options.rowFields.id],b[this.options.rowFields.id])||0===d&&this.isParentOf(b,a)||this.isChildOf(b,a))e=!1;return e};c.prototype.processDragStart=
function(a,b){this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle?this.processDragStartHandle(a,b):this.processDragStartPopup(a,b)};c.prototype.processDragStartHandle=function(a,b){this.dragDropService.clearData();if(!this.isDragAllowed(b))a.preventDefault();else if(b)if(this.isDragAllowed(b)){var d={clone:this.cloneRow(b),handle:this.dragRowList,source:b,sourceCtrl:this,sourceData:this.rows};switch(this.selectionMode){case integralui_core_1.IntegralUISelectionMode.MultiSimple:d.clone=
this.createCloneList(this.currentSelectedRows);d.source=this.currentSelectedRows;break;case integralui_core_1.IntegralUISelectionMode.MultiExtended:d.clone=this.createCloneList(this.currentSelectedRows),d.source=this.currentSelectedRows}var e={action:a.shiftKey?"copy":"move",cancel:!1,dragRow:d.source,dropPos:-1,event:a,isDropAllowed:this.options.allowDrop,mousePos:this.commonService.getMousePos(a),sourceCtrl:d.sourceCtrl,targetCtrl:this,targetRow:null};this.dragStart.emit(e);1==e.cancel?a.preventDefault():
(this.isFirstDragEnter=!0,this.dragDropService.setData(d))}else this.ctrlCursor="no-drop"};c.prototype.processDragStartPopup=function(a,b){this.dragDropService.clearData();if(!this.isDragAllowed(b))a.preventDefault();else if(b)if(this.isDragAllowed(b)){var d={clone:this.cloneRow(b),source:b,sourceCtrl:this,sourceData:this.rows};switch(this.selectionMode){case integralui_core_1.IntegralUISelectionMode.MultiSimple:d.clone=this.createCloneList(this.currentSelectedRows);d.source=this.currentSelectedRows;
break;case integralui_core_1.IntegralUISelectionMode.MultiExtended:d.clone=this.createCloneList(this.currentSelectedRows),d.source=this.currentSelectedRows}var e={action:a.shiftKey?"copy":"move",cancel:!1,dragRow:d.source,dropPos:-1,event:a,isDropAllowed:this.options.allowDrop,mousePos:this.commonService.getMousePos(a),sourceCtrl:d.sourceCtrl,targetCtrl:this,targetRow:null};this.dragStart.emit(e);1==e.cancel?a.preventDefault():(this.isFirstDragEnter=this.isDragActive=!0,this.addDropMark({x:a.pageX,
y:a.pageY}),this.dropMark(a),a.dataTransfer?(a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("text",b[this.options.rowFields.id]?b[this.options.rowFields.id].toString():"")):a.originalEvent&&a.originalEvent.dataTransfer&&(a.originalEvent.dataTransfer.effectAllowed="move",a.originalEvent.dataTransfer.setData("text",b[this.options.rowFields.id]?b[this.options.rowFields.id].toString():"")),this.dragDropService.setData(d))}else a.dataTransfer?a.dataTransfer.effectAllowed="none":a.originalEvent&&
a.originalEvent.dataTransfer&&(a.originalEvent.dataTransfer.effectAllowed="none")};c.prototype.processDragEnter=function(a){a.preventDefault();if(!this.isCtrlDragEntered){this.isCtrlDragEntered=!0;var b=this.dragDropService.getData();if(!this.isFirstDragEnter&&this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle&&(this.dragRowList=b.handle)){for(var d=0;d<this.dragRowList.length;d++){var e=this.getObjIndexFromScrollList(this.dragRowList[d].data);0<=e&&this.scrollRowList.splice(e,
1)}this.isDragHandleVisible=!0;this.targetDropPos=2;this.targetDropRow=0<this.scrollRowList.length?this.scrollRowList[this.scrollRowList.length-1].data:null;this.scrollRowList.splice(this.scrollRowList.length,0,{cells:[],draggable:!1,isEmpty:!0,status:1,style:{}})}this.isFirstDragEnter=!1;a={action:a.shiftKey?"copy":"move",dragRow:b.source,dropPos:-1,event:a,isDropAllowed:this.options.allowDrop,mousePos:this.commonService.getMousePos(a),sourceCtrl:b.sourceCtrl,targetCtrl:this,targetRow:null};this.dragEnter.emit(a)}};
c.prototype.processDragLeave=function(a){a.preventDefault();if(this.isCtrlDragEntered){var b=this.commonService.getPageRect(this.elemRef.nativeElement.firstElementChild),d=this.commonService.getMousePos(a),e=this.commonService.getShiftPos();d.x-=e.x;d.y-=e.y;if(d.x<=b.left||d.x>=b.right||d.y<=b.top||d.y>=b.bottom)this.isCtrlDragEntered=!1,this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle&&this.updateScrollRowList(),this.stopScrollTimer(),b=this.dragDropService.getData(),b={action:a.shiftKey?
"copy":"move",dragRow:b.source,dropPos:-1,event:a,isDropAllowed:!1,mousePos:this.commonService.getMousePos(a),sourceCtrl:b.sourceCtrl,targetCtrl:null,targetRow:null},this.dragLeave.emit(b);this.dropMark(a)}};c.prototype.processDragOver=function(a,b,d,e,c){this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle?this.processDragOverHandle(a,b,d,e,c):this.processDragOverPopup(a,b,d,e,c)};c.prototype.processDragOverHandle=function(a,b,d,e,c){a.preventDefault();this.processDragEnter(a);this.hoverRow=
null;this.changeCursor();var h=this.isDragActive;if(h)if(c=this.dragDropService.getData(),h=this.commonService.getShiftPos(),b&&!b.isEmpty){var f=this.commonService.getMousePos(a);f.x-=h.x;f.y-=h.y;d=this.dragDropService.getDropPos(f,d,e,"group"==b.data.type?"full":null);h=this.isDropAllowed(c.source,b.data,d);e=this.callDragDropEvent(a,{action:a.shiftKey?"copy":"move",source:c.source,dropPos:d,allow:h,sourceCtrl:c.sourceCtrl,target:b.data,targetCtrl:this});h&&1!=e.cancel?(this.isDragHandleVisible=
!0,this.dragRowList=c.handle,this.targetDropPos=d,this.updateScrollRowListDragOver(b.data),this.dragObjIndent=this.getObjFromRow(b.data).indent,b.data[this.options.rowFields.rows]&&0<b.data[this.options.rowFields.rows].length&&(this.dragObjIndent+=this.options.indent),this.updateDragHandlePos(a),this.dragDropService.setData({action:a.shiftKey?"copy":"move",clone:c.clone,handle:c.handle,source:c.source,sourceCtrl:c.sourceCtrl,sourceData:c.sourceData,target:b.data,targetCtrl:this,dropPos:d})):(this.ctrlCursor=
"no-drop",this.dropMark(a,!0),this.targetDropPos=-1,this.updateScrollRowListDragOver(b.data),this.updateDragHandlePos(a))}else this.options.allowDrop?(this.dragRowList=c.handle,this.updateDragHandlePos(a)):(this.ctrlCursor="no-drop",this.dropMark(a))};c.prototype.processDragOverPopup=function(a,b,d,e,c){a.preventDefault();this.processDragEnter(a);var h=!0;a.dataTransfer?h="none"===a.dataTransfer.effectAllowed?!1:!0:a.originalEvent&&a.originalEvent.dataTransfer&&(h="none"===a.originalEvent.dataTransfer.effectAllowed?
!1:!0);if(h)if(c=this.dragDropService.getData(),h=this.commonService.getShiftPos(),b&&!b.isEmpty){var f=this.commonService.getMousePos(a);f.x-=h.x;f.y-=h.y;f=this.dragDropService.getDropPos(f,d,e,"group"==b.data.type?"full":null);h=this.isDropAllowed(c.source,b.data,f);f={action:a.shiftKey?"copy":"move",source:c.source,dropPos:f,allow:h,sourceCtrl:c.sourceCtrl,target:b.data,targetCtrl:this};d=this.callDragDropEvent(a,f);if(h&&1!=d.cancel){f=this.commonService.getMousePos(a);e=f.y+16;f=f.x+20;var k=
"iui-dragwin-icon";switch(d.dropPos){case 0:k+=" iui-dragwin-move-in";break;case 1:k+=" iui-dragwin-move-up";break;case 2:k+=" iui-dragwin-move-down"}"copy"==d.action&&(k+="-copy");this.updateDragComponent({"class":k,top:e,left:f,text:b.data[this.options.rowFields.text]});this.dropMark(a,h);this.dragDropService.setData({action:d.action,clone:c.clone,dropPos:d.dropPos,source:c.source,sourceCtrl:c.sourceCtrl,sourceData:c.sourceData,target:b.data,targetCtrl:this})}else a.dataTransfer?a.dataTransfer.dropEffect=
"none":a.originalEvent&&a.originalEvent.dataTransfer&&(a.originalEvent.dataTransfer.dropEffect="none"),this.dropMark(a)}else this.options.allowDrop?(h=this.checkEmptySpace(a),f={action:a.shiftKey?"copy":"move",allow:h,dropPos:-1,source:c.source,sourceCtrl:c.sourceCtrl,target:null,targetCtrl:this},d=this.callDragDropEvent(a,f),h&&1!=d.cancel?(f=this.commonService.getMousePos(a),e=f.y+16,f=f.x+20,k="iui-dragwin-icon iui-dragwin-move-end","copy"==d.action&&(k+="-copy"),this.updateDragComponent({"class":k,
top:e,left:f,text:this.name?this.name:"Component"}),this.dropMark(a,h&&!this.isScrollTimerActive),this.dragDropService.setData({action:d.action,clone:c.clone,source:c.source,sourceCtrl:c.sourceCtrl,sourceData:c.sourceData,target:null,targetCtrl:this,dropPos:-1})):(a.dataTransfer?a.dataTransfer.dropEffect="none":a.originalEvent&&a.originalEvent.dataTransfer&&(a.originalEvent.dataTransfer.dropEffect="none"),this.dropMark(a))):(a.dataTransfer?a.dataTransfer.dropEffect="none":a.originalEvent&&a.originalEvent.dataTransfer&&
(a.originalEvent.dataTransfer.dropEffect="none"),this.dropMark(a))};c.prototype.processDragDrop=function(a,b){a.preventDefault();var d=!0;a.dataTransfer?d="none"===a.dataTransfer.effectAllowed?!1:!0:a.originalEvent&&a.originalEvent.dataTransfer&&(d="none"===a.originalEvent.dataTransfer.effectAllowed?!1:!0);var e=this.dragDropService.getData();if(d){if((d=b&&!b.isEmpty?this.isDropAllowed(e.source,b.data,e.dropPos):this.checkEmptySpace(a))&&e.source){var c=this.callDragDropEvent(a,{action:e.action,
source:e.source,dropPos:e.dropPos,allow:d,sourceCtrl:e.sourceCtrl,target:e.target,targetCtrl:this},!0);this.dragDropService.setData({action:c.action,clone:e.clone,dropPos:c.dropPos,source:e.source,sourceCtrl:e.sourceCtrl,sourceData:e.sourceData,target:e.target,targetCtrl:this});c.cancel?d=!1:this.drop(a,this.dragDropService.getData())}e.sourceCtrl&&e.sourceCtrl.removeDropMark&&e.sourceCtrl.removeDropMark()}d?this.dragDropService.clearData():this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle&&
this.updateLayout();var g=this,f=setTimeout(function(){g.dropMark(a);if(d){var b=g.dragDropService.getData();b={action:b.action,dragRow:b.source,dropPos:b.dropPos,event:a,isDropAllowed:!0,mousePos:g.commonService.getMousePos(a),sourceCtrl:b.sourceCtrl,targetCtrl:g,targetRow:b.target};g.dragDropComplete.emit(b)}g.isDragActive=!1;g.clearDragDropSettings();clearTimeout(f)},150)};c.prototype.clearDragDropSettings=function(){this.dragDropService.clearData();this.isDragHandleVisible=this.isDragActive=!1;
this.dragStartPos={x:0,y:0};this.dragEndPos={x:0,y:0};this.changeCursor()};c.prototype.drop=function(a,b){if(b&&b.sourceCtrl){var d="copy"==b.action&&b.clone?b.clone:b.source;if(Array.isArray(d)){for(var e=[],c=0;c<d.length;c++)e.push(d[c]);if(0<e.length){for(c=0;c<e.length;c++)this.processDataDrop(a,e[c],b);this.clearPrevSelection()}}else this.processDataDrop(a,d,b),this.clearPrevSelection();b.sourceCtrl!=b.targetCtrl&&b.sourceCtrl.updateLayout&&b.sourceCtrl.updateLayout();this.updateLayout()}this.isCtrlDragEntered=
!1};c.prototype.processDataDrop=function(a,b,d){a="copy"==d.action;"copy"!=d.action&&d.sourceCtrl&&d.sourceCtrl.removeRow&&(a=d.sourceCtrl.removeRow(b));if(a)switch(d.dropPos){case 0:this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle?this.insertRowAt(b,0,d.target):this.insertRowAt(b,-1,d.target);break;case 1:this.insertRowBefore(b,d.target);break;case 2:this.insertRowAfter(b,d.target);break;default:this.addRow(b)}};c.prototype.callAfterSelectEvent=function(a){this.afterSelect.emit({obj:a});
this.selectionChanged.emit(null)};c.prototype.rowDragEnd=function(a,b){var d=this.dragDropService.getData();d={action:a.shiftKey?"copy":"move",dragRow:d.source,dropPos:d.dropPos,event:a,mousePos:this.commonService.getMousePos(a),sourceCtrl:d.sourceCtrl,targetCtrl:this,targetRow:d.target};this.dragEnd.emit(d)};c.prototype.getEmptyObj=function(a){for(var b=null,d=0;d<this.scrollRowList.length;d++)if(this.scrollRowList[d].status==a){b=this.scrollRowList[d];break}return b};c.prototype.removeEmptyRow=
function(a){if(a=this.getEmptyObj(a))a=this.scrollRowList.indexOf(a),0<=a&&this.scrollRowList.splice(a,1)};c.prototype.updateDragHandlePos=function(a){};c.prototype.updateScrollRowListDragOver=function(a){};c.prototype.addCalendar=function(){var a=this;if(a.appRef&&a.isEditorPresent(integralui_core_1.IntegralUIEditorType.Date)&&!a.calendarRef){a.removeCalendar();var b=a.cmpResolver.resolveComponentFactory(integralui_datepicker_1.IntegralUICalendarPopup);b&&(a.calendarRef=a.appRef.createComponent(b),
a.calendarRef.instance&&(a.calendar=a.calendarRef.instance),a.hideCalendar(),a.calendar&&(a.calendar.closed.subscribe(function(b){a.hideCalendar()}),a.calendar.dateChanged.subscribe(function(b){a.hideCalendar();a.currentEditorCell&&1!=a.callCellValueChanging(a.currentEditorCell,b.date)&&(a.currentEditorCell.data[a.options.cellFields.value]=b.date,a.updateScrollRowList(),a.callCellValueChanged(a.currentEditorCell));a.isPopupDelayed=!0;setTimeout(function(){a.isPopupDelayed=!1},250)})))}};c.prototype.addColorPopup=
function(){var a=this;if(a.appRef&&a.isEditorPresent(integralui_core_1.IntegralUIEditorType.Color)&&!a.colorPopupRef){a.removeColorPopup();var b=a.cmpResolver.resolveComponentFactory(integralui_colorpicker_1.IntegralUIColorPickerPopup);b&&(a.colorPopupRef=a.appRef.createComponent(b),a.colorPopupRef.instance&&(a.colorPopup=a.colorPopupRef.instance),a.hideColorPopup(),a.colorPopup&&a.colorPopup.closed.subscribe(function(b){a.hideColorPopup();a.currentEditorCell&&1!=a.callCellValueChanging(a.currentEditorCell,
b.value)&&(a.currentEditorCell.data[a.options.cellFields.value]=b.value,a.updateScrollRowList(),a.callCellValueChanged(a.currentEditorCell));a.isPopupDelayed=!0;setTimeout(function(){a.isPopupDelayed=!1},250)}))}};c.prototype.addDropList=function(){var a=this;if(a.appRef&&a.isEditorPresent(integralui_core_1.IntegralUIEditorType.DropList)&&!a.dropListRef){a.removeDropList();var b=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUIListPopup);b&&(a.dropListRef=a.appRef.createComponent(b),
a.dropListRef.instance&&(a.dropList=a.dropListRef.instance),a.hideDropList(),a.dropList&&(a.dropList.closed.subscribe(function(b){a.hideDropList()}),a.dropList.selectionChanged.subscribe(function(b){a.hideDropList();b.item&&a.currentEditorCell&&1!=a.callCellValueChanging(a.currentEditorCell,b.item.value)&&(a.currentEditorCell.data[a.options.cellFields.value]=b.item.value,a.callCellValueChanged(a.currentEditorCell));a.isPopupDelayed=!0;setTimeout(function(){a.isPopupDelayed=!1},250)})))}};c.prototype.callCellValueChanging=
function(a,b){var d={cancel:!1,cell:a.data,text:a.data[this.options.cellFields.text],value:void 0!=b?b:a.data[this.options.cellFields.value]};this.cellValueChanging.emit(d);return d.cancel};c.prototype.callCellValueChanged=function(a){this.cellValueChanged.emit({cell:a.data,text:a.data[this.options.cellFields.text],value:a.data[this.options.cellFields.value]})};c.prototype.closeEditor=function(){this.currentEditorCell=null;this.originalEditorText="";this.originalEditorValue=null;this.isEditorFocused=
!1};c.prototype.editCheckBoxValue=function(a){if(a.isEditorEnabled){var b=void 0!=a.data[this.options.cellFields.value]?a.data[this.options.cellFields.value]:"unchecked";if(1!=this.callCellValueChanging(a)){b="checked"==b||1==b?"checked":a.editorSettings&&a.editorSettings.threeState&&"indeterminate"==b?"indeterminate":"unchecked";var d="unchecked";if(a.editorSettings&&a.editorSettings.threeState)switch(b){case "checked":d="unchecked";break;case "indeterminate":d="checked";break;case "unchecked":d=
"indeterminate"}else d="unchecked"==b?!0:!1;a.data[this.options.cellFields.value]=d;this.updateScrollRowList();this.callCellValueChanged(a)}}};c.prototype.editorClick=function(a){a.stopPropagation()};c.prototype.editorDblClickEvent=function(a){a.stopPropagation()};c.prototype.editorKeyDown=function(a,b){if(this.currentEditorCell)switch(a.keyCode){case 13:switch(b){case "numeric":this.callCellValueChanged(this.currentEditorCell);break;default:this.cellValueChanged.emit({cell:this.currentEditorCell.data,
orgText:this.originalEditorText,text:this.currentEditorCell.data[this.options.cellFields.text],value:this.currentEditorCell.data[this.options.cellFields.value]})}this.closeEditor();break;case 27:switch(b){case "numeric":this.currentEditorCell.data[this.options.cellFields.value]=this.originalEditorValue;break;default:this.currentEditorCell.data[this.options.cellFields.text]=this.originalEditorText}this.closeEditor()}};c.prototype.editorLostFocus=function(a){if(this.currentEditorCell)switch(a){case "numeric":this.currentEditorCell.data[this.options.cellFields.value]=
this.originalEditorValue;break;default:this.currentEditorCell.data[this.options.cellFields.text]=this.originalEditorText}this.closeEditor()};c.prototype.editorMouseDown=function(a,b){};c.prototype.editorMouseWheel=function(a){a.stopPropagation()};c.prototype.editorMouseTouch=function(a,b){a.stopPropagation()};c.prototype.editorNumericValueChange=function(a,b){b&&!isNaN(b)&&(a.data[this.options.cellFields.value]=Math.min(Math.max(Number(b),a.editorSettings&&void 0!=a.editorSettings.min?a.editorSettings.min:
-9999999),a.editorSettings&&void 0!=a.editorSettings.max?a.editorSettings.max:9999999),this.callCellValueChanged(a))};c.prototype.editorPreventDragStart=function(a){a.preventDefault();a.stopPropagation()};c.prototype.editorValueChanged=function(a,b){this.isLayoutUpdating||this.isScrollActive||this.callCellValueChanged(b)};c.prototype.getCellEditorClass=function(a){var b="",d=a.editorSettings&&a.editorSettings.style?a.editorSettings.style:{};switch(a.editorType){case integralui_core_1.IntegralUIEditorType.CheckBox:b=
"iui-editor-checkbox"+(d.general?" "+d.general:"");switch(a.editorValue){case "checked":b+=d.checked?" "+d.checked:" iui-editor-checkbox-checked";break;case "indeterminate":b+=d.indeterminate?" "+d.indeterminate:" iui-editor-checkbox-indeterminate";break;default:b+=d.unchecked?" "+d.unchecked:" iui-editor-checkbox-unchecked"}a.isEditorEnabled||(b+=d.disabled?" "+d.disabled:" iui-editor-checkbox-disabled")}return b};c.prototype.getCellEditorList=function(a){return void 0!=a[this.options.columnFields.editorSettings]&&
void 0!=a[this.options.columnFields.editorSettings].list?a[this.options.columnFields.editorSettings].list:[]};c.prototype.getCellEditorSettings=function(a){return void 0!=a[this.options.columnFields.editorSettings]?a[this.options.columnFields.editorSettings]:{}};c.prototype.getCellEditorStyle=function(a){var b={},d=a.editorSettings&&a.editorSettings.style?a.editorSettings.style:{};switch(a.editorType){case integralui_core_1.IntegralUIEditorType.Rating:b=d}return b};c.prototype.getCellEditorType=function(a){return void 0!=
a[this.options.columnFields.editorType]?a[this.options.columnFields.editorType]:integralui_core_1.IntegralUIEditorType.None};c.prototype.getCellEditorVisibility=function(a,b){var d=!0;switch((void 0!=b[this.options.cellFields.editorSettings]?b[this.options.cellFields.editorSettings]:{}).visible){case integralui_core_1.IntegralUIVisibility.None:d=!1}return d};c.prototype.getCellField=function(a){switch(a){case "text":return this.options.cellFields.text;case "value":return this.options.cellFields.value}};
c.prototype.getCellText=function(a){return void 0!=a.data[this.options.cellFields.text]?a.data[this.options.cellFields.text]:""};c.prototype.getCellValue=function(a){var b=void 0!=a.data[this.options.cellFields.value]?a.data[this.options.cellFields.value]:null;switch(a.editorType){case integralui_core_1.IntegralUIEditorType.CheckBox:a.editorSettings&&(b="checked"==b||1==b?"checked":a.editorSettings.threeState&&"indeterminate"==b?"indeterminate":"unchecked");break;case integralui_core_1.IntegralUIEditorType.Color:if(a.editorSettings)switch(a.editorSettings.colorFormat){case integralui_core_1.IntegralUIColorFormat.HEX:b=
null!==b?"object"===typeof b?b.hex:b:"";break;default:b=null!==b?"object"===typeof b?b.rgb:b:""}break;case integralui_core_1.IntegralUIEditorType.Date:var d="en-US",e={year:"numeric",month:"numeric",day:"numeric"};if(a.editorSettings)switch(d=a.editorSettings.locales?a.editorSettings.locales:"en-US",a.editorSettings.format){case integralui_core_1.IntegralUIDateFormat.Long:e.weekday="long";break;case integralui_core_1.IntegralUIDateFormat.Custom:e=a.editorSettings.formatOptions}b=b?b.toLocaleString(d,
e):"";break;case integralui_core_1.IntegralUIEditorType.DropList:b=this.commonService.isObject(b)?b?b.text:"":void 0!=b&&a.editorSettings?this.findItemByValue(b,a.editorSettings.items):"";break;case integralui_core_1.IntegralUIEditorType.Image:b=Array.isArray(b)?b:[{src:b}];break;case integralui_core_1.IntegralUIEditorType.Progress:b=this.getEditorProgressValue(a);break;case integralui_core_1.IntegralUIEditorType.Numeric:b=void 0!=a.data[this.options.cellFields.value]?a.data[this.options.cellFields.value]:
"";break;case integralui_core_1.IntegralUIEditorType.TextBox:b=void 0!=a.data[this.options.cellFields.text]?a.data[this.options.cellFields.text]:""}return b};c.prototype.getEditorColorValue=function(a){var b="";if(a.editorSettings)switch(a.editorSettings.colorFormat){case integralui_core_1.IntegralUIColorFormat.HEX:b=a.editorValue;break;default:b="rgba("+a.editorValue+", 1)"}return b};c.prototype.findItemByValue=function(a,b){for(var d="",e=0;e<b.length;e++)if(void 0!=b[e].value&&b[e].value==a){d=
void 0!=b[e].text&&""!=b[e].text?b[e].text:b[e].value.toString();break}return d};c.prototype.getEditorProgressStyle=function(a){return{width:a.editorValue+"%","z-index":2}};c.prototype.getEditorProgressValue=function(a){var b=a.editorSettings&&void 0!=a.editorSettings.min?a.editorSettings.min:0,d=a.editorSettings&&void 0!=a.editorSettings.max?a.editorSettings.max:100;return(a=a.data[this.options.cellFields.value])&&!isNaN(a)&&!isNaN(d)&&0<d?100*Math.min(Math.max(a,b),d)/d:0};c.prototype.getHoverRow=
function(){return this.hoverRow};c.prototype.hideCalendar=function(){this.calendar&&(this.calendar.display="none")};c.prototype.hideColorPopup=function(){this.colorPopup&&(this.colorPopup.display="none")};c.prototype.hideDropList=function(){this.dropList&&(this.dropList.display="none")};c.prototype.isCellEditorEnabled=function(a,b){return 0!=(void 0!=b[this.options.cellFields.editorSettings]?b[this.options.cellFields.editorSettings]:{}).enabled?!0:!1};c.prototype.isEditorPresent=function(a){var b;
(b=this.isEditorPresentInList(a))?b||(b=this.isEditorPresentInList(a,"right")):b=this.isEditorPresentInList(a,"left");return b};c.prototype.isEditorPresentInList=function(a,b){var d=this,e=this.getColumnList(b);return(e=e?e.filter(function(b){return b.data[d.options.columnFields.editorType]===a}):null)&&0<e.length?!0:!1};c.prototype.openEditor=function(a,b,d){this.currentEditorCell=b;this.isEditorFocused=!0;switch(d){case "numeric":this.originalEditorValue=b.data[this.options.cellFields.value];break;
default:this.originalEditorText=b.data[this.options.cellFields.text]}};c.prototype.removeCalendar=function(){this.calendar&&(this.calendar.closed&&this.calendar.closed.unsubscribe(),this.calendar.dateChanged&&this.calendar.dateChanged.unsubscribe());this.calendarRef&&this.calendarRef.destroy();this.calendar=null};c.prototype.removeColorPopup=function(){this.colorPopup&&this.colorPopup.closed&&this.colorPopup.closed.unsubscribe();this.colorPopupRef&&this.colorPopupRef.destroy();this.colorPopup=null};
c.prototype.removeDropList=function(){this.dropList&&(this.dropList.closed&&this.dropList.closed.unsubscribe(),this.dropList.selectionChanged&&this.dropList.selectionChanged.unsubscribe());this.dropListRef&&this.dropListRef.destroy();this.dropList=null};c.prototype.showPopup=function(a,b,d,e){a=this.commonService.getShiftPos();d=this.commonService.getPageRect(d.nativeElement);e=this.commonService.getPageRect(e.nativeElement);switch(b.editorType){case integralui_core_1.IntegralUIEditorType.Color:if(this.colorPopup){this.colorPopup.allowAnimation=
!1;this.colorPopup.colorFormat=b.editorSettings&&void 0!=b.editorSettings.colorFormat?b.editorSettings.colorFormat:integralui_core_1.IntegralUIColorFormat.RGB;this.colorPopup.display="block";this.colorPopup.originalColorFormat=this.colorPopup.colorFormat;this.colorPopup.position={x:e.left+a.x-1,y:d.bottom+a.y};this.colorPopup.size={width:this.colorPanelSize.width,height:0};this.colorPopup.maxSize={width:this.colorPanelSize.width,height:this.colorPanelSize.height};null!=b.data.value&&(this.colorPopup.value=
"object"===typeof b.data.value?this.colorPopup.colorFormat==integralui_core_1.IntegralUIColorFormat.HEX?b.data.value.hex:b.data.value.rgb:b.data.value);if(!this.colorPopup.value)switch(this.colorPopup.colorFormat){case integralui_core_1.IntegralUIColorFormat.HEX:this.colorPopup.value="#000000";break;default:this.colorPopup.value="0, 0, 0"}this.colorPopup.size={width:this.colorPopup.maxSize.width,height:this.colorPopup.maxSize.height};this.allowAnimation&&(this.colorPopup.position.y-=2);this.colorPopup.open();
this.currentEditorCell=b;this.colorPopup.focus()}break;case integralui_core_1.IntegralUIEditorType.Date:this.calendar&&(this.calendar.allowAnimation=b.editorSettings&&void 0!=b.editorSettings.allowAnimation?b.editorSettings.allowAnimation:!0,this.calendar.animationSpeed=b.editorSettings&&void 0!=b.editorSettings.animationSpeed?b.editorSettings.animationSpeed:integralui_core_1.IntegralUISpeedMode.Normal,this.calendar.calendarStyle=b.editorSettings&&b.editorSettings.style&&b.editorSettings.style.calendar?
b.editorSettings.style.calendar:null,this.calendar.date=b.data.value,this.calendar.display="block",this.calendar.firstDayOfWeek=b.editorSettings&&void 0!=b.editorSettings.firstDayOfWeek?b.editorSettings.firstDayOfWeek:integralui_core_1.IntegralUIWeekDays.Sunday,this.calendar.position={x:e.left+a.x-1,y:d.bottom+a.y},this.calendar.size=b.editorSettings&&b.editorSettings.calendarSize?b.editorSettings.calendarSize:{width:250,height:200},this.allowAnimation&&(this.calendar.position.y-=2),this.calendar.refresh(),
this.calendar.open(),this.currentEditorCell=b,this.calendar.focus());break;case integralui_core_1.IntegralUIEditorType.DropList:this.dropList&&(this.dropList.allowAnimation=b.editorSettings&&void 0!=b.editorSettings.allowAnimation?b.editorSettings.allowAnimation:!0,this.dropList.animationSpeed=b.editorSettings&&void 0!=b.editorSettings.animationSpeed?b.editorSettings.animationSpeed:integralui_core_1.IntegralUISpeedMode.Normal,this.dropList.display="block",this.dropList.items=b.editorSettings&&b.editorSettings.items?
b.editorSettings.items:[],this.dropList.listStyle=b.editorSettings&&b.editorSettings.style&&b.editorSettings.style.list?b.editorSettings.style.list:null,this.dropList.minWidth=b.editorSettings&&b.editorSettings.minWidth?b.editorSettings.minWidth:e.width,this.dropList.maxVisibleItems=b.editorSettings&&b.editorSettings.maxVisibleItems?b.editorSettings.maxVisibleItems:5,this.dropList.position={x:e.left+a.x-1,y:d.bottom+a.y},this.dropList.size={width:Math.max(e.width,this.dropList.minWidth),height:0},
this.dropList.refresh(),this.dropList.open(),this.currentEditorCell=b,this.dropList.focus())}};c.prototype.selectTextBoxContent=function(a){a.target&&setTimeout(function(){a.target.setSelectionRange(0,a.target.value.length)},1)};c.prototype.expandBoxMouseDown=function(a,b){this.isEnabled&&(1!=a.buttons||this.isExpandBoxTouched||this.toggle(b),this.isExpandBoxTouched=!1);a.stopPropagation()};c.prototype.expandBoxMouseUp=function(a,b){this.isExpandBoxTouched=!1;a.stopPropagation()};c.prototype.expandBoxTouchStart=
function(a,b){this.isEnabled&&(this.isExpandBoxTouched=!0,this.toggle(b));a.stopPropagation()};c.prototype.toggle=function(a,b){};c.prototype.updateExpandingCell=function(a,b){var d=0,e=this.getExpandingColumn();e&&(d=e[this.options.columnFields.id]);(d=this.getCellByColumnId(a[this.options.rowFields.cells],d))&&(d[this.options.cellFields.expanded]=b)};c.prototype.convertToCSV=function(a){for(var b="",d=0;d<a.length;d++){var e="",c=a[d];if(0<c.length){for(var g=0;g<c.length;g++)e+=c[g].text+",";e=
e.slice(0,-1);e+="\r\n"}b+=e}return b};c.prototype.exportToCSV=function(){for(var a=[],b=[],d=0;d<this.currentColumnList.length;d++){var e=this.currentColumnList[d].data;e={text:void 0!=e[this.options.columnFields.headerText]?e[this.options.columnFields.headerText].toString():""};b.push(e)}a.push(b);for(var c=this.getFullList(),g=0;g<c.length;g++){var f=c[g];b=[];for(d=0;d<this.currentColumnList.length;d++){var k=this.getCellByColumnId(f[this.options.rowFields.cells],this.currentColumnList[d].data[this.options.columnFields.id]);
e={};e.text=k?k.value?k.value instanceof Date?k.value.toLocaleDateString():JSON.stringify(k.value):k.text?0<=k.text.indexOf(",")?JSON.stringify(k.text):k.text:"":"";b.push(e)}a.push(b)}return this.convertToCSV(a)};c.prototype.exportToJSON=function(a,b,d,e){a=this.exportColumnsToJSON(a,d);b=this.exportRowsToJSON(b,d,e);return'[\n{ "columns": '+a+' },\n{ "rows": '+b+" }\n]"};c.prototype.exportColumnsToJSON=function(a,b){return JSON.stringify(this.columns,a?a:[this.options.columnFields.allowDrag,this.options.columnFields.allowDrop,
this.options.columnFields.allowFilter,this.options.columnFields.allowGrouping,this.options.columnFields.allowResize,this.options.columnFields.canSelect,this.options.columnFields.cellTemplateUrl,this.options.columnFields.columns,this.options.columnFields.contentAlignment,this.options.columnFields.contextMenu,this.options.columnFields.editorType,this.options.columnFields.editorSettings,this.options.columnFields.editorTemplate,this.options.columnFields.filterParams,this.options.columnFields.fixed,this.options.columnFields.fixedWidth,
this.options.columnFields.footerAlignment,this.options.columnFields.footerContent,this.options.columnFields.footerText,this.options.columnFields.footerTooltip,this.options.columnFields.groupText,this.options.columnFields.headerAlignment,this.options.columnFields.headerContent,this.options.columnFields.headerText,this.options.columnFields.headerTooltip,this.options.columnFields.icon,this.options.columnFields.id,this.options.columnFields.minWidth,this.options.columnFields.maxWidth,this.options.columnFields.pid,
this.options.columnFields.selected,this.options.columnFields.style,this.options.columnFields.visible,this.options.columnFields.width],b?b:null)};c.prototype.exportRowsToJSON=function(a,b,d){b=b?b:null;var e=0==d?this.rows:this.getFullList();a=a?a:[this.options.rowFields.allowCellFocus,this.options.rowFields.allowDrag,this.options.rowFields.allowDrop,this.options.rowFields.allowEdit,this.options.rowFields.allowFocus,this.options.rowFields.autoCheck,this.options.rowFields.canSelect,this.options.rowFields.cells,
this.options.rowFields.checked,this.options.rowFields.checkState,this.options.rowFields.content,this.options.rowFields.contentVisibility,this.options.rowFields.contextMenu,this.options.rowFields.gid,this.options.rowFields.enabled,this.options.rowFields.expanded,this.options.rowFields.fixed,this.options.rowFields.hasChildren,this.options.rowFields.icon,this.options.rowFields.id,this.options.rowFields.pid,this.options.rowFields.selected,this.options.rowFields.statusIcon,this.options.rowFields.style,
this.options.rowFields.text,this.options.rowFields.tooltip,this.options.rowFields.value,this.options.rowFields.visible,this.options.cellFields.allowDrag,this.options.cellFields.allowEdit,this.options.cellFields.cid,this.options.cellFields.content,this.options.cellFields.contextMenu,this.options.cellFields.editorSettings,this.options.cellFields.enabled,this.options.cellFields.isGroup,this.options.cellFields.rid,this.options.cellFields.selected,this.options.cellFields.style,this.options.cellFields.tag,
this.options.cellFields.text,this.options.cellFields.tooltip,this.options.cellFields.value,this.options.cellFields.valueID,this.options.cellFields.valueType];0==d&&a.push(this.options.rowFields.rows);return JSON.stringify(e,a,b)};c.prototype.filter=function(a,b){if(a)a[this.options.columnFields.filterParams]=b;else{for(var d=0;d<this.flatCurrentColumnList.length;d++)this.flatCurrentColumnList[d][this.options.columnFields.filterParams]=null;for(d=0;d<this.flatCurrentLeftColumnList.length;d++)this.flatCurrentLeftColumnList[d][this.options.columnFields.filterParams]=
null;for(d=0;d<this.flatCurrentRightColumnList.length;d++)this.flatCurrentRightColumnList[d][this.options.columnFields.filterParams]=null}this.updateLayout();this.change.emit({type:"filtering"})};c.prototype.changeCursor=function(a){a="default";if(this.isEnabled)if(this.isDragActive&&this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle)a="move";else if(0<=this.resizeColumnIndex||this.isColumnResizing)a="ew-resize";this.ctrlCursor=a};c.prototype.checkStatus=function(a){var b=!1;switch(a){case "column-reorder":b=
this.columnReorderActive}return b};c.prototype.clearHoverRow=function(a){};c.prototype.cloneRow=function(a){return this.dataService.clone(a,this.rowDataKey)};c.prototype.createCloneList=function(a){for(var b=[],d=0;d<a.length;d++)b.push(this.cloneRow(a[d]));return b};c.prototype.createFlatColumnList=function(a){var b=[];a.map(function(a){return a.map(function(a){return b.push(a)})});return b};c.prototype.createFlatList=function(a,b,d){var e=this;a&&a.map(function(a){d.push(a);e.createFlatList(a[b],
b,d)})};c.prototype.createColumnListInRange=function(a,b){var d=this;a&&a.map(function(a){var e={colIndex:d.getColumnIndexFromList(a),data:a,isVisible:d.isColumnExpanded(a)&&a[d.options.columnFields.columns]&&0!=a[d.options.columnFields.columns].length?!1:!0};b.push(e);d.isColumnExpanded(a)&&d.createColumnListInRange(a[d.options.columnFields.columns],b)})};c.prototype.getColumnListInRange=function(a){var b=[],d=[];switch(a){case "left":d=this.completeLeftColumnList;break;case "right":d=this.completeRightColumnList;
break;default:d=this.completeColumnList}if(0<d.length){d=d[0];var e=a?0:this.viewIndexRange.left,c=a?d.length-1:this.viewIndexRange.right;this.isIndexInRange(e,d);this.isIndexInRange(c,d);a=d.filter(function(a,b){return b>=e&&b<=c}).map(function(a){return a.data});this.createColumnListInRange(a,b)}return b};c.prototype.getCellByColumnId=function(a,b){var d=null;if(a)for(var e=0;e<a.length;e++)if(a[e][this.options.cellFields.cid]==b){d=a[e];break}return d};c.prototype.getCellWidth=function(a,b,d){d=
this.getColumnWidth(b);b&&this.getColumnIndex(b)==this.expandColIndex&&(d-=a.indent);return 0<d?d:0};c.prototype.getColumnAllowResize=function(a){return(a=a[this.options.columnFields.allowResize])?{left:this.commonService.isFieldAvailable(a.left,!0),right:this.commonService.isFieldAvailable(a.right,!0)}:{left:!0,right:!0}};c.prototype.getColumnById=function(a){var b=null,d=[];this.createFlatList(this.dataService.getList(null,this.columnDataKey),this.options.columnFields.columns,d);if(d)for(var e=
0;e<d.length;e++)if(d[e][this.options.columnFields.id]==a){b=d[e];break}return b};c.prototype.getColumnCurrentIndex=function(a){return a?this.getColumnIndexFromList(a):-1};c.prototype.getColumnIndexFromList=function(a){for(var b=-1,d=this.getColumnList(a[this.options.columnFields.fixed]),e=0;e<d.length;e++)if(d[e].data==a){b=e;break}return b};c.prototype.getColumnList=function(a){switch(a){case "left":return this.flatCompleteLeftColumnList;case "right":return this.flatCompleteRightColumnList}return this.flatCompleteColumnList};
c.prototype.getCurrentColumnList=function(a){switch(a){case "left":return this.flatCurrentLeftColumnList;case "right":return this.flatCurrentRightColumnList}return this.flatCurrentColumnList};c.prototype.getColumnIndex=function(a,b){var d=b?b:this.dataService.getList(null,this.columnDataKey);return d?d.indexOf(a):-1};c.prototype.getColumnRealIndex=function(a){var b=this.dataService.getList(null,this.columnDataKey);return 0<=a&&a<b.length&&a<this.currentColumnList.length?b.indexOf(this.currentColumnList[a].data):
-1};c.prototype.getPrevColumnIndex=function(a,b){var d=b?b:this.dataService.getList(null,this.columnDataKey);d=d?d.indexOf(a):-1;return 0<d?d-1:-1};c.prototype.getPrevFlatColumn=function(a,b,d){var e=this,c=null,g=this.getCurrentColumnList(b),f=g.filter(function(b){return b[e.options.columnFields.pid]==a[e.options.columnFields.pid]});f=f?f.indexOf(a):-1;f=0<f?f-1:-1;d&&0<=f?c=this.isColumnWidthFixed(g[f])?this.getPrevFlatColumn(g[f],b,d):g[f]:0<=f&&(c=g[f]);return c};c.prototype.getPrevFlatColumnIndex=
function(a,b,d){return(a=this.getPrevFlatColumn(a,b,d))?this.getColumnIndexFromList(a):-1};c.prototype.getNextColumnIndex=function(a,b){var d=b?b:this.dataService.getList(null,this.columnDataKey),e=d?d.indexOf(a):-1;return d&&e<d.length-1?e+1:d.length-1};c.prototype.getNextFlatColumn=function(a,b,d){var e=this,c=null,g=this.getCurrentColumnList(b),f=g.filter(function(b){return b[e.options.columnFields.pid]==a[e.options.columnFields.pid]}),k=f?f.indexOf(a):-1;k=f&&k<f.length-1?k+1:-1;d&&0<=k?c=this.isColumnWidthFixed(g[k])?
this.getNextFlatColumn(g[k],b,d):g[k]:0<=k&&(c=g[k]);return c};c.prototype.getNextFlatColumnIndex=function(a,b,d){return(a=this.getNextFlatColumn(a,b,d))?this.getColumnIndexFromList(a):-1};c.prototype.getLastColumnIndex=function(a){return(a=a?a:this.dataService.getList(null,this.columnDataKey))?a.length-1:-1};c.prototype.getColumnWidth=function(a,b){var d=this.options.columnFields.width;switch(b){case "min":return d=this.options.columnFields.minWidth,d=a&&void 0!=a[d]?a[d]:0,this.isThereChildColumns(a,
!0)?this.getColumnWidthFromChildren(a):d;case "max":return d=this.options.columnFields.maxWidth,d=a&&void 0!=a[d]?a[d]:9999999,this.isThereChildColumns(a,!0)?this.getColumnWidthFromChildren(a):d}return a&&void 0!=a[d]?a[d]:100};c.prototype.getColumnWidthFromChildren=function(a){var b=100;if(a){b=this.options.columnFields.width;var d=0;if(this.isThereChildColumns(a)){a=a[this.options.columnFields.columns];for(var e=0;e<a.length;e++){var c=void 0!=a[e][b]?a[e][b]:100;c=this.isThereChildColumns(a[e])?
this.getColumnWidthFromChildren(a[e]):c;d+=c+10}b=d-10}else b=void 0!=a[b]?a[b]:100}return b};c.prototype.getMinColumnWidthFromChildren=function(a){return(a=a[this.options.columnFields.columns])&&0<a.length?10*(a.length-1):0};c.prototype.setColumnWidth=function(a,b,d){if(a&&(d||1!=a[this.options.columnFields.fixedWidth])){d=Math.max(this.getColumnWidth(a,"min"),this.getMinColumnWidthFromChildren(a));var e=this.getColumnWidth(a,"max");b=Math.min(e,Math.max(d,b));a[this.options.columnFields.width]=
0<b?b:0}};c.prototype.getPrevColumn=function(a,b){var d=null,e=this.getColumnIndexFromList(a)-1;if(0<=e)for(var c=this.getCurrentColumnList(a[this.options.columnFields.fixed]);0<=e;e--){var g=this.getColumnWidth(c[e]),f=this.getColumnWidth(c[e],"min");g=b?!0:g>f;if(!this.isColumnWidthFixed(c[e])&&g){d=c[e];break}}return d};c.prototype.getExpandingColumn=function(){var a=this.dataService.getList(null,this.columnDataKey);return 0<=this.expandColIndex&&this.expandColIndex<a.length?a[this.expandColIndex]:
null};c.prototype.updateExpandingColumnID=function(){var a=this.getExpandingColumn();a&&(this.currentExpandColumnID=a[this.options.columnFields.id])};c.prototype.getFilterTree=function(a){for(var b=null,d=this.getCurrentColumnList(a[this.options.columnFields.fixed]),e=0;e<d.length;e++)if(d[e]==a){b=d[e].filter;break}return b};c.prototype.getCurrentList=function(){for(var a=[],b=0;b<this.currentRowList.length;b++)a.push(this.currentRowList[b].data);return a};c.prototype.getList=function(a,b){switch(a){case "current":return this.getCurrentList();
case "selected":return this.currentSelectedRows}return this.dataService.getList(b,this.rowDataKey)};c.prototype.getFullList=function(){return[]};c.prototype.getTopRow=function(){return 0<this.scrollRowList.length?this.scrollRowList[0].data:null};c.prototype.getObjFromRow=function(a){for(var b=null,d=0;d<this.currentRowList.length;d++)if(this.currentRowList[d].data==a){b=this.currentRowList[d];break}return b};c.prototype.createScrollObjFromRow=function(a,b,d){return null};c.prototype.getObjIndexFromScrollList=
function(a,b){var d=-1,e=this.scrollRowList;switch(b){case "left":e=this.scrollLeftRowList;break;case "right":e=this.scrollRightRowList}for(var c=0;c<e.length;c++)if(e[c].data==a){d=c;break}return d};c.prototype.getObjFromScrollList=function(a,b){var d=this.scrollRowList;switch(b){case "left":d=this.scrollLeftRowList;break;case "right":d=this.scrollRightRowList}var e=this.getObjIndexFromScrollList(a,b);return this.isIndexInRange(e,d)?d[e]:null};c.prototype.getRowCurrentIndex=function(a){return a?
(a=this.getObjFromRow(a))&&this.currentRowList?this.currentRowList.indexOf(a):-1:-1};c.prototype.getRowIndent=function(a,b,d){d=this.columnPadding.left;this.isExpandBoxAllowed(b)&&(d+=a.indent);return d};c.prototype.getRowLevel=function(a){return 0};c.prototype.getRowList=function(a){switch(a){case "left":return this.scrollLeftRowList;case "right":return this.scrollRightRowList}return this.scrollRowList};c.prototype.getRowFromComponent=function(a){return null};c.prototype.getRowScrollIndex=function(a){for(var b=
-1,d=0;d<this.scrollRowList.length;d++)if(this.scrollRowList[d].data==a){b=d;break}return b};c.prototype.isChildOf=function(a,b){return!1};c.prototype.isColumnExpanded=function(a){return a?a[this.options.columnFields.expanded]||void 0===a[this.options.columnFields.expanded]?!0:!1:!0};c.prototype.isColumnFixed=function(a,b){return b?a[this.options.columnFields.fixed]==b:!a||"left"!=a[this.options.columnFields.fixed]&&"right"!=a[this.options.columnFields.fixed]?!1:!0};c.prototype.isColumnVisible=function(a){return a&&
0!=a[this.options.columnFields.visible]?!0:!1};c.prototype.isColumnWidthFixed=function(a){return 1==a[this.options.columnFields.fixedWidth]?!0:a[this.options.columnFields.columns]&&0<a[this.options.columnFields.columns].length?this.areChildColumnsFixed(a[this.options.columnFields.columns]):!1};c.prototype.isComponentIndexInRange=function(a){return this.rowList?0<=a&&a<this.rowList.length:!1};c.prototype.isContentAllowed=function(a,b){var d=this.rowContentVisibility==integralui_core_1.IntegralUIContentVisibility.Both;
switch(b){case "hover":d=(d&&(!this.isSelectedTemplatePresent||!a[this.options.rowFields.selected])||this.rowContentVisibility==integralui_core_1.IntegralUIContentVisibility.Hover)&&(void 0==a[this.options.rowFields.contentVisibility]||a[this.options.rowFields.contentVisibility]==integralui_core_1.IntegralUIContentVisibility.Hover||a[this.options.rowFields.contentVisibility]==integralui_core_1.IntegralUIContentVisibility.Both);break;case "select":d=(d||this.rowContentVisibility==integralui_core_1.IntegralUIContentVisibility.Select)&&
(void 0==a[this.options.rowFields.contentVisibility]||a[this.options.rowFields.contentVisibility]==integralui_core_1.IntegralUIContentVisibility.Select||a[this.options.rowFields.contentVisibility]==integralui_core_1.IntegralUIContentVisibility.Both)}return d};c.prototype.isExpandBoxAllowed=function(a){return a?this.getColumnIndex(a)==this.expandColIndex:!1};c.prototype.isIndexInRange=function(a,b){return b?0<=a&&a<b.length:!1};c.prototype.isRowAllowed=function(a,b){if(0==a[this.options.rowFields.visible])return!1;
if(0==this.options.allowFilter)return!0;var d=!0;if(a)for(var e,c,g=0;g<a[this.options.rowFields.cells].length;g++){d=!0;c=a[this.options.rowFields.cells][g];e=c[this.options.cellFields.cid];e=this.getColumnById(e);!e&&g<this.flatCurrentColumnList.length&&(e=this.flatCurrentColumnList[g].data);if(e&&e[this.options.columnFields.filterParams]){var f=e[this.options.columnFields.filterParams],k=c[this.options.cellFields.value]?c[this.options.cellFields.value]:c[this.options.cellFields.text];f&&(f.callback?
d=f.callback(k,c,a):(d=this.filterService.match(k,f.conditions,f.formula,this.getFilterTree(e),f.caseSensitive),!d&&f.allowParent&&(d=this.filterIsThereChildren(a,b))))}if(!d)break}return d};c.prototype.filterIsThereChildren=function(a,b){var d=!1,e=a[this.options.rowFields.rows];if(e)for(var c=0;c<e.length&&!(d=this.isRowAllowed(e[c],b));c++);return d};c.prototype.isRowEnabled=function(a){return!0};c.prototype.isRowFixed=function(a){return!1};c.prototype.isRowHovered=function(a){return this.isDragActive||
this.isScrollTimerActive||!a||a!=this.hoverRow?!1:!0};c.prototype.isRowSelected=function(a){return a&&1==a[this.options.rowFields.selected]?!0:!1};c.prototype.isParentOf=function(a,b){return!1};c.prototype.isThereFixedColumns=function(a){switch(a){case "left":return 0<this.currentLeftColumnList.length;case "right":return 0<this.currentRightColumnList.length}return!1};c.prototype.processStateChanged=function(){};c.prototype.updateExpandStatus=function(){};c.prototype.resetHoverRowObj=function(){this.hoverRowObj=
{data:{}}};c.prototype.getSelectBlockRect=function(a){var b={left:0,top:"-9999999px",height:0,width:0};a<this.blockSelectRect.length&&(b={left:this.blockSelectRect[a].left+"px",top:this.blockSelectRect[a].top+"px",height:this.blockSelectRect[a].height+"px",width:this.blockSelectRect[a].width+"px"});return b};c.prototype.hoverBlockMouseMove=function(a){!this.isEnabled||this.isScrollActive||this.isColumnResizing||this.columnReorderActive||this.hoverRow||this.rowMouseEnter(a,this.hoverRowObj)};c.prototype.hoverBlockMouseLeave=
function(a){!this.isEnabled||this.isScrollActive||this.isColumnResizing||this.columnReorderActive||this.rowMouseLeave(a,this.hoverRowObj)};c.prototype.rowMouseEnter=function(a,b){};c.prototype.rowMouseLeave=function(a,b){};c.prototype.getParentColumnList=function(a){var b=this,d=[];if(a&&a[this.options.columnFields.pid]){var e=this.getCurrentColumnList(a[this.options.columnFields.fixed]).filter(function(d){return d[b.options.columnFields.id]==a[b.options.columnFields.pid]});(e=0<e.length?e[0]:null)&&
e[this.options.columnFields.columns]&&0<e[this.options.columnFields.columns].length&&(d=e[this.options.columnFields.columns])}else d=this.dataService.getList(null,this.columnDataKey);return d};c.prototype.moveColumn=function(a,b,d,e){if(a){if(b!=integralui_core_1.IntegralUIMoveDirection.Left&&b!=integralui_core_1.IntegralUIMoveDirection.Right){var c=this.getParentColumnList(a);if(c){var g=c.indexOf(a);0<=g?c.splice(g,1):null}}c=-1;g=this.getParentColumnList(d);switch(b){case integralui_core_1.IntegralUIMoveDirection.After:c=
d?this.getNextColumnIndex(d,g):-1;break;case integralui_core_1.IntegralUIMoveDirection.At:c=e;break;case integralui_core_1.IntegralUIMoveDirection.Before:c=d?this.getColumnIndex(d,g):-1;break;case integralui_core_1.IntegralUIMoveDirection.First:c=0;break;case integralui_core_1.IntegralUIMoveDirection.Last:c=this.getLastColumnIndex(g)+1;break;case integralui_core_1.IntegralUIMoveDirection.Left:c=this.getPrevColumnIndex(a,g);break;case integralui_core_1.IntegralUIMoveDirection.Right:c=this.getNextColumnIndex(a,
g)}g&&0<=c&&(this.allowUpdate=!1,b!=integralui_core_1.IntegralUIMoveDirection.Left&&b!=integralui_core_1.IntegralUIMoveDirection.Right?g.splice(c,0,a):c<g.length&&(b=g.indexOf(a),this.moveObject(b,c,g)),this.allowUpdate=!0,this.columnOrderChanged.emit({column:a}),this.updateLayout())}};c.prototype.paginatorMouseEnter=function(a){this.blockHoverRect.top=-9999999};c.prototype.scrollMouseEnter=function(a){this.blockHoverRect.top=-9999999};c.prototype.cellGotFocus=function(a){this.isEnabled&&this.refresh()};
c.prototype.cellLostFocus=function(a){this.isEnabled&&this.refresh()};c.prototype.onContentScroll=function(a){a.srcElement.scrollTop=0;a.srcElement.scrollLeft=0;a.target.scrollTop=0;a.target.scrollLeft=0};c.prototype.onGridScroll=function(a){a.srcElement.scrollTop=0;a.srcElement.scrollLeft=0;a.target.scrollTop=0;a.target.scrollLeft=0};c.prototype.cellMouseEnter=function(a,b){this.isEnabled&&(this.cellHover.emit({cell:b.data}),this.hoverCell=b)};c.prototype.cellMouseLeave=function(a){this.hoverCell=
null};c.prototype.cellMouseDown=function(a,b){if(this.isEnabled&&1==a.which&&(this.currentFocusCell=this.clickedCell=b,b.editorType))switch(b.editorType){case integralui_core_1.IntegralUIEditorType.CheckBox:this.editCheckBoxValue(b)}};c.prototype.cellMouseUp=function(a,b,d,e,c){if(1==a.which&&b.isEditorEnabled&&b.isEditorVisible&&this.clickedCell==b)switch(b.editorType){case integralui_core_1.IntegralUIEditorType.Color:this.openDropDown(a,b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.Date:this.openDropDown(a,
b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.DropList:this.openDropDown(a,b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.Numeric:this.openEditor(a,b,"numeric");break;case integralui_core_1.IntegralUIEditorType.TextBox:this.openEditor(a,b)}this.clickedCell=null};c.prototype.cellTouchEnd=function(a,b,d,e,c){if(b.isEditorEnabled&&b.isEditorVisible)switch(b.editorType){case integralui_core_1.IntegralUIEditorType.CheckBox:this.editCheckBoxValue(b);break;case integralui_core_1.IntegralUIEditorType.Color:this.openDropDown(a,
b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.Date:this.openDropDown(a,b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.DropList:this.openDropDown(a,b,d,e,c);break;case integralui_core_1.IntegralUIEditorType.Numeric:this.openEditor(a,b,"numeric");break;case integralui_core_1.IntegralUIEditorType.TextBox:this.openEditor(a,b)}};c.prototype.openDropDown=function(a,b,d,e,c){};c.prototype.cellKeyDown=function(a,b){if(this.isEnabled){var d={cancel:!1,cell:b.data,event:a};this.keyDown.emit(d);
switch(a.keyCode){case 13:this.beforeEdit.emit(d);break;case 33:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processPageUpKey(b));break;case 34:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processPageDownKey(b));break;case 35:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processEndKey(b));break;case 36:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=
!0,this.processHomeKey(b));break;case 37:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processLeftArrowKey(b));break;case 38:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processUpArrowKey(b));break;case 39:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processRightArrowKey(b));break;case 40:!d.cancel&&this.options.allowFocus&&(a.preventDefault(),this.isKeyboardActive=!0,this.processDownArrowKey(b))}}this.isKeyPressed=
!0};c.prototype.cellKeyPress=function(a,b){var d={cancel:!1,cell:b.data,event:a};this.isEnabled&&this.keyPress.emit(d)};c.prototype.cellKeyUp=function(a,b){var d={cancel:!1,cell:b.data,event:a};this.isEnabled&&this.keyUp.emit(d);this.isKeyPressed=!1};c.prototype.isCellFocused=function(a){return this.currentFocusCell?a.data==this.currentFocusCell.data:!1};c.prototype.processDownArrowKey=function(a,b){var d=this.getDownCell(this.isKeyPressed?this.currentFocusCell:a);if(d&&!d.isEmpty){this.updateFocusCell(d);
var e=this.getRowFromCell(d);e&&(this.processRowSelection(b,e.data),this.isLastRow(d)&&(this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y+2*this.avgRowHeight}),this.currentFocusCell.rowIndex-=2),this.refresh())}return d&&!d.isEmpty?d:null};c.prototype.processEndKey=function(a,b){var d=null;if(0<this.scrollRowList.length){this.scrollPos({x:this.currentScrollPos.x,y:this.maxScrollPos.y});var e=this;setTimeout(function(){if(e.visibleRange<=e.scrollRowList.length){var c=e.getLastScrollIndex();
0<=c&&(c=e.scrollRowList[c])&&c.cells&&0<=a.colIndex&&a.colIndex<c.cells.length&&(d=c.cells[a.colIndex],e.updateFocusCell(d),e.processRowSelection(b,c.data))}},1)}return d};c.prototype.processHomeKey=function(a,b){var d=null;if(0<this.scrollRowList.length){this.scrollPos({x:this.currentScrollPos.x,y:0});var e=this;setTimeout(function(){var c=e.scrollRowList[0];c&&c&&c.cells&&0<=a.colIndex&&a.colIndex<c.cells.length&&(d=c.cells[a.colIndex],e.updateFocusCell(d),e.processRowSelection(b,c.data))},1)}return d};
c.prototype.processLeftArrowKey=function(a){if((a=this.getPrevCell(this.isKeyPressed?this.currentFocusCell:a))&&!a.isEmpty){this.updateFocusCell(a);this.isFirstCell(a)&&this.scrollPos({x:this.currentScrollPos.x-2*a.width,y:this.currentScrollPos.y});var b=this;setTimeout(function(){b.refresh()},1)}return a&&!a.isEmpty?a:null};c.prototype.processPageDownKey=function(a,b){var d=null,e=this;0<this.scrollRowList.length&&(e.scrollPos({x:e.currentScrollPos.x,y:e.currentScrollPos.y+e.avgRowHeight*(e.visibleRange-
1)}),setTimeout(function(){var c=0<=a.rowIndex&&a.rowIndex<e.visibleRange?a.rowIndex:e.visibleRange-1;e.currentScrollPos.y==e.maxScrollPos.y&&(c=e.getLastScrollIndex());0<=c&&(c=e.scrollRowList[c])&&c.cells&&0<=a.colIndex&&a.colIndex<c.cells.length&&(d=c.cells[a.colIndex],e.updateFocusCell(d),e.processRowSelection(b,c.data))},1));return d};c.prototype.processPageUpKey=function(a,b){var d=null,e=this;0<e.scrollRowList.length&&(e.scrollPos({x:e.currentScrollPos.x,y:e.currentScrollPos.y-e.avgRowHeight*
(e.visibleRange-1)}),setTimeout(function(){var c=0<=a.rowIndex&&a.rowIndex<e.visibleRange?a.rowIndex:0;0==e.currentScrollPos.y&&(c=0);(c=e.scrollRowList[c])&&c.cells&&0<=a.colIndex&&a.colIndex<c.cells.length&&(d=c.cells[a.colIndex],e.updateFocusCell(d),e.processRowSelection(b,c.data))},1));return d};c.prototype.processRightArrowKey=function(a){if((a=this.getNextCell(this.isKeyPressed?this.currentFocusCell:a))&&!a.isEmpty){this.updateFocusCell(a);this.isLastCell(a)?this.scrollPos({x:this.currentScrollPos.x+
2*a.width,y:this.currentScrollPos.y}):a.colIndex>=this.flatCurrentColumnList.length-2&&this.scrollPos({x:this.maxScrollPos.x,y:this.currentScrollPos.y});var b=this;setTimeout(function(){b.refresh()},1)}return a&&!a.isEmpty?a:null};c.prototype.processUpArrowKey=function(a,b){var d=this.getUpCell(a);if(d&&!d.isEmpty){this.updateFocusCell(d);var e=this.getRowFromCell(d);e&&(this.processRowSelection(b,e.data),this.isFirstRow(d)&&(this.scrollPos({x:this.currentScrollPos.x,y:this.currentScrollPos.y-this.avgRowHeight}),
this.currentFocusCell.rowIndex++))}return d&&!d.isEmpty?d:null};c.prototype.getDownCell=function(a){if(a&&0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length){var b=a.rowIndex<this.scrollRowList.length-1?a.rowIndex+1:-1;return(b=0<=b?this.scrollRowList[b]:null)&&0<=a.colIndex&&a.colIndex<b.cells.length?b.cells[a.colIndex]:null}return null};c.prototype.getNextCell=function(a){if(a&&0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length){var b=this.scrollRowList[a.rowIndex];a=a.colIndex;a=0<=a&&a<this.viewIndexRange.middle&&
a<b.cells.length-1?a+1:this.viewIndexRange.middle-this.viewIndexRange.left;return 0<=a?b.cells[a]:null}return null};c.prototype.getLastScrollIndex=function(){for(var a=0,b=0;b<this.scrollRowList.length;b++)if(this.scrollRowList[b].isEmpty){a=b-1;break}return a};c.prototype.getPrevCell=function(a){if(a&&0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length){var b=this.scrollRowList[a.rowIndex];a=a.colIndex;a=0<a&&a<b.cells.length?a-1:0;return 0<=a?b.cells[a]:null}return null};c.prototype.getUpCell=function(a){if(a&&
0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length){var b=0<a.rowIndex?a.rowIndex-1:-1;return(b=0<=b?this.scrollRowList[b]:null)&&0<=a.colIndex&&a.colIndex<b.cells.length?b.cells[a.colIndex]:null}return null};c.prototype.isFirstCell=function(a){return 0==a.colIndex?!0:!1};c.prototype.isFirstRow=function(a){return 0==a.rowIndex?!0:!1};c.prototype.isLastCell=function(a){return a.colIndex==this.viewIndexRange.middle-this.viewIndexRange.left?!0:!1};c.prototype.isLastRow=function(a){return a.rowIndex==
this.visibleRange-2?!0:!1};c.prototype.getRowFromCell=function(a){return 0<=a.rowIndex&&a.rowIndex<this.scrollRowList.length?this.scrollRowList[a.rowIndex]:null};c.prototype.moveFocusFromCell=function(a,b){if(!this.options.allowFocus)return null;var d=null,e=this.getObjFromCell(a);if(e)switch(b){case "down":d=this.processDownArrowKey(e);break;case "end":d=this.processEndKey(e);break;case "home":d=this.processHomeKey(e);break;case "left":d=this.processLeftArrowKey(e);break;case "pagedown":d=this.processPageDownKey(e);
break;case "pageup":d=this.processPageUpKey(e);break;case "right":d=this.processRightArrowKey(e);break;case "up":d=this.processUpArrowKey(e)}return d?d.data:null};c.prototype.getObjFromCell=function(a){for(var b=null,d=0;d<this.scrollRowList.length;d++)for(var e=this.scrollRowList[d],c=0;c<e.cells.length;c++){var g=e.cells[c];if(g.data==a){b=g;break}}return b};c.prototype.updateFocusCell=function(a){a?(this.currentFocusCell={},this.currentFocusCell.isEmpty=!1,this.currentFocusCell.data=a.data,this.currentFocusCell.colIndex=
a.colIndex,this.currentFocusCell.rowIndex=a.rowIndex):this.currentFocusCell=null};c.prototype.onWindowKeyDown=function(a){this.isEnabled&&this.isKeyboardActive&&a.preventDefault();this.isDragActive&&27==a.keyCode&&(this.dropMark(a),this.clearDragDropSettings(),this.dragMode==integralui_core_1.IntegralUIDragDropDisplayMode.Handle&&this.updateScrollRowList())};c.prototype.onWindowKeyUp=function(a){this.isKeyboardActive=!1};c.prototype.checkForSelectionChange=function(){var a=this;if(0<this.currentSelectedRows.length){var b=
this.getFullList(),d=[];this.currentSelectedRows.map(function(e){0==b.filter(function(b){return a.commonService.isEqual(b[a.options.rowFields.id],e[a.options.rowFields.id])}).length&&d.push(e)});if(0<d.length){var e=[];d.map(function(b){b[a.options.rowFields.selected]=!1;e.push(a.currentSelectedRows.indexOf(b))});this.currentSelectedRow&&0<d.filter(function(b){return a.commonService.isEqual(a.currentSelectedRow[a.options.rowFields.id],b[a.options.rowFields.id])}).length&&(this.currentSelectedRow=
null);for(var c=e.length-1;0<=c;c--)this.currentSelectedRows.splice(e[c],1);this.selectionChanged.emit({row:this.currentSelectedRow})}}};c.prototype.getContentSize=function(){return{width:0,height:0}};c.prototype.refresh=function(a){this.clearComponentSelection();for(a=0;a<this.currentSelectedRows.length;a++){var b=this.getRowCurrentIndex(this.currentSelectedRows[a]);this.isComponentIndexInRange(b)&&(this.rowList[b].state|=integralui_core_1.IntegralUIObjectState.selected)}};c.prototype.suspendLayout=
function(){this.allowUpdate=!1};c.prototype.resumeLayout=function(){this.allowUpdate=!0;this.updateLayout()};c.prototype.updateCurrentLayout=function(){};c.prototype.updateLayout=function(){};c.prototype.isThereChildColumns=function(a,b){var d=this.options.columnFields.columns;return b?this.areChildColumnsFixed(a[d]):a[d]&&0<a[d].length?!0:!1};c.prototype.areChildColumnsFixed=function(a){if(a&&0<a.length){for(var b=0,d=0;d<a.length;d++)(1==a[d][this.options.columnFields.fixedWidth]||this.areChildColumnsFixed(a[d][this.options.columnFields.columns]))&&
b++;return b==a.length?!0:!1}return!1};c.prototype.updateColumnWidth=function(a){if(this.isAutoSizeColumnsActive){for(var b,d,e=a=0,c=[],g,f=0;f<this.currentColumnList.length;f++)b=(g=this.isThereChildColumns(this.currentColumnList[f].data))?this.calcColumnWidthFromChildren(this.currentColumnList[f].data):this.getColumnWidth(this.currentColumnList[f].data),d=this.getColumnWidth(this.currentColumnList[f].data,"min"),b>=d&&(a+=b+this.columnPadding.left+this.columnPadding.right+6,1!=this.isColumnWidthFixed(this.currentColumnList[f].data)?
(e++,c.push(this.currentColumnList[f])):g&&(this.setColumnWidth(this.currentColumnList[f].data,b,!0),this.updateCellWidth(this.currentColumnList[f].data)));0<e&&(f=this.isVerScrollVisible()?20:0,this.updateColumnWidthByFactor(c,(this.clientRect.width-f-a)/e))}else if(a)this.changeColumnWidth(a);else for(f=0;f<this.currentColumnList.length;f++)a=this.currentColumnList[f].data,this.changeColumnWidth(a)};c.prototype.changeColumnWidth=function(a){var b=this.getColumnWidth(a),d=this.isThereChildColumns(a)?
this.calcColumnWidthFromChildren(a):b;d!=b&&(this.setColumnWidth(a,d),this.updateCellWidth(a))};c.prototype.calcColumnWidthFromChildren=function(a){for(var b,d=0,e=a[this.options.columnFields.columns],c=0;c<e.length;c++)a=this.getColumnWidth(e[c]),b=this.isThereChildColumns(e[c])?this.calcColumnWidthFromChildren(e[c]):a,b!=a&&(this.setColumnWidth(e[c],b),this.updateCellWidth(e[c])),d+=b+10;return d-10};c.prototype.updateColumnWidthByFactor=function(a,b){var d=0;var e=0;for(var c=[],g=0;g<a.length;g++){var f=
this.isThereChildColumns(a[g].data)?this.calcColumnWidthFromChildren(a[g].data):this.getColumnWidth(a[g].data);var k=this.getColumnWidth(a[g].data,"min");1==this.isColumnWidthFixed(a[g].data)&&(k=f);f>=k&&(f+b<=k?(d+=f+b-k,this.setColumnWidth(a[g].data,k),this.updateCellWidth(a[g].data)):(c.push(a[g]),e++))}if(0<e)if(f=d/e,0!=f)this.updateColumnWidthByFactor(c,b+f);else for(g=0;g<c.length;g++)f=this.isThereChildColumns(c[g].data)?this.calcColumnWidthFromChildren(c[g].data):this.getColumnWidth(c[g].data),
f+=b,this.setColumnWidth(c[g].data,f),this.updateCellWidth(c[g].data),e=Math.max(this.getColumnWidth(c[g].data,"min"),this.getMinColumnWidthFromChildren(c[g].data)),f>e&&this.resizeChildColumns(c[g].data,b)};c.prototype.checkWidthChanges=function(){if(this.isAutoSizeColumnsActive){for(var a=0,b,d=0;d<this.currentColumnList.length;d++)b=this.getColumnWidth(this.currentColumnList[d].data),this.getColumnWidth(this.currentColumnList[d].data,"min"),a+=b+this.columnPadding.left+this.columnPadding.right+
6;d=this.isVerScrollVisible()?20:0;b=this.clientRect.width-d-a-2;if(0<b)for(d=this.currentColumnList.length-1;0<=d;d--)if(a=this.currentColumnList[d].data,!this.isColumnWidthFixed(a)){b=this.getColumnWidth(a)+b;this.setColumnWidth(a.data,b);this.updateCellWidth(a.data);break}}};c.prototype.updateCellWidth=function(a){if(a)for(var b=this.getRowList(a[this.options.columnFields.fixed]),d=0;d<b.length;d++){var c=b[d],h=this.isColumnFixed(a),g=this.getColumnCurrentIndex(a);g=h?g:g-this.viewIndexRange.left;
for(h=0;h<c.cells.length;h++)if(c.cells[h].colIndex==g){g=this.getCellWidth(c,a);if(this.getColumnIndex(a)==this.expandColIndex){var f=this.getColumnWidth(a);f=0<f?f:this.columnPadding.left;c.cells[h].indent=0==g?f:this.getRowIndent(c,a)}c.cells[h].width=g;break}}};c.prototype.updateChildColumnsWidth=function(a,b,d){var c=Math.max(this.getColumnWidth(a,"min"),this.getMinColumnWidthFromChildren(a));b>c&&(this.resizeChildColumns(a,d),this.resizeParentColumn(a,d))};c.prototype.resizeChildColumns=function(a,
b){var d=this,c=a[this.options.columnFields.columns];if(c&&0<c.length){var h=c.filter(function(a){var c=d.getColumnWidth(a);return d.isColumnWidthFixed(a)||0>b&&0==c?!0:!1}).length;b=c.length>h?b/(c.length-h):0;c.filter(function(a){return!d.isColumnWidthFixed(a)}).map(function(a){d.updateWidthByFactor(a,b);d.resizeChildColumns(a,b)})}};c.prototype.resizeParentColumn=function(a,b){var d=this;if(a[this.options.columnFields.pid]){var c=[];switch(a[this.options.columnFields.fixed]){case "left":c=this.flatCurrentLeftColumnList;
break;case "right":c=this.flatCurrentRightColumnList;break;default:c=this.flatCurrentColumnList}c=c.filter(function(b){return b[d.options.columnFields.id]==a[d.options.columnFields.pid]});if(c=0<c.length?c[0]:null)this.updateWidthByFactor(c,b),this.resizeParentColumn(c,b)}};c.prototype.updateWidthByFactor=function(a,b){var d=this.getColumnWidth(a);this.isColumnFixed(a,"right")?d-=b:d+=b;d=Math.max(0,d);this.setColumnWidth(a,d);this.updateCellWidth(a)};c.prototype.updateRange=function(){};c.prototype.getBlockBottomPos=
function(){var a=this.isHorScrollVisible()?16:0;this.isPaginationEnabled()&&(a+=this.paginatorHeight);return a};c.prototype.getBlockRightPos=function(){return this.isVerScrollVisible()?16:0};c.prototype.onCtrlMouseEnter=function(a){this.isEnabled&&1==a.buttons&&this.cloneElem&&(this.cloneElem.style.display="block");this.elemRenderer.setStyle(this.elemRef.nativeElement,"cursor","default")};c.prototype.onCtrlMouseLeave=function(a){this.isEnabled&&1==a.buttons&&this.cloneElem&&(this.cloneElem.style.display=
"none");this.stopScrollTimer()};c.prototype.currentPage=function(a){this.currentPageNumber!=a&&1<=a&&a<=this.pageList.length&&(this.currentPageNumber=a,this.updateCurrentLayout());return this.currentPageNumber};c.prototype.getMaxPages=function(){return this.pageList?this.pageList.length:0};c.prototype.firstPage=function(){1!=this.currentPageNumber&&(this.currentPageNumber=1,this.updateCurrentLayout())};c.prototype.lastPage=function(){this.currentPageNumber!=this.pageList.length&&(this.currentPageNumber=
this.pageList.length,this.updateCurrentLayout())};c.prototype.nextPage=function(){this.currentPageNumber<this.pageList.length&&(this.currentPageNumber++,this.updateCurrentLayout())};c.prototype.prevPage=function(){1<this.currentPageNumber&&(this.currentPageNumber--,this.updateCurrentLayout())};c.prototype.resetPageNumber=function(){this.currentPageNumber=1};c.prototype.updatePageNumber=function(){this.currentPageNumber>this.pageList.length&&(0==this.pageList.length?this.resetPageNumber():this.currentPageNumber=
this.pageList.length)};c.prototype.updatePaging=function(a){this.options.paging=a?{enabled:this.commonService.isFieldAvailable(a.enabled,!1),showControlPanel:this.commonService.isFieldAvailable(a.showControlPanel,!0),pageSize:this.commonService.isFieldAvailable(a.pageSize,100)}:{enabled:!1,showControlPanel:!0,pageSize:100}};c.prototype.paginatorPageChanged=function(a){this.currentPageNumber=a.value;this.updateCurrentLayout();this.pageChanged.emit({page:this.currentPageNumber,maxPages:this.getMaxPages(),
pageSize:this.options.paging.pageSize})};c.prototype.isPaginationEnabled=function(){return this.options.paging.enabled&&this.options.paging.showControlPanel};c.prototype.getColumnOpacity=function(a){return 1};c.prototype.updateOrignalScrollColumnList=function(){this.originalScrollColumnList.length=0;if(0<this.scrollColumnList.length)for(var a=0;a<this.scrollColumnList[0].columns.length;a++)this.originalScrollColumnList.push(this.scrollColumnList[0].columns[a])};c.prototype.updateReorderColumnPos=
function(){if(this.reorderColumn){for(var a=0,b,d=0;d<this.originalScrollColumnList.length&&this.originalScrollColumnList[d]!=this.reorderColumnObj;d++)b=this.getColumnWidth(this.originalScrollColumnList[d].data),a+=b+this.columnPadding.left+this.columnPadding.right+6;this.reorderColumnObjPos.left=a+this.reorderColumnCurrentPos.left-this.reorderColumnStartPos.left;var c=this.getHeaderRect();this.reorderNewColIndex=this.reorderColIndex=this.getColumnIndexFromScrollList(this.reorderColumn);for(d=a=
0;d<this.originalScrollColumnList.length;d++)if(b=this.getColumnWidth(this.originalScrollColumnList[d].data)+this.columnPadding.left+this.columnPadding.right+6,a+=b,0!=this.originalScrollColumnList[d].data[this.options.columnFields.allowDrop]&&this.reorderColumnCurrentPos.left-c.left<a){this.reorderNewColIndex=d;break}this.reorderColIndex!=this.reorderNewColIndex&&this.moveObject(this.reorderColIndex,this.reorderNewColIndex,this.scrollColumnList)}};c.prototype.getHeaderRect=function(){return{top:0,
right:0,bottom:0,left:0,height:0,width:0,x:0,y:0}};c.prototype.resetReorderColumnSettings=function(){this.reorderColumn=this.reorderColumnObj=null;this.startColumnReorder=this.columnReorderActive=!1};c.prototype.restoreColumnOrder=function(){if(0<this.originalScrollColumnList.length)for(var a=this.scrollColumnList.length=0;a<this.originalScrollColumnList.length;a++)this.scrollColumnList.push(this.originalScrollColumnList[a])};c.prototype.getColumnIndexFromScrollList=function(a){for(var b=-1,d=0;d<
this.scrollColumnList.length;d++)if(this.scrollColumnList[d].data==a){b=d;break}return b};c.prototype.moveObject=function(a,b,d){this.isIndexInRange(a,d)&&this.isIndexInRange(b,d)&&d.splice(b,0,d.splice(a,1)[0])};c.prototype.scrollPos=function(a){a&&(this.currentScrollPos={x:Math.max(0,Math.min(a.x,this.maxScrollPos.x)),y:Math.max(0,Math.min(a.y,this.maxScrollPos.y))},this.currentIndex=0<this.avgRowHeight?Math.floor(this.currentScrollPos.y/this.avgRowHeight):0);return{x:Math.floor(this.currentScrollPos.x),
y:Math.floor(this.currentScrollPos.y)}};c.prototype.changeHorizontalScrollPos=function(a){this.blockHoverRect.top=-9999999;this.currentScrollPos.x=Math.max(0,Math.min(a,this.maxScrollPos.x));this.currentScrollPos.x!=this.prevScrollPos.x&&(this.updateRange(),this.scrollPosChanged.emit({value:this.scrollPos()}),this.prevScrollPos.x=this.currentScrollPos.x)};c.prototype.changeVerticalScrollPos=function(a){this.blockHoverRect.top=-9999999;this.currentScrollPos.y=Math.max(0,Math.min(a,this.maxScrollPos.y));
this.currentScrollPos.y!=this.prevScrollPos.y&&(this.updateView(),this.scrollPosChanged.emit({value:this.scrollPos()}),this.prevScrollPos.y=this.currentScrollPos.y)};c.prototype.gridMouseWheel=function(a){a.preventDefault();this.hideCalendar();this.hideColorPopup();this.hideDropList();if(this.isEnabled){this.hoverRow=null;var b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)),d=5;switch(this.mouseWheelSpeed){case integralui_core_1.IntegralUISpeedMode.VerySlow:d=15;break;case integralui_core_1.IntegralUISpeedMode.Slow:d=
9;break;case integralui_core_1.IntegralUISpeedMode.Fast:d=3;break;case integralui_core_1.IntegralUISpeedMode.VeryFast:d=1}this.isVerScrollVisible()&&(d=Math.floor(this.clientRect.height/d),this.mouseWheelSpeed==integralui_core_1.IntegralUISpeedMode.VerySlow&&0<this.avgRowHeight&&(d=this.avgRowHeight),this.changeVerticalScrollPos(this.currentScrollPos.y+d*b*-1))}a.stopPropagation()};c.prototype.isVerScrollVisible=function(){return this.isEnabled&&this.options.showScroll.vertical&&0<this.scrollSize.height?
!0:!1};c.prototype.isHorScrollVisible=function(){return this.isEnabled&&this.options.showScroll.horizontal&&0<this.scrollSize.width?!0:!1};c.prototype.onVerticalScrollStart=function(a){this.hoverRow=null;this.isScrollActive=!0};c.prototype.onVerticalScrollEnd=function(a){this.isScrollActive=!1};c.prototype.onVerticalScrollChanged=function(a){this.currentScrollPos.y!=a.value&&this.changeVerticalScrollPos(a.value)};c.prototype.onHorizontalScrollStart=function(a){this.hoverRow=null;this.isScrollActive=
!0};c.prototype.onHorizontalScrollEnd=function(a){this.isScrollActive=!1;this.refresh()};c.prototype.onHorizontalScrollChanged=function(a){this.currentScrollPos.x!=a.value&&(this.currentScrollPos.x=a.value,this.scrollPosChanged.emit({value:this.scrollPos()}),this.updateRange())};c.prototype.scrollMouseDown=function(a){this.hideColorPopup()};c.prototype.updateSelectContentPos=function(){};c.prototype.updateView=function(a){this.currentIndex=0<this.avgRowHeight?Math.floor(this.currentScrollPos.y/this.avgRowHeight):
0;this.currentIndex!=this.prevIndex&&(this.updateScrollRowList(a),this.updateSelectContentPos(),this.prevIndex=this.currentIndex)};c.prototype.processScroll=function(a,b,d){if(this.isEnabled)if(this.isVerScrollVisible()){var c=this.commonService.getShiftPos();a=this.commonService.getMousePos(a);a.x-=c.x;a.y-=c.y;c=this.commonService.getPageRect(this.elemRef.nativeElement.firstElementChild);b=c.top+this.currentHeaderHeight+(b?b:0)+25;d=c.bottom-this.currentFooterHeight-(d?d:0)-25;this.isHorScrollVisible()&&
(d-=16);a.y<b&&0<this.currentScrollPos.y?this.startScrollTimer(!1):a.y>d&&this.currentScrollPos.y<this.maxScrollPos.y?this.startScrollTimer(!0):this.stopScrollTimer()}else this.stopScrollTimer()};c.prototype.startScrollTimer=function(a,b){var c=this;c.removeDropMark();c.isScrollTimerActive||(c.accelerator=.5,c.scrollCount=0,c.isScrollTimerActive=!0,c.scrollTimerID=setInterval(function(){c.scrollTimerElapsed(a)},b?b:100))};c.prototype.stopScrollTimer=function(){this.scrollTimerID&&(clearInterval(this.scrollTimerID),
this.scrollTimerID=null);this.accelerator=.5;this.scrollCount=0;this.isScrollTimerActive=!1};c.prototype.scrollTimerElapsed=function(a){var b=this.currentScrollPos;0===this.scrollCount&&(this.scrollCount=5);this.scrollCount+=5;this.accelerator+=.5;var c=this.scrollCount+=Math.floor(this.accelerator);this.currentScrollPos.y=a?this.currentScrollPos.y+c>this.maxScrollPos.y?this.maxScrollPos.y:this.currentScrollPos.y+c:0>this.currentScrollPos.y-c?0:this.currentScrollPos.y-c;(0>=b.y||this.currentScrollPos.y<
b.y)&&this.stopScrollTimer()};c.prototype.scrollTo=function(a){a&&(a=this.getRowCurrentIndex(a),0<=a&&this.scrollPos({x:this.currentScrollPos.x,y:this.avgRowHeight*(a+1-this.visibleRange/2)}),this.updateLayout())};c.prototype.findRowById=function(a){return this.dataService.findObjectById(a,this.rowDataKey)};c.prototype.findRowByText=function(a){return this.dataService.findObjectByText(a,this.rowDataKey)};c.prototype.clearSelection=function(){this.clearPrevSelection();this.currentSelectedRow=null;
this.updateSelectContentPos();this.refresh()};c.prototype.processColumnSelection=function(a,b,c){if(b)0!=b[this.options.columnFields.canSelect]&&(a=!0,this.currentSelectedColumn&&(a=!this.commonService.isEqual(this.currentSelectedColumn[this.options.columnFields.id],b[this.options.columnFields.id])),c={cancel:!1,obj:b},this.beforeSelect.emit(c),a&&1!=c.cancel&&(this.currentSelectedColumn&&(this.currentSelectedColumn[this.options.columnFields.selected]=!1,this.refresh(this.currentSelectedColumn)),
this.currentSelectedColumn=b,b[this.options.columnFields.selected]=!0,this.refresh(b),this.callAfterSelectEvent(b)));else return this.currentSelectedColumn};c.prototype.clearComponentSelection=function(){this.rowList.forEach(function(a){return a.state&=~integralui_core_1.IntegralUIObjectState.selected})};c.prototype.clearPrevSelection=function(a){for(var b=0;b<this.currentSelectedRows.length;b++)a&&!this.commonService.isEqual(this.currentSelectedRows[b][this.options.rowFields.id],a[this.options.rowFields.id])?
this.currentSelectedRows[b][this.options.rowFields.selected]=!1:a||(this.currentSelectedRows[b][this.options.rowFields.selected]=!1);this.currentSelectedRows.length=0;a&&this.isRowEnabled(a)&&this.currentSelectedRows.push(a)};c.prototype.isRowInSelectionList=function(a){var b=!1,c=this.currentSelectedRows;if(a&&c)for(var e=0;e<c.length;e++)if(this.commonService.isEqual(c[e][this.options.rowFields.id],a[this.options.rowFields.id])){b=!0;break}return b};c.prototype.processRowSelection=function(a,b,
c){if(b&&this.selectionMode!=integralui_core_1.IntegralUISelectionMode.None&&0!=b[this.options.rowFields.canSelect]){var d=0<this.currentSelectedRows.length;if(this.isRowEnabled(b)){var h=this.currentSelectedRow,g=!0;h&&(g=a&&(a.ctrlKey||a.metaKey)||!this.commonService.isEqual(h[this.options.rowFields.id],b[this.options.rowFields.id])||0==h[this.options.rowFields.selected]);var f={cancel:!1,obj:b};this.beforeSelect.emit(f);if(1!=f.cancel)if(f=a&&(a.shiftKey||a.ctrlKey||a.metaKey)?!0:!1,g){this.selectionMode==
integralui_core_1.IntegralUISelectionMode.MultiExtended&&(g=!this.isRowInSelectionList(b)||!f||a&&a.shiftKey);g&&(this.selectionMode==integralui_core_1.IntegralUISelectionMode.One?this.clearPrevSelection():a&&a.shiftKey?this.clearPrevSelection():f||this.selectionMode==integralui_core_1.IntegralUISelectionMode.MultiSimple||1!=this.currentSelectedRows.length&&this.isRowInSelectionList(b)||this.clearPrevSelection());this.currentSelectedRow=b;if(a&&a.shiftKey&&this.selectionMode!=integralui_core_1.IntegralUISelectionMode.One){if(this.shiftFirstSelectedRow||
(this.shiftFirstSelectedRow=h),a=this.getRowCurrentIndex(this.shiftFirstSelectedRow),c=this.getRowCurrentIndex(b),a>c&&(d=a,a=c,c=d),this.isIndexInRange(a,this.currentRowList)&&this.isIndexInRange(c,this.currentRowList))for(;a<=c;a++)0!=this.currentRowList[a].data[this.options.rowFields.canSelect]&&(this.currentRowList[a].data[this.options.rowFields.selected]=!0,this.currentSelectedRows.push(this.currentRowList[a].data))}else f||this.selectionMode==integralui_core_1.IntegralUISelectionMode.MultiSimple?
(a=null==b[this.options.rowFields.selected]||"undefined"==b[this.options.rowFields.selected]?!1:b[this.options.rowFields.selected],b[this.options.rowFields.selected]=!a,b[this.options.rowFields.selected]?this.isRowInSelectionList(b)||this.currentSelectedRows.push(b):this.currentSelectedRows=this.currentSelectedRows.filter(function(a){return a!=b})):(b[this.options.rowFields.selected]=!0,this.isRowInSelectionList(b)||this.currentSelectedRows.push(b)),this.shiftFirstSelectedRow=null;this.callAfterSelectEvent(b);
this.refresh()}else f||this.selectionMode==integralui_core_1.IntegralUISelectionMode.MultiSimple?(a=null===b[this.options.rowFields.selected]||"undefined"==b[this.options.rowFields.selected]?!1:b[this.options.rowFields.selected],c&&"undefined"!=c&&(a=c),b[this.options.rowFields.selected]=!a,b[this.options.rowFields.selected]?this.isRowInSelectionList(b)||this.currentSelectedRows.push(b):this.currentSelectedRows=this.currentSelectedRows.filter(function(a){return a!=b}),this.shiftFirstSelectedRow=null,
this.callAfterSelectEvent(b),this.refresh()):f||this.selectionMode&integralui_core_1.IntegralUISelectionMode.MultiSimple||1!=this.currentSelectedRows.length&&this.isRowInSelectionList(b)||(this.shiftFirstSelectedRow=null,this.clearPrevSelection(b),this.refresh(),d&&this.selectionChanged.emit(null))}else this.clearPrevSelection(),this.currentSelectedRow=null,this.refresh(),d&&this.selectionChanged.emit(null)}};c.prototype.selectRows=function(a){var b=this;if(a&&Array.isArray(a)){this.currentSelectedRows.map(function(a){return a[b.options.rowFields.selected]=
!1});for(var c=this.currentSelectedRows.length=0;c<a.length;c++)a[c][this.options.rowFields.selected]=!0,this.currentSelectedRows.push(a[c]);0<a.length?(this.currentSelectedRow=a[a.length-1],this.callAfterSelectEvent(this.currentSelectedRow)):this.currentSelectedRow=null;this.refresh()}};c.prototype.updateRowSelection=function(a,b){var c=a&&(a.shiftKey||a.ctrlKey||a.metaKey)?!0:!1;this.selectionMode==integralui_core_1.IntegralUISelectionMode.MultiExtended&&0!=b[this.options.rowFields.canSelect]&&
0<this.currentSelectedRows.length&&!a.shiftKey&&!c&&1==a.which&&(c=this.currentSelectedRows.length,this.clearPrevSelection(),this.currentSelectedRow=b,b[this.options.rowFields.selected]=!0,this.currentSelectedRows.push(b),1<c&&this.callAfterSelectEvent(b),this.refresh())};c.prototype.sort=function(a,b,c){this.sortColumn=a;this.sortComparer=c;this.options.sorting=b;this.updateLayout();this.change.emit({type:"sorting"})};c.prototype.getCellIndexInCollection=function(a,b,c){var d=-1;if(a)for(var h=0;h<
a.length;h++)if(void 0==a[h][this.options.cellFields.cid]){d=b;break}else if(a[h][this.options.cellFields.cid]==c){d=h;break}return d};c.prototype.isSortingAllowed=function(){return this.options.sorting==integralui_core_1.IntegralUISortOrder.Ascending||this.options.sorting==integralui_core_1.IntegralUISortOrder.Descending};c.prototype.isSortingColumn=function(a){return a&&a==this.sortColumn?!0:!1};c.prototype.applySorting=function(a){var b=this;if(a&&(!b.sortColumn||0!=b.sortColumn[b.options.columnFields.visible])){var c=
b.getColumnCurrentIndex(b.sortColumn),e=0<=c?c:b.options.expandColIndex;c=b.getCurrentColumnList(b.sortColumn?b.sortColumn[b.options.columnFields.fixed]:void 0);if(e<c.length){var h=c[e][b.options.columnFields.id];b.sortColumn&&b.sortColumn[b.options.columnFields.comparer]?a.sort(b.sortColumn[b.options.columnFields.comparer]):b.sortComparer?a.sort(b.sortComparer):b.isSortingAllowed()&&a.sort(function(a,c){var d=null,f=null;if(a[b.options.rowFields.cells]){var g=b.getCellIndexInCollection(a[b.options.rowFields.cells],
e,h);0<=g&&((d=a[b.options.rowFields.cells][g][b.options.cellFields.value])||(d=a[b.options.rowFields.cells][g][b.options.cellFields.text]),b.commonService.isObject(d)&&(d=d.value?d.value:d.text))}c[b.options.rowFields.cells]&&(g=b.getCellIndexInCollection(c[b.options.rowFields.cells],e,h),0<=g&&((f=c[b.options.rowFields.cells][g][b.options.cellFields.value])||(f=c[b.options.rowFields.cells][g][b.options.cellFields.text]),b.commonService.isObject(f)&&(f=f.value?f.value:f.text)));d=void 0!=d?d:null;
f=void 0!=f?f:null;switch(b.options.sorting){case integralui_core_1.IntegralUISortOrder.Ascending:if(d<f)return-1;if(d>f)return 1;break;case integralui_core_1.IntegralUISortOrder.Descending:if(d>f)return-1;if(d<f)return 1;break;default:return 0}})}}};c.prototype.getColumnInlineStyle=function(a){var b={header:"",footer:""};a&&(b={header:this.commonService.isFieldAvailable(a.header,""),footer:this.commonService.isFieldAvailable(a.footer,"")});return b};c.prototype.getRowInlineStyle=function(a,b){var c=
a||{};b&&(c.display="none");return c};c.prototype.columnTouchStart=function(a,b){this.isEnabled&&this.processColumnSelection(a,b.data);a.stopPropagation()};c.prototype.rowTouchStart=function(a,b){this.isEnabled&&this.processRowSelection(a,b.data)};c.prototype.ctrlTouchStart=function(a){a.preventDefault();this.isEnabled&&(a=this.commonService.getTouchData(a))&&0<a.length&&(this.touchStartPos={x:a[0].pageX,y:a[0].pageY})};c.prototype.ctrlTouchEnd=function(a){var b=this;if(b.isEnabled){(a=b.commonService.getTouchData(a))&&
0<a.length&&(b.touchEndPos={x:a[0].pageX,y:a[0].pageY});var c=b.touchEndPos.x-b.touchStartPos.x,e=b.touchEndPos.y-b.touchStartPos.y,h=!1,g=!1,f=b.touchStartPos,k=b.currentScrollPos.x,l=b.currentScrollPos.y,m=setInterval(function(){var a=b.currentScrollPos;-20>c?(f.x-=30,f.x>b.touchEndPos.x?a.x+=30:(a.x=k-c,h=!0)):20<c?(f.x+=30,f.x<b.touchEndPos.x?a.x-=30:(a.x=k-c,h=!0)):h=!0;-20>e?(f.y-=25,f.y>b.touchEndPos.y?a.y+=25:(a.y=l-e,g=!0)):20<e?(f.y+=25,f.y<b.touchEndPos.y?a.y-=25:(a.y=l-e,g=!0)):g=!0;b.scrollPos(a);
k!=a.x&&b.updateRange();l!=a.y&&b.updateView();h&&g&&(k==b.currentScrollPos.x&&l==b.currentScrollPos.y||b.scrollPosChanged.emit({value:b.currentScrollPos}),clearInterval(m))},5);b.touchStartPos=b.touchEndPos}};c.\u0275fac=function(a){return new (a||c)(i0.\u0275\u0275directiveInject(i1.IntegralUIDataService),i0.\u0275\u0275directiveInject(i2.IntegralUIDragDropService),i0.\u0275\u0275directiveInject(i0.ElementRef),i0.\u0275\u0275directiveInject(i0.Renderer2),i0.\u0275\u0275directiveInject(i3.IntegralUICommonService),
i0.\u0275\u0275directiveInject(i4.IntegralUIFilterService),i0.\u0275\u0275directiveInject(i0.ChangeDetectorRef),i0.\u0275\u0275directiveInject(i0.ComponentFactoryResolver))};c.\u0275cmp=i0.\u0275\u0275defineComponent({type:c,selectors:[["iui-basegrid"]],hostBindings:function(a,b){a&1&&i0.\u0275\u0275listener("keydown",function(a){return b.onWindowKeyDown(a)},!1,i0.\u0275\u0275resolveDocument)("keyup",function(a){return b.onWindowKeyUp(a)},!1,i0.\u0275\u0275resolveDocument)},inputs:{appRef:"appRef",
autoUpdate:"autoUpdate",allowColumnReorder:"allowColumnReorder",allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",allowFocus:"allowFocus",autoSizeColumns:"autoSizeColumns",columns:"columns",dataFields:"dataFields",focusedCell:"focusedCell",footerHeight:"footerHeight",gridLines:"gridLines",headerHeight:"headerHeight",mouseWheelSpeed:"mouseWheelSpeed",paging:"paging",rowContentVisibility:"rowContentVisibility",rowHeight:"rowHeight",rows:"rows",selectedColumn:"selectedColumn",selectedRow:"selectedRow",
selectionMode:"selectionMode",showExpandBox:"showExpandBox",showHoverRow:"showHoverRow",showScroll:"showScroll",sorting:"sorting",dragMode:"dragMode"},outputs:{afterSelect:"afterSelect",beforeEdit:"beforeEdit",beforeSelect:"beforeSelect",beforeUpdate:"beforeUpdate",cellClick:"cellClick",cellDblClick:"cellDblClick",cellHover:"cellHover",cellRightClick:"cellRightClick",cellValueChanging:"cellValueChanging",cellValueChanged:"cellValueChanged",change:"change",columnAdding:"columnAdding",columnAdded:"columnAdded",
columnClick:"columnClick",columnDblClick:"columnDblClick",columnHover:"columnHover",columnRightClick:"columnRightClick",columnOrderChanged:"columnOrderChanged",columnRemoving:"columnRemoving",columnRemoved:"columnRemoved",columnsCleared:"columnsCleared",columnSizeChanged:"columnSizeChanged",dragEnd:"dragEnd",dragEnter:"dragEnter",dragDrop:"dragDrop",dragDropComplete:"dragDropComplete",dragLeave:"dragLeave",dragOver:"dragOver",dragStart:"dragStart",keyDown:"keyDown",keyPress:"keyPress",keyUp:"keyUp",
pageChanged:"pageChanged",rowAdding:"rowAdding",rowAdded:"rowAdded",rowClick:"rowClick",rowDblClick:"rowDblClick",rowHover:"rowHover",rowRemoving:"rowRemoving",rowRemoved:"rowRemoved",rowRightClick:"rowRightClick",rowsCleared:"rowsCleared",loadComplete:"loadComplete",scrollPosChanged:"scrollPosChanged",selectionChanged:"selectionChanged",updateComplete:"updateComplete"},features:[i0.\u0275\u0275ProvidersFeature([integralui_data_service_1.IntegralUIDataService]),i0.\u0275\u0275InheritDefinitionFeature],
decls:0,vars:0,template:function(a,b){},encapsulation:2});return c}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUIBaseGrid=IntegralUIBaseGrid;
(function(){i0.\u0275setClassMetadata(IntegralUIBaseGrid,[{type:core_1.Component,args:[{selector:"iui-basegrid",template:"",providers:[integralui_data_service_1.IntegralUIDataService]}]}],function(){return[{type:i1.IntegralUIDataService},{type:i2.IntegralUIDragDropService},{type:i0.ElementRef},{type:i0.Renderer2},{type:i3.IntegralUICommonService},{type:i4.IntegralUIFilterService},{type:i0.ChangeDetectorRef},{type:i0.ComponentFactoryResolver}]},{appRef:[{type:core_1.Input}],autoUpdate:[{type:core_1.Input}],
allowColumnReorder:[{type:core_1.Input}],allowDrag:[{type:core_1.Input}],allowDrop:[{type:core_1.Input}],allowFilter:[{type:core_1.Input}],allowFocus:[{type:core_1.Input}],autoSizeColumns:[{type:core_1.Input}],columns:[{type:core_1.Input}],dataFields:[{type:core_1.Input}],focusedCell:[{type:core_1.Input}],footerHeight:[{type:core_1.Input}],gridLines:[{type:core_1.Input}],headerHeight:[{type:core_1.Input}],mouseWheelSpeed:[{type:core_1.Input}],paging:[{type:core_1.Input}],rowContentVisibility:[{type:core_1.Input}],
rowHeight:[{type:core_1.Input}],rows:[{type:core_1.Input}],selectedColumn:[{type:core_1.Input}],selectedRow:[{type:core_1.Input}],selectionMode:[{type:core_1.Input}],showExpandBox:[{type:core_1.Input}],showHoverRow:[{type:core_1.Input}],showScroll:[{type:core_1.Input}],sorting:[{type:core_1.Input}],afterSelect:[{type:core_1.Output}],beforeEdit:[{type:core_1.Output}],beforeSelect:[{type:core_1.Output}],beforeUpdate:[{type:core_1.Output}],cellClick:[{type:core_1.Output}],cellDblClick:[{type:core_1.Output}],
cellHover:[{type:core_1.Output}],cellRightClick:[{type:core_1.Output}],cellValueChanging:[{type:core_1.Output}],cellValueChanged:[{type:core_1.Output}],change:[{type:core_1.Output}],columnAdding:[{type:core_1.Output}],columnAdded:[{type:core_1.Output}],columnClick:[{type:core_1.Output}],columnDblClick:[{type:core_1.Output}],columnHover:[{type:core_1.Output}],columnRightClick:[{type:core_1.Output}],columnOrderChanged:[{type:core_1.Output}],columnRemoving:[{type:core_1.Output}],columnRemoved:[{type:core_1.Output}],
columnsCleared:[{type:core_1.Output}],columnSizeChanged:[{type:core_1.Output}],dragEnd:[{type:core_1.Output}],dragEnter:[{type:core_1.Output}],dragDrop:[{type:core_1.Output}],dragDropComplete:[{type:core_1.Output}],dragLeave:[{type:core_1.Output}],dragOver:[{type:core_1.Output}],dragStart:[{type:core_1.Output}],keyDown:[{type:core_1.Output}],keyPress:[{type:core_1.Output}],keyUp:[{type:core_1.Output}],pageChanged:[{type:core_1.Output}],rowAdding:[{type:core_1.Output}],rowAdded:[{type:core_1.Output}],
rowClick:[{type:core_1.Output}],rowDblClick:[{type:core_1.Output}],rowHover:[{type:core_1.Output}],rowRemoving:[{type:core_1.Output}],rowRemoved:[{type:core_1.Output}],rowRightClick:[{type:core_1.Output}],rowsCleared:[{type:core_1.Output}],loadComplete:[{type:core_1.Output}],scrollPosChanged:[{type:core_1.Output}],selectionChanged:[{type:core_1.Output}],updateComplete:[{type:core_1.Output}],dragMode:[{type:core_1.Input}],onWindowKeyDown:[{type:core_1.HostListener,args:["document:keydown",["$event"]]}],
onWindowKeyUp:[{type:core_1.HostListener,args:["document:keyup",["$event"]]}]})})();