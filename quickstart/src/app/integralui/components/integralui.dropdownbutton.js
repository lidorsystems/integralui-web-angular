/*
  filename: integralui.dropdownbutton.js
  version : 1.2.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return function(b,a){function c(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}}();Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_button_1=require("./integralui.button"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUIDropDownButton=function(e){function b(a,c){var b=e.call(this,a,c)||this;b.elemRef=a;b.commonService=c;b.originalDropDownSettings={};b.dropDownSettings={};b.placementValue=integralui_core_1.IntegralUIPlacement.Right;b.openDirection=integralui_core_1.IntegralUIDirection.Below;b.buttonClass=
[];b.itemClick=new core_1.EventEmitter;b.dropDownOpening=new core_1.EventEmitter;b.dropDownOpened=new core_1.EventEmitter;b.dropDownClosed=new core_1.EventEmitter;b.updateDropDownSettings();return b}__extends(b,e);b.prototype.ngOnInit=function(){this.generalClassName="iui-dropdown-button";this.buttonClassName=this.generalClassName+"-btn";this.initStyle()};b.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",
normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},button:{disabled:this.buttonClassName+"-disabled",focused:this.buttonClassName+"-focused",normal:this.buttonClassName,hovered:this.buttonClassName+"-hovered",selected:this.buttonClassName+"-selected"}};this.updateStyle(this.controlStyle);this.updateControlClass();this.updateButtonClass()};b.prototype.ngAfterViewInit=function(){};Object.defineProperty(b.prototype,"placement",{get:function(){return this.placementValue},
set:function(a){this.placementValue=a;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"direction",{get:function(){return this.openDirection},set:function(a){this.openDirection=a;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"settings",{get:function(){return this.dropDownSettings},set:function(a){this.updateDropDownSettings(a)},enumerable:!0,configurable:!0});b.prototype.getAdjustmentValue=
function(a){var c={top:0,right:0,bottom:0,left:0};a&&(c={top:this.commonService.isFieldAvailable(a.top,0),bottom:this.commonService.isFieldAvailable(a.bottom,0),right:this.commonService.isFieldAvailable(a.right,0),left:this.commonService.isFieldAvailable(a.left,0)});return c};b.prototype.updateDropDownSettings=function(a){var c=this,b=setTimeout(function(){c.originalDropDownSettings=a?{adjustment:c.getAdjustmentValue(a.adjustment),appRef:c.commonService.isFieldAvailable(a.appRef,null),autoClose:c.commonService.isFieldAvailable(a.autoClose,
!0),buttonType:1,direction:c.openDirection,enabled:c.commonService.isFieldAvailable(a.enabled,!0),inverse:!1,items:c.commonService.isFieldAvailable(a.items,[]),position:"manual",style:c.commonService.isFieldAvailable(a.style,c.getDefaultDropDownStyle())}:{adjustment:c.getAdjustmentValue(),appRef:null,autoClose:!0,buttonType:1,direction:c.openDirection,enabled:!0,inverse:!1,items:[],position:"manual",style:c.getDefaultDropDownStyle()};c.dropDownSettings={adjustment:c.originalDropDownSettings.adjustment,
appRef:c.originalDropDownSettings.appRef,autoClose:c.originalDropDownSettings.autoClose,buttonType:1,direction:c.originalDropDownSettings.direction,enabled:c.originalDropDownSettings.enabled,inverse:c.originalDropDownSettings.inverse,items:c.originalDropDownSettings.items,position:c.originalDropDownSettings.position,style:c.originalDropDownSettings.style};c.updateAdjustment();clearTimeout(b)},1)};b.prototype.updateAdjustment=function(){var a={top:0,right:0,bottom:0,left:0};this.originalDropDownSettings&&
this.originalDropDownSettings.adjustment&&(a={top:this.originalDropDownSettings.adjustment.top,right:this.originalDropDownSettings.adjustment.right,bottom:this.originalDropDownSettings.adjustment.bottom,left:this.originalDropDownSettings.adjustment.left});if(this.elemRef&&this.buttonElem){var c=this.commonService.getBorderWidth(this.elemRef.nativeElement.firstElementChild),b=this.commonService.getMargin(this.elemRef.nativeElement.firstElementChild),d=this.commonService.getPadding(this.elemRef.nativeElement.firstElementChild);
this.placementValue==integralui_core_1.IntegralUIPlacement.Left?this.openDirection&integralui_core_1.IntegralUIDirection.Left?(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(b.left+c.left+d.left)+1,this.openDirection&integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(b.top+c.top+c.bottom+d.top+d.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(this.openDirection&integralui_core_1.IntegralUIDirection.Right&&
(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(b.left+c.left+d.left)),this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(b.top+c.top+c.bottom+d.top+d.bottom)+2)):this.openDirection&integralui_core_1.IntegralUIDirection.Right?(a.left+=b.right+c.right+d.right,this.openDirection&integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(b.top+c.top+c.bottom+d.top+d.bottom)+1:this.openDirection&
integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(a.left=this.openDirection&integralui_core_1.IntegralUIDirection.Left?a.left+(b.right+c.right+d.right):a.left-this.buttonElem.nativeElement.offsetWidth,this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(b.top+c.top+c.bottom+d.top+d.bottom)+2))}this.dropDownSettings&&(this.dropDownSettings.adjustment=a,this.dropDownSettings.direction=this.openDirection,this.dropDownSettings.inverse=
this.placementValue!=integralui_core_1.IntegralUIPlacement.Left||this.openDirection&integralui_core_1.IntegralUIDirection.Right||!(this.openDirection&integralui_core_1.IntegralUIDirection.Above||this.openDirection&integralui_core_1.IntegralUIDirection.Below)?!1:!0)};b.prototype.onButtonContextMenu=function(a){a.preventDefault()};b.prototype.onDropDownItemClick=function(a){this.itemClick.emit(a)};b.prototype.onDropDownOpening=function(a){this.dropDownOpening.emit(a)};b.prototype.onDropDownOpened=function(a){this.state|=
integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownOpened.emit(a)};b.prototype.onDropDownClosed=function(a){this.state&=~integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownClosed.emit(a)};b.prototype.getControlStyle=function(){var a={};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};b.prototype.getDefaultDropDownStyle=function(){return{general:{normal:"iui-dropdown-button-list"}}};
b.prototype.updateButtonClass=function(){this.buttonClass.length=0;this.placementValue==integralui_core_1.IntegralUIPlacement.Left?(this.buttonClass.push(this.buttonClassName+"-left"),this.openDirection&integralui_core_1.IntegralUIDirection.Left?this.buttonClass.push(this.generalClassName+"-open-left"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above")):(this.buttonClass.push(this.buttonClassName+"-right"),this.openDirection&
integralui_core_1.IntegralUIDirection.Right?this.buttonClass.push(this.generalClassName+"-open-right"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above"));this.options.currentStyle&&(this.buttonClass.push(this.options.currentStyle.button.normal),this.state&integralui_core_1.IntegralUIObjectState.disabled?this.buttonClass.push(this.options.currentStyle.button.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?
this.buttonClass.push(this.options.currentStyle.button.focused):this.state&integralui_core_1.IntegralUIObjectState.selected?this.buttonClass.push(this.options.currentStyle.button.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered&&this.buttonClass.push(this.options.currentStyle.button.hovered))};b.prototype.getButtonClass=function(){return this.buttonClass};b.prototype.getButtonStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,
this.buttonClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.buttonClassName+"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.buttonClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.buttonClassName),selected:this.commonService.isFieldAvailable(a.selected,this.buttonClassName+"-selected")}:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,
selected:this.defaultStyle.button.selected}};b.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),button:this.getButtonStyle(a.button)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,selected:this.defaultStyle.general.selected},button:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,
hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}}};b.prototype.refresh=function(){var a=this,b=setTimeout(function(){a.updateStyle(a.controlStyle);a.updateControlClass();a.updateButtonClass();clearTimeout(b)},1)};b.decorators=[{type:core_1.Component,args:[{selector:"iui-dropdown-button",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()">\n\t\t\t<ng-content></ng-content>\n\t\t\t<div [ngClass]="getButtonClass()" (contextmenu)="onButtonContextMenu($event)" [iuiContextMenu]="settings" (menuClick)="onDropDownItemClick($event)" (menuOpening)="onDropDownOpening($event)" (menuOpened)="onDropDownOpened($event)" (menuClosed)="onDropDownClosed($event)" #button>\n\t\t\t\t<span></span>\n\t\t\t</div>\n\t\t</div>\n\t',
inputs:"controlStyle data enabled name size state".split(" "),encapsulation:core_1.ViewEncapsulation.None}]}];b.ctorParameters=function(){return[{type:core_1.ElementRef},{type:integralui_common_service_1.IntegralUICommonService}]};b.propDecorators={buttonElem:[{type:core_1.ViewChild,args:["button"]}],placement:[{type:core_1.Input}],direction:[{type:core_1.Input}],settings:[{type:core_1.Input}],itemClick:[{type:core_1.Output}],dropDownOpening:[{type:core_1.Output}],dropDownOpened:[{type:core_1.Output}],
dropDownClosed:[{type:core_1.Output}]};return b}(integralui_button_1.IntegralUIButton);exports.IntegralUIDropDownButton=IntegralUIDropDownButton;