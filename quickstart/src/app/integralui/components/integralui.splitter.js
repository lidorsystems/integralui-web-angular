/*
  filename: integralui.splitter.js
  version : 1.6.0
  Copyright Â© 2016-2019 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var e=function(b,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return e(b,a)};return function(b,a){function f(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(f.prototype=a.prototype,new f)}}(),__decorate=this&&this.__decorate||function(e,b,a,f){var c=arguments.length,d=3>c?b:null===f?f=Object.getOwnPropertyDescriptor(b,a):f,g;
if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=Reflect.decorate(e,b,a,f);else for(var h=e.length-1;0<=h;h--)if(g=e[h])d=(3>c?g(d):3<c?g(b,a,d):g(b,a))||d;return 3<c&&d&&Object.defineProperty(b,a,d),d},__metadata=this&&this.__metadata||function(e,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,b)};Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUISplitter=function(e){function b(a,b,c){var d=e.call(this,c)||this;d.elemRef=a;d.elemRenderer=b;d.commonService=c;d.clientSize={width:0,height:0};d.currentSplitterDistance=0;d.maxPos={x:0,y:0};d.panel1Size={width:0,height:0};d.panel2Size={width:0,height:0};d.splitterSize={width:0,height:0};d.splitterHandleSize={width:0,height:0};d.prevMaxPos=
{x:0,y:0};d.handleClass=[];d.orientation=integralui_core_1.IntegralUIOrientation.Vertical;d.orientationChanged=new core_1.EventEmitter;d.splitterMoved=new core_1.EventEmitter;d.splitterMoving=new core_1.EventEmitter;d.splitterStartPos={x:0,y:0};d.isSplitterActive=!1;return d}__extends(b,e);b.prototype.getMaxPos=function(){return this.maxPos};Object.defineProperty(b.prototype,"splitterDistance",{get:function(){return this.currentSplitterDistance},set:function(a){this.currentSplitterDistance!=a&&(this.currentSplitterDistance=
a,this.splitterMoved.emit({value:a}),this.updateLayout())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"panel2",{get:function(){return this.currentPanel2},set:function(a){this.currentPanel2!=a&&(this.currentPanel2=a,this.updateLayout())},enumerable:!0,configurable:!0});b.prototype.ngOnInit=function(){this.generalClassName="iui-splitter";this.handleClassName=this.generalClassName+"-handle";this.initStyle()};b.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+
"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},handle:{general:this.handleClassName,horizontal:this.handleClassName+"-horizontal",vertical:this.handleClassName+"-vertical"}};this.updateStyle(this.controlStyle);this.updateControlClass();this.updateHandleClass()};b.prototype.ngAfterViewInit=function(){};b.prototype.ngAfterContentInit=function(){this.initLayout();this.updateSettings()};
b.prototype.initLayout=function(){var a=this,b=setTimeout(function(){a.clientSize={width:a.elemRef.nativeElement.parentElement.clientWidth,height:a.elemRef.nativeElement.parentElement.clientHeight};if(a.panel1&&a.panel1.nativeElement){var c=a.commonService.getBorderWidth(a.panel1.nativeElement);a.panel1Size={width:a.panel1.nativeElement.offsetWidth+c.left+c.right,height:a.panel1.nativeElement.offsetHeight+c.top+c.bottom}}a.panel2&&a.panel2.nativeElement&&(c=a.commonService.getBorderWidth(a.panel2.nativeElement),
a.panel2Size={width:a.panel2.nativeElement.offsetWidth+c.left+c.right,height:a.panel2.nativeElement.offsetHeight+c.top+c.bottom});a.splitterHandleSize={width:a.handleElem.nativeElement.offsetWidth,height:a.handleElem.nativeElement.offsetHeight};a.splitterSize=a.orientation==integralui_core_1.IntegralUIOrientation.Vertical?{width:a.splitterHandleSize.width,height:a.clientSize.height}:{width:a.clientSize.width,height:a.splitterHandleSize.height};a.maxPos={x:a.clientSize.width-a.splitterHandleSize.width,
y:a.clientSize.height-a.splitterHandleSize.height};a.prevMaxPos.x=a.maxPos.x;a.prevMaxPos.y=a.maxPos.y;0==a.currentSplitterDistance&&(a.currentSplitterDistance=a.orientation==integralui_core_1.IntegralUIOrientation.Vertical?a.panel1Size.width:a.panel1Size.height);a.updateLayout();clearTimeout(b)},1)};b.prototype.ngAfterContentChecked=function(){this.clientRect={width:this.elemRef.nativeElement.firstElementChild.clientWidth,height:this.elemRef.nativeElement.firstElementChild.clientHeight};this.clientRect.width!=
this.prevClientRect.width?(this.updateLayout(),this.prevClientRect.width=this.clientRect.width):this.clientRect.height!=this.prevClientRect.height&&(this.updateLayout(),this.prevClientRect.height=this.clientRect.height)};b.prototype.updateSettings=function(){this.clientSize={width:this.elemRef.nativeElement.parentElement.clientWidth,height:this.elemRef.nativeElement.parentElement.clientHeight};this.splitterSize=this.orientation==integralui_core_1.IntegralUIOrientation.Vertical?{width:this.splitterHandleSize.width,
height:this.clientSize.height}:{width:this.clientSize.width,height:this.splitterHandleSize.height};this.maxPos={x:this.clientSize.width-this.splitterHandleSize.width,y:this.clientSize.height-this.splitterHandleSize.height};if(this.orientation==integralui_core_1.IntegralUIOrientation.Vertical&&this.maxPos.x!=this.prevMaxPos.x){var a=Math.floor((this.maxPos.x-this.prevMaxPos.x)/2);0==this.splitterDistance?this.splitterDistance+=a:(this.panel2Size.width=this.maxPos.x-this.splitterDistance-this.splitterHandleSize.width,
this.updatePanelSize());this.prevMaxPos.x=this.maxPos.x}else this.orientation==integralui_core_1.IntegralUIOrientation.Horizontal&&this.maxPos.y!=this.prevMaxPos.y&&(a=Math.floor((this.maxPos.y-this.prevMaxPos.y)/2),0==this.splitterDistance?this.splitterDistance+=a:(this.panel2Size.height=this.maxPos.y-this.splitterDistance-this.splitterHandleSize.height,this.updatePanelSize()),this.prevMaxPos.y=this.maxPos.y)};b.prototype.calcSplitterDistance=function(a,b){var c=this.currentSplitterDistance;this.orientation==
integralui_core_1.IntegralUIOrientation.Vertical?(a&&b&&(c+=b.x-a.x),c=Math.min(Math.max(0,c),this.maxPos.x),this.panel1Size.width=c,this.panel2Size.width=this.maxPos.x-c-this.splitterHandleSize.width):(a&&b&&(c+=b.y-a.y),c=Math.min(Math.max(0,c),this.maxPos.y),this.panel1Size.height=c,this.panel2Size.height=this.maxPos.y-c-this.splitterHandleSize.height);if(this.currentSplitterDistance!=c){var d={cancel:!1,value:c};this.splitterMoving.emit(d);1!=d.cancel&&(this.currentSplitterDistance=c)}};b.prototype.updateLayout=
function(a,b){var c=this;if(c.panel1&&c.panel2)var d=setTimeout(function(){c.calcSplitterDistance(a,b);c.updatePanelSize();c.updateSettings();clearTimeout(d)},10)};b.prototype.updatePanelSize=function(){this.panel1&&this.panel2&&(this.orientation==integralui_core_1.IntegralUIOrientation.Vertical?(this.elemRenderer.setElementStyle(this.panel1.nativeElement,"width",this.panel1Size.width+"px"),this.elemRenderer.setElementStyle(this.panel2.nativeElement,"width",this.panel2Size.width+"px")):(this.elemRenderer.setElementStyle(this.panel1.nativeElement,
"height",this.panel1Size.height+"px"),this.elemRenderer.setElementStyle(this.panel2.nativeElement,"height",this.panel2Size.height+"px")))};b.prototype.splitterMouseDown=function(a){if(this.isEnabled){var b=this.commonService.getShiftPos();this.splitterStartPos={x:a.pageX-b.x,y:a.pageY-b.y};this.isSplitterActive=!0}};b.prototype.onWindowMouseMove=function(a){if(this.isEnabled&&1==a.buttons&&this.isSplitterActive){var b=this.commonService.getShiftPos();a={x:a.pageX-b.x,y:a.pageY-b.y};this.updateLayout(this.splitterStartPos,
a);this.splitterStartPos=a}};b.prototype.onWindowMouseUp=function(a){this.isEnabled&&(this.isSplitterActive=!1,this.splitterMoved.emit({value:this.currentSplitterDistance}))};b.prototype.onResize=function(a){this.updateSettings()};b.prototype.getControlStyle=function(){var a={cursor:"ew-resize",display:"block",width:"auto",height:"auto"};this.orientation==integralui_core_1.IntegralUIOrientation.Vertical?(a["border-top-width"]=0,a["border-bottom-width"]=0,a.display="inline-block",a.height="100%",0<
this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px")):(a["border-left-width"]=0,a["border-right-width"]=0,a.cursor="ns-resize",a.width="100%",0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px"));return a};b.prototype.getSplitterHandleStyle=function(){var a={"margin-top":"0","margin-left":"0"};this.orientation==integralui_core_1.IntegralUIOrientation.Vertical?a["margin-top"]=(this.clientSize.height-this.splitterHandleSize.height)/2+"px":a["margin-left"]=(this.clientSize.width-this.splitterHandleSize.width)/
2+"px";return a};b.prototype.updateHandleClass=function(){this.handleClass.length=0;this.handleClass.push(this.handleClassName);this.handleClass.push(this.options.currentStyle.handle.general);this.orientation==integralui_core_1.IntegralUIOrientation.Vertical?this.handleClass.push(this.options.currentStyle.handle.vertical):this.handleClass.push(this.options.currentStyle.handle.horizontal)};b.prototype.getHandleClass=function(){return this.handleClass};b.prototype.getHandleStyle=function(a){return this.commonService.isString(a)?
a:a?{general:this.commonService.isFieldAvailable(a.general,this.handleClassName),horizontal:this.commonService.isFieldAvailable(a.horizontal,this.handleClassName+"-horizontal"),vertical:this.commonService.isFieldAvailable(a.vertical,this.handleClassName+"-vertical")}:{general:this.defaultStyle.handle.general,horizontal:this.defaultStyle.handle.horizontal,vertical:this.defaultStyle.handle.vertical}};b.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),
handle:this.getHandleStyle(a.handle)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,selected:this.defaultStyle.general.selected},handle:{general:this.defaultStyle.handle.general,horizontal:this.defaultStyle.handle.horizontal,vertical:this.defaultStyle.handle.vertical}}};__decorate([core_1.ViewChild("handle",{"static":!1}),__metadata("design:type",core_1.ElementRef)],
b.prototype,"handleElem",void 0);__decorate([core_1.Input(),__metadata("design:type",Number)],b.prototype,"orientation",void 0);__decorate([core_1.Input(),__metadata("design:type",Object)],b.prototype,"panel1",void 0);__decorate([core_1.Input(),__metadata("design:type",Object)],b.prototype,"panel3",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],b.prototype,"splitterDistance",null);__decorate([core_1.Input(),__metadata("design:type",Object),
__metadata("design:paramtypes",[Object])],b.prototype,"panel2",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"orientationChanged",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"splitterMoved",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"splitterMoving",void 0);__decorate([core_1.HostListener("document:mousemove",["$event"]),__metadata("design:type",Function),
__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],b.prototype,"onWindowMouseMove",null);__decorate([core_1.HostListener("document:mouseup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],b.prototype,"onWindowMouseUp",null);__decorate([core_1.HostListener("window:resize",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",
void 0)],b.prototype,"onResize",null);return b=__decorate([core_1.Component({selector:"iui-splitter",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()" (mousedown)="splitterMouseDown($event)">\n\t\t\t<span #handle [ngClass]="getHandleClass()" [ngStyle]="getSplitterHandleStyle()"></span>\n\t\t</div>\n\t',inputs:"controlStyle data enabled name size state".split(" "),encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[core_1.ElementRef,core_1.Renderer,
integralui_common_service_1.IntegralUICommonService])],b)}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUISplitter=IntegralUISplitter;