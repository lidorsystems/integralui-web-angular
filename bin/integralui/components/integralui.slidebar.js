/*
  filename: integralui.slidebar.js
  version : 1.3.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(d,b){function a(){this.constructor=d}for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)},__decorate=this&&this.__decorate||function(d,b,a,e){var f=arguments.length,c=3>f?b:null===e?e=Object.getOwnPropertyDescriptor(b,a):e,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)c=Reflect.decorate(d,b,a,e);else for(var h=d.length-1;0<=h;h--)if(g=d[h])c=(3>f?g(c):3<f?g(b,a,c):
g(b,a))||c;return 3<f&&c&&Object.defineProperty(b,a,c),c},__metadata=this&&this.__metadata||function(d,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(d,b)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),IntegralUISlide=function(){function d(b){this.elemRef=b}d.prototype.size=
function(){return{width:Math.floor(this.elemRef.nativeElement.firstElementChild.offsetWidth),height:Math.floor(this.elemRef.nativeElement.firstElementChild.offsetHeight)}};d.prototype.cloneElem=function(){return this.elemRef.nativeElement.firstElementChild.cloneNode(!0)};return d}();
IntegralUISlide=__decorate([core_1.Component({selector:"iui-slide",template:'<li class="iui-slide" data-element="slide">\n    \t\t<ng-content></ng-content>\n\t\t</li>\n\t'}),__metadata("design:paramtypes",[core_1.ElementRef])],IntegralUISlide);exports.IntegralUISlide=IntegralUISlide;
var IntegralUISlideBar=function(d){function b(a,b,f){var c=d.call(this,b)||this;c.dataService=a;c.commonService=b;c.cmpResolver=f;c.animationTimeout=null;c.animationTimer=null;c.buttons=[];c.arrowTopPos=0;c.arrowDisplay="none";c.numSlides=0;c.cloneAdded=!1;c.cloneElem=null;c.blockMargin=0;c.elemSize={width:0,height:0};c.blockSize={width:0,height:0};c.slideSize={width:0,height:0};c.currentSelection=null;c.currentSelectedIndex=-1;c.selectedSlideComponent=null;c.removeIndex=-1;c.trialRef=null;c.allowAnimation=
!0;c.animationPause=2E3;c.animationSpeed="normal";c.clear=new core_1.EventEmitter;c.slideAdding=new core_1.EventEmitter;c.slideAdded=new core_1.EventEmitter;c.slideChanged=new core_1.EventEmitter;c.slideRemoving=new core_1.EventEmitter;c.slideRemoved=new core_1.EventEmitter;return c}__extends(b,d);Object.defineProperty(b.prototype,"selectedIndex",{get:function(){return this.currentSelectedIndex},set:function(a){this.currentSelectedIndex!=a&&(this.currentSelectedIndex=a,this.selectSlideByIndex(a))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedSlide",{get:function(){return this.currentSelection},set:function(a){this.currentSelection!=a&&(this.currentSelection=a,this.slides&&this.selectSlideByIndex(this.slides.indexOf(a)))},enumerable:!0,configurable:!0});b.prototype.ngOnInit=function(){this.dataService.init([{data:this.slides}])};b.prototype.ngAfterViewInit=function(){var a=this,b=setTimeout(function(){var e=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);
e&&(a.trialRef=a.blockRef.createComponent(e));clearTimeout(b)},100)};b.prototype.ngAfterContentInit=function(){this.slideList=this.contentSlideList.toArray();this.checkClone();this.numSlides=this.slideList.length;0<this.numSlides&&(0<=this.selectedIndex?this.selectSlideByIndex(this.selectedIndex):this.selectedSlide&&this.slides&&this.selectSlideByIndex(this.slides.indexOf(this.selectedSlide)));this.updateLayout();this.changeSlide()};b.prototype.ngOnDestroy=function(){this.trialRef&&this.trialRef.destroy()};
b.prototype.ngAfterContentChecked=function(){this.contentSlideList&&(this.slideList=this.contentSlideList.toArray(),this.numSlides!=this.slideList.length&&(this.numSlides>this.slideList.length&&this.slides&&0<this.slides.length&&(this.removeIndex==this.slides.length&&(this.removeIndex=this.slides.length-1),0<=this.removeIndex&&this.removeIndex<this.slides.length&&(this.isIndexInRange(this.removeIndex)?this.selectSlideByIndex(this.removeIndex):this.selectSlideByIndex(this.slideList.length-1))),this.numSlides=
this.slideList.length,this.updateLayout()),0==this.numSlides&&(this.cloneElem&&(this.cloneElem.remove(),this.cloneElem=null,this.cloneAdded=!1),this.selectedSlideComponent=null,this.arrowDisplay="none"))};b.prototype.checkClone=function(){this.slideList&&0<this.slideList.length&&!this.cloneAdded&&(this.cloneElem=this.slideList[0].cloneElem(),this.blockElem.nativeElement.append(this.cloneElem),this.cloneAdded=!0)};b.prototype.clearSlides=function(){this.dataService.clear();this.clear.emit(null)};b.prototype.addSlide=
function(a){this.callEventAdd("add",a)};b.prototype.insertSlideAt=function(a,b){this.callEventAdd("at",a,b)};b.prototype.insertSlideBefore=function(a,b){this.callEventAdd("ref",a,-1,b)};b.prototype.insertSlideAfter=function(a,b){this.callEventAdd("ref",a,-1,b,!0)};b.prototype.removeSlide=function(a){this.callEventRemove(a)};b.prototype.removeSlideAt=function(a){this.slides&&0<=a&&a<this.slides.length&&this.callEventRemove(this.slides[a])};b.prototype.callEventAdd=function(a,b,d,c,g){var e={cancel:!1,
slide:b};this.slideAdding.emit(e);if(1!=e.cancel){switch(a){case "at":this.dataService.insert(b,d);break;case "ref":this.dataService.insertByRef(b,c,g);break;default:this.dataService.insert(b)}this.slideAdded.emit({slide:b});this.selectedSlideComponent||this.selectSlideByIndex(0)}};b.prototype.callEventRemove=function(a){var b={cancel:!1,slide:a};this.slideRemoving.emit(b);1!=b.cancel&&(this.removeIndex=this.slides?this.slides.indexOf(a):-1,this.dataService.removeAt(a),this.slideRemoved.emit({slide:a}))};
b.prototype.getButtonClass=function(a){var b=this.getSlideCurrentIndex(this.selectedSlideComponent);return a&&a.index==b?"iui-slidebar-navigator-button-selected":""};b.prototype.getSlideCurrentIndex=function(a){this.slideList=this.contentSlideList.toArray();return a&&this.slideList?this.slideList.indexOf(a):-1};b.prototype.getSlideDataIndex=function(a){return a&&(a=this.getSlideCurrentIndex(a),this.slides&&0<=a&&a<this.slides.length)?a:-1};b.prototype.getSlideData=function(a){return this.slides&&
0<=a&&a<this.slides.length?this.slides[a]:null};b.prototype.isIndexInRange=function(a){return this.slideList?0<=a&&a<this.slideList.length:!1};b.prototype.ctrlMouseEnter=function(a){this.isEnabled&&(this.arrowDisplay="block")};b.prototype.ctrlMouseLeave=function(a){this.arrowDisplay="none"};b.prototype.prevSlide=function(){if(this.isEnabled){var a=this.getSlideCurrentIndex(this.selectedSlideComponent)-1;this.isIndexInRange(a)?this.selectSlideByIndex(a):this.selectSlideByIndex(this.slideList.length-
1)}};b.prototype.nextSlide=function(){if(this.isEnabled){var a=this.getSlideCurrentIndex(this.selectedSlideComponent)+1;this.isIndexInRange(a)?this.selectSlideByIndex(a):this.selectSlideByIndex(0)}};b.prototype.updateLayout=function(){var a=this;a.slideList=a.contentSlideList.toArray();a.buttons.length=0;if(a.slideList&&0<a.slideList.length){a.blockSize.width=0;a.checkClone();a.selectedSlideComponent||(a.selectedSlideComponent=a.slideList[0]);var b=0;a.slideList.forEach(function(d){var c=d.size();
a.blockSize.width+=c.width;a.blockSize.height=c.height;d==a.slideList[0]&&(a.blockSize.width+=c.width,a.elemSize.width=c.width);a.slideSize.width=c.width;a.slideSize.height=c.height;a.buttons.push({index:b});b++});a.blockSize.width++;a.arrowTopPos=Math.floor((a.blockSize.height-a.arrowElem.nativeElement.offsetHeight)/2)}};b.prototype.cancelAnimation=function(){this.animationTimer&&clearInterval(this.animationTimer);this.animationTimer=null};b.prototype.changeSlide=function(){var a=this.getSlideCurrentIndex(this.selectedSlideComponent);
0<=a&&(this.blockMargin=-(this.slideSize.width*a));this.startAnimation()};b.prototype.getSpeedFactor=function(){switch(this.animationSpeed){case "veryfast":return 25;case "fast":return 15;case "slow":return 5;case "veryslow":return 2}return 10};b.prototype.startAnimation=function(){var a=this;a.animationTimeout&&clearTimeout(a.animationTimeout);a.animationTimeout=setTimeout(function(){a.cancelAnimation();if(0!=a.allowAnimation&&1<a.slideList.length){var b=a.getSlideCurrentIndex(a.selectedSlideComponent),
d=0,c=a.getSpeedFactor();a.animationTimer=setInterval(function(){d<a.slideSize.width?(d+=c,a.blockMargin-=c):(d=0,a.cancelAnimation(),b++,a.isIndexInRange(b)?a.selectSlideByIndex(b):a.selectSlideByIndex(0))},15)}clearTimeout(a.animationTimeout)},a.animationPause)};b.prototype.stopAnimation=function(){this.cancelAnimation();var a=this.getSlideCurrentIndex(this.selectedSlideComponent);this.blockMargin=-(this.slideSize.width*a)};b.prototype.selectSlide=function(a){a&&(this.selectedSlideComponent=a,this.slideChanged.emit({index:this.getSlideCurrentIndex(a),
slide:this.getSlideData(this.getSlideDataIndex(a))}),this.changeSlide())};b.prototype.selectSlideByIndex=function(a){this.isIndexInRange(a)&&this.selectSlide(this.slideList[a])};return b}(integralui_core_1.IntegralUIBaseComponent);__decorate([core_1.ViewChild("control",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUISlideBar.prototype,"controlRef",void 0);
__decorate([core_1.ViewChild("block",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUISlideBar.prototype,"blockRef",void 0);__decorate([core_1.ContentChildren(IntegralUISlide),__metadata("design:type",core_1.QueryList)],IntegralUISlideBar.prototype,"contentSlideList",void 0);__decorate([core_1.ViewChild("block",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUISlideBar.prototype,"blockElem",void 0);
__decorate([core_1.ViewChild("arrow",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUISlideBar.prototype,"arrowElem",void 0);__decorate([core_1.Input(),__metadata("design:type",Boolean)],IntegralUISlideBar.prototype,"allowAnimation",void 0);__decorate([core_1.Input(),__metadata("design:type",Number)],IntegralUISlideBar.prototype,"animationPause",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],IntegralUISlideBar.prototype,"animationSpeed",void 0);
__decorate([core_1.Input(),__metadata("design:type",Array)],IntegralUISlideBar.prototype,"slides",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUISlideBar.prototype,"selectedIndex",null);__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUISlideBar.prototype,"selectedSlide",null);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"clear",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"slideAdding",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"slideAdded",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"slideChanged",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"slideRemoving",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUISlideBar.prototype,"slideRemoved",void 0);
IntegralUISlideBar=__decorate([core_1.Component({selector:"iui-slidebar",template:'<div class="iui-slidebar" #control data-element="slidebar" (mouseenter)="ctrlMouseEnter($event)" (mouseleave)="ctrlMouseLeave($event)" [ngStyle]="{ \'width\': elemSize.width + \'px\' }">\n        \t<ul #block class="iui-slidebar-container" [ngStyle]="{ \'margin-left\': blockMargin + \'px\', \'width\': blockSize.width + \'px\', \'height\': blockSize.height + \'px\' }">\n        \t\t<ng-content></ng-content>\n        \t</ul>\n        \t<div class="iui-slidebar-navigator">\n        \t\t<span class="iui-slidebar-navigator-button" *ngFor="let button of buttons; let i = index" [ngClass]="getButtonClass(button)" (click)="selectSlideByIndex(i)"></span>\n        \t</div>\n        \t<div #arrow class="iui-slidebar-arrow iui-slidebar-arrow-left" [ngStyle]="{ \'display\': arrowDisplay, \'top\': arrowTopPos + \'px\' }" (click)="prevSlide()"><span></span></div>\n        \t<div class="iui-slidebar-arrow iui-slidebar-arrow-right" [ngStyle]="{ \'display\': arrowDisplay, \'top\': arrowTopPos + \'px\' }" (click)="nextSlide()"><span></span></div>\n\t\t</div>\n\t',inputs:["controlStyle",
"data","enabled","name","state"],providers:[integralui_data_service_1.IntegralUIDataService]}),__metadata("design:paramtypes",[integralui_data_service_1.IntegralUIDataService,integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver])],IntegralUISlideBar);exports.IntegralUISlideBar=IntegralUISlideBar;