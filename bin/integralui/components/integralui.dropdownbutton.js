/*
  filename: integralui.dropdownbutton.js
  version : 1.3.0
  Copyright Â© 2016-2020 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var e=function(c,a){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,d){a.__proto__=d}||function(a,d){for(var b in d)d.hasOwnProperty(b)&&(a[b]=d[b])};return e(c,a)};return function(c,a){function b(){this.constructor=c}e(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}}();Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_button_1=require("./integralui.button"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),i0=require("@angular/core"),i1=require("../services/integralui.common.service"),i2=require("@angular/common"),i3=require("../directives/integralui.contextmenu"),_c0=["button"],_c1=["*"],IntegralUIDropDownButton=function(e){function c(a,b){var d=e.call(this,a,b)||this;d.elemRef=a;d.commonService=
b;d.originalDropDownSettings={};d.dropDownSettings={};d.placementValue=integralui_core_1.IntegralUIPlacement.Right;d.openDirection=integralui_core_1.IntegralUIDirection.Below;d.buttonClass=[];d.itemClick=new core_1.EventEmitter;d.dropDownOpening=new core_1.EventEmitter;d.dropDownOpened=new core_1.EventEmitter;d.dropDownClosed=new core_1.EventEmitter;d.updateDropDownSettings();return d}__extends(c,e);c.prototype.ngOnInit=function(){this.generalClassName="iui-dropdown-button";this.buttonClassName=this.generalClassName+
"-btn";this.initStyle()};c.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},button:{disabled:this.buttonClassName+"-disabled",focused:this.buttonClassName+"-focused",normal:this.buttonClassName,hovered:this.buttonClassName+"-hovered",selected:this.buttonClassName+"-selected"}};this.updateStyle(this.controlStyle);
this.updateControlClass();this.updateButtonClass()};c.prototype.ngAfterViewInit=function(){};Object.defineProperty(c.prototype,"placement",{get:function(){return this.placementValue},set:function(a){this.placementValue=a;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"direction",{get:function(){return this.openDirection},set:function(a){this.openDirection=a;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"settings",{get:function(){return this.dropDownSettings},set:function(a){this.updateDropDownSettings(a)},enumerable:!0,configurable:!0});c.prototype.getAdjustmentValue=function(a){var b={top:0,right:0,bottom:0,left:0};a&&(b={top:this.commonService.isFieldAvailable(a.top,0),bottom:this.commonService.isFieldAvailable(a.bottom,0),right:this.commonService.isFieldAvailable(a.right,0),left:this.commonService.isFieldAvailable(a.left,0)});return b};c.prototype.updateDropDownSettings=function(a){var b=this,
d=setTimeout(function(){b.originalDropDownSettings=a?{adjustment:b.getAdjustmentValue(a.adjustment),appRef:b.commonService.isFieldAvailable(a.appRef,null),autoClose:b.commonService.isFieldAvailable(a.autoClose,!0),buttonType:1,direction:b.openDirection,enabled:b.commonService.isFieldAvailable(a.enabled,!0),inverse:!1,items:b.commonService.isFieldAvailable(a.items,[]),position:"manual",style:b.commonService.isFieldAvailable(a.style,b.getDefaultDropDownStyle())}:{adjustment:b.getAdjustmentValue(),appRef:null,
autoClose:!0,buttonType:1,direction:b.openDirection,enabled:!0,inverse:!1,items:[],position:"manual",style:b.getDefaultDropDownStyle()};b.dropDownSettings={adjustment:b.originalDropDownSettings.adjustment,appRef:b.originalDropDownSettings.appRef,autoClose:b.originalDropDownSettings.autoClose,buttonType:1,direction:b.originalDropDownSettings.direction,enabled:b.originalDropDownSettings.enabled,inverse:b.originalDropDownSettings.inverse,items:b.originalDropDownSettings.items,position:b.originalDropDownSettings.position,
style:b.originalDropDownSettings.style};b.updateAdjustment();clearTimeout(d)},1)};c.prototype.updateAdjustment=function(){var a={top:0,right:0,bottom:0,left:0};this.originalDropDownSettings&&this.originalDropDownSettings.adjustment&&(a={top:this.originalDropDownSettings.adjustment.top,right:this.originalDropDownSettings.adjustment.right,bottom:this.originalDropDownSettings.adjustment.bottom,left:this.originalDropDownSettings.adjustment.left});if(this.elemRef&&this.buttonElem){var b=this.commonService.getBorderWidth(this.elemRef.nativeElement.firstElementChild),
d=this.commonService.getMargin(this.elemRef.nativeElement.firstElementChild),c=this.commonService.getPadding(this.elemRef.nativeElement.firstElementChild);this.placementValue==integralui_core_1.IntegralUIPlacement.Left?this.openDirection&integralui_core_1.IntegralUIDirection.Left?(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(d.left+b.left+c.left)+1,this.openDirection&integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(d.top+b.top+b.bottom+
c.top+c.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(this.openDirection&integralui_core_1.IntegralUIDirection.Right&&(a.left=a.left-this.buttonElem.nativeElement.offsetWidth-(d.left+b.left+c.left)),this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(d.top+b.top+b.bottom+c.top+c.bottom)+2)):this.openDirection&integralui_core_1.IntegralUIDirection.Right?(a.left+=d.right+b.right+c.right,this.openDirection&
integralui_core_1.IntegralUIDirection.Below?a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(d.top+b.top+b.bottom+c.top+c.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top+=1)):(a.left=this.openDirection&integralui_core_1.IntegralUIDirection.Left?a.left+(d.right+b.right+c.right):a.left-this.buttonElem.nativeElement.offsetWidth,this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(a.top=a.top-this.buttonElem.nativeElement.offsetHeight-(d.top+b.top+b.bottom+
c.top+c.bottom)+2))}this.dropDownSettings&&(this.dropDownSettings.adjustment=a,this.dropDownSettings.direction=this.openDirection,this.dropDownSettings.inverse=this.placementValue!=integralui_core_1.IntegralUIPlacement.Left||this.openDirection&integralui_core_1.IntegralUIDirection.Right||!(this.openDirection&integralui_core_1.IntegralUIDirection.Above||this.openDirection&integralui_core_1.IntegralUIDirection.Below)?!1:!0)};c.prototype.onButtonContextMenu=function(a){a.preventDefault()};c.prototype.onDropDownItemClick=
function(a){this.itemClick.emit(a)};c.prototype.onDropDownOpening=function(a){this.dropDownOpening.emit(a)};c.prototype.onDropDownOpened=function(a){this.state|=integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownOpened.emit(a)};c.prototype.onDropDownClosed=function(a){this.state&=~integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownClosed.emit(a)};c.prototype.getControlStyle=function(){var a={};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+
"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};c.prototype.getDefaultDropDownStyle=function(){return{general:{normal:"iui-dropdown-button-list"}}};c.prototype.updateButtonClass=function(){this.buttonClass.length=0;this.placementValue==integralui_core_1.IntegralUIPlacement.Left?(this.buttonClass.push(this.buttonClassName+"-left"),this.openDirection&integralui_core_1.IntegralUIDirection.Left?this.buttonClass.push(this.generalClassName+"-open-left"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&
this.buttonClass.push(this.generalClassName+"-open-above")):(this.buttonClass.push(this.buttonClassName+"-right"),this.openDirection&integralui_core_1.IntegralUIDirection.Right?this.buttonClass.push(this.generalClassName+"-open-right"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above"));this.options.currentStyle&&(this.buttonClass.push(this.options.currentStyle.button.normal),this.state&integralui_core_1.IntegralUIObjectState.disabled?
this.buttonClass.push(this.options.currentStyle.button.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?this.buttonClass.push(this.options.currentStyle.button.focused):this.state&integralui_core_1.IntegralUIObjectState.selected?this.buttonClass.push(this.options.currentStyle.button.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered&&this.buttonClass.push(this.options.currentStyle.button.hovered))};c.prototype.getButtonClass=function(){return this.buttonClass};
c.prototype.getButtonStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,this.buttonClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.buttonClassName+"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.buttonClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.buttonClassName),selected:this.commonService.isFieldAvailable(a.selected,this.buttonClassName+"-selected")}:
{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}};c.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),button:this.getButtonStyle(a.button)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,
selected:this.defaultStyle.general.selected},button:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}}};c.prototype.refresh=function(){var a=this,b=setTimeout(function(){a.updateStyle(a.controlStyle);a.updateControlClass();a.updateButtonClass();clearTimeout(b)},1)};c.\u0275fac=function(a){return new (a||c)(i0.\u0275\u0275directiveInject(i0.ElementRef),
i0.\u0275\u0275directiveInject(i1.IntegralUICommonService))};c.\u0275cmp=i0.\u0275\u0275defineComponent({type:c,selectors:[["iui-dropdown-button"]],viewQuery:function(a,b){a&1&&i0.\u0275\u0275viewQuery(_c0,!0);if(a&2){var c;i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.buttonElem=c.first)}},inputs:{controlStyle:"controlStyle",data:"data",enabled:"enabled",name:"name",size:"size",state:"state",placement:"placement",direction:"direction",settings:"settings"},outputs:{itemClick:"itemClick",
dropDownOpening:"dropDownOpening",dropDownOpened:"dropDownOpened",dropDownClosed:"dropDownClosed"},features:[i0.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:_c1,decls:5,vars:4,consts:[[3,"ngClass","ngStyle"],[3,"ngClass","iuiContextMenu","contextmenu","menuClick","menuOpening","menuOpened","menuClosed"],["button",""]],template:function(a,b){a&1&&(i0.\u0275\u0275projectionDef(),i0.\u0275\u0275elementStart(0,"div",0),i0.\u0275\u0275projection(1),i0.\u0275\u0275elementStart(2,"div",1,2),
i0.\u0275\u0275listener("contextmenu",function(a){return b.onButtonContextMenu(a)})("menuClick",function(a){return b.onDropDownItemClick(a)})("menuOpening",function(a){return b.onDropDownOpening(a)})("menuOpened",function(a){return b.onDropDownOpened(a)})("menuClosed",function(a){return b.onDropDownClosed(a)}),i0.\u0275\u0275element(4,"span"),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementEnd());a&2&&(i0.\u0275\u0275property("ngClass",b.getControlClass())("ngStyle",b.getControlStyle()),i0.\u0275\u0275advance(2),
i0.\u0275\u0275property("ngClass",b.getButtonClass())("iuiContextMenu",b.settings))},directives:[i2.NgClass,i2.NgStyle,i3.IntegralUIContextMenu],encapsulation:2});return c}(integralui_button_1.IntegralUIButton);exports.IntegralUIDropDownButton=IntegralUIDropDownButton;
(function(){i0.\u0275setClassMetadata(IntegralUIDropDownButton,[{type:core_1.Component,args:[{selector:"iui-dropdown-button",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()">\n\t\t\t<ng-content></ng-content>\n\t\t\t<div [ngClass]="getButtonClass()" (contextmenu)="onButtonContextMenu($event)" [iuiContextMenu]="settings" (menuClick)="onDropDownItemClick($event)" (menuOpening)="onDropDownOpening($event)" (menuOpened)="onDropDownOpened($event)" (menuClosed)="onDropDownClosed($event)" #button>\n\t\t\t\t<span></span>\n\t\t\t</div>\n\t\t</div>\n\t',inputs:"controlStyle data enabled name size state".split(" "),
encapsulation:core_1.ViewEncapsulation.None}]}],function(){return[{type:i0.ElementRef},{type:i1.IntegralUICommonService}]},{buttonElem:[{type:core_1.ViewChild,args:["button",{"static":!1}]}],placement:[{type:core_1.Input}],direction:[{type:core_1.Input}],settings:[{type:core_1.Input}],itemClick:[{type:core_1.Output}],dropDownOpening:[{type:core_1.Output}],dropDownOpened:[{type:core_1.Output}],dropDownClosed:[{type:core_1.Output}]})})();