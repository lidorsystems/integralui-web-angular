/*
  filename: integralui.treelist.js
  version : 2.0.0
  Copyright Â© 2016-2020 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var d=function(c,a){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,e){a.__proto__=e}||function(a,e){for(var b in e)e.hasOwnProperty(b)&&(a[b]=e[b])};return d(c,a)};return function(c,a){function b(){this.constructor=c}d(c,a);c.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}}();Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),i0=require("@angular/core"),i1=require("../services/integralui.common.service"),i2=require("./integralui.core"),i3=require("@angular/common"),i4=require("../services/integralui.data.service"),i5=require("./integralui.scrollbar");
function IntegralUITreeListItem_ng_template_2_Template(d,c){}var _c0=function(d,c){return{height:d,width:c}},_c1=function(d){return{"iui-treelistitem-animate-select iui-treelistitem-animate-select-left":d}},_c2=function(d){return{height:d}};
function IntegralUITreeListItem_span_3_Template(d,c){d&1&&(i0.\u0275\u0275elementStart(0,"span",4),i0.\u0275\u0275element(1,"span",5),i0.\u0275\u0275elementEnd());if(d&2){var a=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction2(3,_c0,a.getSize().height+"px",a.clickPos.x+"px"));i0.\u0275\u0275advance(1);i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction1(6,_c1,a.isClicked))("ngStyle",i0.\u0275\u0275pureFunction1(8,_c2,a.getSize().height+"px"))}}
var _c3=function(d,c,a){return{left:d,height:c,width:a}},_c4=function(d){return{"iui-treelistitem-animate-select iui-treelistitem-animate-select-right":d}};
function IntegralUITreeListItem_span_4_Template(d,c){d&1&&(i0.\u0275\u0275elementStart(0,"span",4),i0.\u0275\u0275element(1,"span",5),i0.\u0275\u0275elementEnd());if(d&2){var a=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction3(3,_c3,a.clickPos.x+"px",a.getSize().height+"px",a.getSize().width-a.clickPos.x+"px"));i0.\u0275\u0275advance(1);i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction1(7,_c4,a.isClicked))("ngStyle",i0.\u0275\u0275pureFunction1(9,
_c2,a.getSize().height+"px"))}}var _c5=function(d,c,a){return{"iui-treelistitem-general":d,"iui-treelistitem-animate":c,"iui-treelistitem-animate-enter-suspended":a}},_c6=["contentBlock"],_c7=["header"],_c8=["leftBlock"],_c9=["rightBlock"],_c10=["itemElem"];function IntegralUITreeList_span_3_Template(d,c){d&1&&i0.\u0275\u0275element(0,"span",14)}var _c11=function(d){return{"iui-treelist-header-animate-select iui-treelistitem-animate-select-left":d}};
function IntegralUITreeList_span_6_Template(d,c){d&1&&(i0.\u0275\u0275elementStart(0,"span",15),i0.\u0275\u0275element(1,"span",16),i0.\u0275\u0275elementEnd());if(d&2){var a=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction2(3,_c0,a.animateItemSize.height+"px",a.clickPos.x+"px"));i0.\u0275\u0275advance(1);i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction1(6,_c11,a.isClicked))("ngStyle",i0.\u0275\u0275pureFunction1(8,_c2,a.animateItemSize.height+
"px"))}}var _c12=function(d){return{"iui-treelist-header-animate-select iui-treelistitem-animate-select-right":d}};
function IntegralUITreeList_span_7_Template(d,c){d&1&&(i0.\u0275\u0275elementStart(0,"span",15),i0.\u0275\u0275element(1,"span",16),i0.\u0275\u0275elementEnd());if(d&2){var a=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction3(3,_c3,a.clickPos.x+"px",a.animateItemSize.height+"px",a.animateItemSize.width-a.clickPos.x+"px"));i0.\u0275\u0275advance(1);i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction1(7,_c12,a.isClicked))("ngStyle",i0.\u0275\u0275pureFunction1(9,
_c2,a.animateItemSize.height+"px"))}}function IntegralUITreeList_iui_treelistitem_11_Template(d,c){d&1&&i0.\u0275\u0275element(0,"iui-treelistitem",17);if(d&2){var a=c.$implicit,b=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("allowAnimation",b.allowAnimation)("enabled",a.data.enabled)("text",a.data.text)("templateRef",b.itemTemplate)("data",a.data)("type",a.data.type)}}
function IntegralUITreeList_iui_treelistitem_14_Template(d,c){if(d&1){var a=i0.\u0275\u0275getCurrentView();i0.\u0275\u0275elementStart(0,"iui-treelistitem",18,19);i0.\u0275\u0275listener("mouseDown",function(b){i0.\u0275\u0275restoreView(a);var e=c.$implicit;return i0.\u0275\u0275nextContext().onItemMouseDown(b,e.data)})("mouseEnter",function(b){i0.\u0275\u0275restoreView(a);var e=c.$implicit;return i0.\u0275\u0275nextContext().onItemMouseEnter(b,e.data)})("mouseLeave",function(b){i0.\u0275\u0275restoreView(a);
var e=c.$implicit;return i0.\u0275\u0275nextContext().onItemMouseLeave(b,e.data)});i0.\u0275\u0275elementEnd()}if(d&2){var b=c.$implicit,e=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("allowAnimation",e.allowAnimation)("enabled",b.data.enabled)("text",b.data.text)("templateRef",e.itemTemplate)("data",b.data)("type",b.data.type)("indent",b.indent)("state",e.getItemState(b.data))}}
function IntegralUITreeList_iui_treelistitem_17_Template(d,c){d&1&&i0.\u0275\u0275element(0,"iui-treelistitem",17);if(d&2){var a=c.$implicit,b=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("allowAnimation",b.allowAnimation)("enabled",a.data.enabled)("text",a.data.text)("templateRef",b.itemTemplate)("data",a.data)("type",a.data.type)}}var _c13=function(d,c){return{"iui-treelist-scroll-available":d,"iui-treelist-scroll-not-available":c}};
function IntegralUITreeList_iui_scrollbar_18_Template(d,c){if(d&1){var a=i0.\u0275\u0275getCurrentView();i0.\u0275\u0275elementStart(0,"iui-scrollbar",20,21);i0.\u0275\u0275listener("mouseenter",function(b){i0.\u0275\u0275restoreView(a);return i0.\u0275\u0275nextContext().scrollMouseEnter(b)})("valueChanged",function(b){i0.\u0275\u0275restoreView(a);return i0.\u0275\u0275nextContext().onVerticalScrollChanged(b)})("scrollStart",function(b){i0.\u0275\u0275restoreView(a);return i0.\u0275\u0275nextContext().onVerticalScrollStart(b)})("scrollEnd",
function(b){i0.\u0275\u0275restoreView(a);return i0.\u0275\u0275nextContext().onVerticalScrollEnd(b)});i0.\u0275\u0275elementEnd()}if(d&2){var b=i0.\u0275\u0275nextContext();i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction2(6,_c13,b.isScrollAvailable,!b.isScrollAvailable))("enabled",b.enabled)("value",b.currentScrollPos.y)("max",b.maxScrollPos.y)("largeChange",b.scrollLargeChange.y)("height",b.scrollBarSize.height)}}
var _c14=function(d){return{width:d}},_c15=function(d,c){return{width:d,height:c}},_c16=function(d,c,a,b,e){return{top:d,left:c,width:a,height:b,opacity:e}},IntegralUITreeListItem=function(d){function c(a,b,e){var c=d.call(this,a,b)||this;c.elemRef=a;c.commonService=b;c.baseService=e;c.templateData=[];c.clickPos={x:0,y:0};c.isClicked=!1;c.isHovered=!1;c.parentCtrl=null;c.indent=0;return c}__extends(c,d);c.prototype.ngOnInit=function(){this.templateData.push(this.data);this.parentCtrl=this.baseService.getComponent();
this.generalClassName="group"===this.type?"iui-treelistgroup":"iui-treelistitem";this.contentClassName=this.generalClassName+"-content";this.initStyle()};c.prototype.onMouseDown=function(a){var b=this;if(b.isEnabled){b.isClicked=!0;b.clickPos=b.commonService.getClientPos(a,b.elemRef.nativeElement.firstElementChild);var e=setTimeout(function(){b.isClicked=!1;clearTimeout(e)},500);b.mouseDown.emit(a)}a.stopPropagation()};c.prototype.onMouseEnter=function(a){this.isEnabled&&(this.state|=integralui_core_1.IntegralUIObjectState.hovered,
this.isHovered=!0,this.mouseEnter.emit(a));a.stopPropagation()};c.prototype.onMouseMove=function(a){this.isEnabled&&this.mouseMove.emit(a)};c.prototype.onMouseLeave=function(a){this.isEnabled&&(this.state&=~integralui_core_1.IntegralUIObjectState.hovered,this.mouseLeave.emit(a));this.isHovered=!1;a.stopPropagation()};c.prototype.getControlStyle=function(){var a={position:this.positionType,top:this.itemPos.top+"px",left:this.itemPos.left+"px"};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px");
0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");this.indent&&(a["padding-left"]=this.indent+"px");return a};c.\u0275fac=function(a){return new (a||c)(i0.\u0275\u0275directiveInject(i0.ElementRef),i0.\u0275\u0275directiveInject(i1.IntegralUICommonService),i0.\u0275\u0275directiveInject(i2.IntegralUIBaseService))};c.\u0275cmp=i0.\u0275\u0275defineComponent({type:c,selectors:[["iui-treelistitem"]],inputs:{controlStyle:"controlStyle",data:"data",enabled:"enabled",icon:"icon",name:"name",
size:"size",state:"state",text:"text",indent:"indent",templateRef:"templateRef",type:"type"},outputs:{click:"click",mouseDown:"mouseDown",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseUp:"mouseUp"},features:[i0.\u0275\u0275InheritDefinitionFeature],decls:5,vars:11,consts:[[3,"ngClass","mouseenter","mousemove","mouseleave"],[2,"position","relative",3,"ngClass","ngStyle","click","mousedown","mouseup"],["ngFor","",3,"ngForOf","ngForTemplate"],["class","iui-treelistitem-animate-select-block",
3,"ngStyle",4,"ngIf"],[1,"iui-treelistitem-animate-select-block",3,"ngStyle"],[3,"ngClass","ngStyle"]],template:function(a,b){a&1&&(i0.\u0275\u0275elementStart(0,"li",0),i0.\u0275\u0275listener("mouseenter",function(a){return b.onMouseEnter(a)})("mousemove",function(a){return b.onMouseMove(a)})("mouseleave",function(a){return b.onMouseLeave(a)}),i0.\u0275\u0275elementStart(1,"div",1),i0.\u0275\u0275listener("click",function(a){return b.onClick(a)})("mousedown",function(a){return b.onMouseDown(a)})("mouseup",
function(a){return b.onMouseUp(a)}),i0.\u0275\u0275template(2,IntegralUITreeListItem_ng_template_2_Template,0,0,"ng-template",2),i0.\u0275\u0275template(3,IntegralUITreeListItem_span_3_Template,2,10,"span",3),i0.\u0275\u0275template(4,IntegralUITreeListItem_span_4_Template,2,11,"span",3),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementEnd());a&2&&(i0.\u0275\u0275property("ngClass",i0.\u0275\u0275pureFunction3(7,_c5,!b.allowAnimation,b.allowAnimation,b.allowAnimation&&b.isHovered)),i0.\u0275\u0275advance(1),
i0.\u0275\u0275property("ngClass",b.getControlClass())("ngStyle",b.getControlStyle()),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngForOf",b.templateData)("ngForTemplate",b.templateRef),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngIf",b.allowAnimation&&b.isClicked),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngIf",b.allowAnimation&&b.isClicked))},directives:[i3.NgClass,i3.NgStyle,i3.NgForOf,i3.NgIf],encapsulation:2});return c}(integralui_core_1.IntegralUIItem);
exports.IntegralUITreeListItem=IntegralUITreeListItem;
(function(){i0.\u0275setClassMetadata(IntegralUITreeListItem,[{type:core_1.Component,args:[{selector:"iui-treelistitem",template:'\n\t\t<li [ngClass]="{ \'iui-treelistitem-general\': !allowAnimation, \'iui-treelistitem-animate\': allowAnimation, \'iui-treelistitem-animate-enter-suspended\': allowAnimation && isHovered }" (mouseenter)="onMouseEnter($event)" (mousemove)="onMouseMove($event)" (mouseleave)="onMouseLeave($event)">\n\t\t\t<div [ngClass]="getControlClass()" style="position:relative" [ngStyle]="getControlStyle()" (click)="onClick($event)" (mousedown)="onMouseDown($event)" (mouseup)="onMouseUp($event)">\n\t\t\t\t<ng-template ngFor [ngForOf]="templateData" [ngForTemplate]="templateRef"></ng-template>  \n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ height: getSize().height + \'px\', width: clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-left\': isClicked }" [ngStyle]="{ height: getSize().height + \'px\' }"></span>\n\t           </span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ left: clickPos.x + \'px\', height: getSize().height + \'px\', width: getSize().width - clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-right\': isClicked }" [ngStyle]="{ height: getSize().height + \'px\' }"></span>\n\t            </span>\n\t\t\t</div>\n\t\t</li>\n\t',inputs:"controlStyle data enabled icon name size state text".split(" "),
outputs:"click mouseDown mouseEnter mouseLeave mouseMove mouseUp".split(" "),encapsulation:core_1.ViewEncapsulation.None}]}],function(){return[{type:i0.ElementRef},{type:i1.IntegralUICommonService},{type:i2.IntegralUIBaseService}]},{indent:[{type:core_1.Input}],templateRef:[{type:core_1.Input}],type:[{type:core_1.Input}]})})();
var IntegralUITreeList=function(d){function c(a,b,e,c,k){var f=d.call(this,e)||this;f.dataService=a;f.elemRef=b;f.commonService=e;f.cmpResolver=c;f.baseService=k;f.animateItemSize={width:0,height:0};f.animSpeed=300;f.prevClickedObj=null;f.currentDataFields={};f.currentList=[];f.nextList=[];f.prevList=[];f.clickPos={x:0,y:0};f.hoverItem=null;f.isClicked=!1;f.avgItemHeight=0;f.blockPos={top:30,left:0};f.currentIndent=15;f.headerWidth=0;f.leftBlockPos={top:30,left:-300};f.rightBlockPos={top:30,left:300};
f.blockSize={width:0,height:0};f.currentBlockHeight=0;f.maxBlockHeight=0;f.leftBlockOpacity=0;f.blockOpacity=1;f.rightBlockOpacity=0;f.updateTimer=null;f.currentScrollPos={x:0,y:0};f.maxScrollPos={x:0,y:0};f.isScrollActive=!1;f.isScrollAllowed=!0;f.isScrollAvailable=!1;f.isScrollTimerActive=!1;f.prevScrollPos={x:0,y:0};f.scrollBarSize={width:0,height:0};f.scrollCount=0;f.scrollLargeChange={x:0,y:0};f.scrollSize={width:0,height:0};f.scrollTimerID=null;f.currentSelection=null;f.headerItem=null;f.headerText=
"";f.tRef=null;f.mouseWheelSpeed=integralui_core_1.IntegralUISpeedMode.Normal;f.afterSelect=new core_1.EventEmitter;f.beforeSelect=new core_1.EventEmitter;f.clear=new core_1.EventEmitter;f.itemAdding=new core_1.EventEmitter;f.itemAdded=new core_1.EventEmitter;f.itemRemoving=new core_1.EventEmitter;f.itemRemoved=new core_1.EventEmitter;f.scrollPosChanged=new core_1.EventEmitter;f.selectionChanged=new core_1.EventEmitter;f.scrollAppearanceTimeout=null;f.updateDataFields();f.selList=[];return f}__extends(c,
d);Object.defineProperty(c.prototype,"dataFields",{set:function(a){this.updateDataFields(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"indent",{get:function(){return this.currentIndent},set:function(a){this.currentIndent!==a&&(this.currentIndent=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selectedItem",{get:function(){return this.currentSelection},set:function(a){var b={cancel:!1,header:this.headerItem,item:a};this.beforeSelect.emit(b);1==b.cancel||
this.isGroupItem(a)||this.currentSelection==a||(this.currentSelection=a,a?a[this.currentDataFields.items]&&0<a[this.currentDataFields.items].length&&(this.headerItem=a,this.headerText=a.text):(this.headerItem=null,this.headerText=this.title),this.afterSelect.emit({header:this.headerItem,item:a}),this.selectionChanged.emit(null))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"showScroll",{get:function(){return this.isScrollAllowed},set:function(a){this.isScrollAllowed=a},enumerable:!0,
configurable:!0});c.prototype.ngOnInit=function(){this.baseService.setComponent(this);this.dataService.init([{data:this.items}]);this.updateList(this.currentList,this.items);this.headerText=this.title;this.generalClassName="iui-treelist";this.initStyle()};c.prototype.ngAfterViewInit=function(){var a=this,b=setTimeout(function(){var e=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);e&&a.contentRef&&(a.tRef=a.contentRef.createComponent(e));clearTimeout(b)},100);a.updateLayout();
setTimeout(function(){a.updateLayout()},250)};c.prototype.ngOnDestroy=function(){this.resetLayoutTimer();this.resetScrollAppearanceTimeout();this.tRef&&this.tRef.destroy()};c.prototype.updateList=function(a,b){var e=this;a.length=0;b&&b.forEach(function(b){e.addChildItems(a,b,0,null)})};c.prototype.addChildItems=function(a,b,e,c,d){var f=this,h=!0;if(!b[f.currentDataFields.items])return h=f.addItemToCurrentList(a,b,e,c,d);(h=f.addItemToCurrentList(a,b,e,c,d))&&"group"===b[f.currentDataFields.type]&&
f.isItemExpanded(b)&&(c=b[f.currentDataFields.items])&&c.forEach(function(c){f.addChildItems(a,c,e+f.currentIndent,b[f.currentDataFields.id],b)});return h};c.prototype.addItemToCurrentList=function(a,b,e,c,d){this.isGroupItem(b)||(b[this.currentDataFields.type]="item");b[this.currentDataFields.id]||(b[this.currentDataFields.id]=this.commonService.getUniqueId());c&&(b[this.currentDataFields.pid]=c);(c=this.isItemAllowed(b))&&a.push({data:b,indent:e});return c};c.prototype.updateDataFields=function(a){this.currentDataFields=
a?{enabled:a.enabled?a.enabled:"enabled",expanded:a.expanded?a.expanded:"expanded",hasChildren:a.hasChildren?a.hasChildren:"hasChildren",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",items:a.items?a.items:"items",pid:a.pid?a.pid:"pid",selected:a.selected?a.selected:"selected",style:a.style?a.style:"style",text:a.text?a.text:"text",tooltip:a.tooltip?a.tooltip:"tooltip",type:a.type?a.type:"type",value:a.value?a.value:"value",visible:a.visible?a.visible:"visible"}:{enabled:"enabled",expanded:"expanded",
hasChildren:"hasChildren",icon:"icon",id:"id",items:"items",pid:"pid",selected:"selected",style:"style",text:"text",tooltip:"tooltip",type:"type",value:"value",visible:"visible"}};c.prototype.resetScrollAppearanceTimeout=function(){this.scrollAppearanceTimeout&&clearTimeout(this.scrollAppearanceTimeout);this.scrollAppearanceTimeout=null};c.prototype.updateScrollAppearance=function(a){var b=this;b.resetScrollAppearanceTimeout();this.scrollAppearanceTimeout=setTimeout(function(){var e=b.commonService.getShiftPos(),
c=b.commonService.getMousePos(a);c.x-=e.x;c.y-=e.y;e=b.commonService.getPageRect(b.elemRef.nativeElement.firstElementChild);b.isScrollAvailable=c.x<=e.right&&c.x>=e.right-75?!0:!1},100)};c.prototype.ctrlMouseMove=function(a){this.isEnabled&&this.isVerScrollVisible()?this.updateScrollAppearance(a):this.isScrollAvailable=!1};c.prototype.ctrlMouseLeave=function(a){this.resetScrollAppearanceTimeout();this.isScrollAvailable=this.isEnabled&&this.isScrollActive?!0:!1};c.prototype.onItemMouseEnter=function(a,
b){this.isEnabled&&(this.hoverItem=b)};c.prototype.onItemMouseLeave=function(a,b){this.hoverItem=null};c.prototype.onItemMouseDown=function(a,b){var e=this;if(e.isEnabled&&1==a.buttons&&b)if(e.isGroupItem(b))b[e.currentDataFields.expanded]=!1===b[e.currentDataFields.expanded],e.updateLayout();else if(b[e.currentDataFields.items]&&0<b[e.currentDataFields.items].length){e.selList.push(e.headerItem);e.updateList(e.nextList,b[e.currentDataFields.items]);var c=e.currentScrollPos.y=0,d=5/e.clientRect.width,
f=.5,l=1/e.clientRect.width,g=0;if(e.allowAnimation)var m=setInterval(function(){c<e.clientRect.width?(c+=10,f-=d,g+=l,e.blockPos.left=-c,e.blockOpacity=f,e.rightBlockPos.left=e.clientRect.width-c,e.rightBlockOpacity=g):(e.selectedItem=b,e.currentList=e.nextList,e.blockPos.left=0,e.blockOpacity=1,e.rightBlockPos.left=e.clientRect.width,e.rightBlockOpacity=0,e.updateScrollSize(),clearInterval(m))},10);else e.selectedItem=b,e.currentList=e.nextList,e.blockPos.left=0,e.blockOpacity=1,e.rightBlockPos.left=
e.clientRect.width,e.rightBlockOpacity=0,e.updateScrollSize()}else e.selectedItem=b};c.prototype.onHeaderMouseDown=function(a){var b=this;if(this.isEnabled&&1==a.buttons&&0<b.selList.length){var c=b.selList.length-1;b.selList[c]&&b.selList[c][b.currentDataFields.items]?b.updateList(b.prevList,b.selList[c][b.currentDataFields.items]):b.updateList(b.prevList,b.items);var d=b.currentScrollPos.y=0,k=5/b.clientRect.width,f=.5,l=1/b.clientRect.width,g=0;if(b.allowAnimation){var m=setInterval(function(){d<
b.clientRect.width?(d+=10,f-=k,g+=l,b.blockPos.left=d,b.blockOpacity=f,b.leftBlockPos.left=d-b.clientRect.width,b.leftBlockOpacity=g):(b.selectedItem=b.selList[c],b.currentList=b.prevList,b.selList.splice(c,1),b.blockPos.left=0,b.blockOpacity=1,b.leftBlockPos.left=-b.clientRect.width,b.leftBlockOpacity=0,b.updateScrollSize(),clearInterval(m))},10);b.isClicked=!0;b.clickPos=b.commonService.getClientPos(a,b.headerElem.nativeElement);var n=setTimeout(function(){b.isClicked=!1;clearTimeout(n)},500)}else b.selectedItem=
b.selList[c],b.currentList=b.prevList,b.selList.splice(c,1),b.blockPos.left=0,b.blockOpacity=1,b.leftBlockPos.left=-b.clientRect.width,b.leftBlockOpacity=0,b.updateScrollSize()}};c.prototype.getItemElemList=function(){return this.itemElems?this.itemElems.toArray():null};c.prototype.getItemState=function(a){return a==this.selectedItem?integralui_core_1.IntegralUIObjectState.selected:a==this.hoverItem?integralui_core_1.IntegralUIObjectState.hovered:integralui_core_1.IntegralUIObjectState.normal};c.prototype.isGroupItem=
function(a){return a&&"group"===a[this.currentDataFields.type]?!0:!1};c.prototype.isItemAllowed=function(a){return a&&!1!==a[this.currentDataFields.visible]?!0:!1};c.prototype.isItemExpanded=function(a){return a?a[this.currentDataFields.expanded]||void 0===a[this.currentDataFields.expanded]?!0:!1:!0};c.prototype.resetLayoutTimer=function(){this.updateTimer&&clearTimeout(this.updateTimer);this.updateTimer=null};c.prototype.updateBlockSize=function(){this.blockPos.top=this.leftBlockPos.top=this.rightBlockPos.top=
this.headerElem.nativeElement.offsetHeight;this.blockSize={width:this.scrollBarSize.width,height:this.currentBlockHeight};this.leftBlockPos.left=-this.blockSize.width;this.rightBlockPos.left=this.blockSize.width;this.maxBlockHeight=Math.max(this.blockSize.height,this.clientRect.height-this.headerElem.nativeElement.offsetHeight)};c.prototype.updateLayout=function(){var a=this;a.resetLayoutTimer();a.updateTimer=setTimeout(function(){a.clientRect={width:a.elemRef.nativeElement.firstElementChild.clientWidth,
height:a.elemRef.nativeElement.firstElementChild.clientHeight};a.updateList(a.currentList,a.headerItem?a.headerItem[a.currentDataFields.items]:a.items);a.updateScrollSize();clearTimeout(a.updateTimer)},1)};c.prototype.updateScrollSize=function(){var a=this,b=setTimeout(function(){a.avgItemHeight=0;a.currentBlockHeight=0;var c=a.getItemElemList();if(c&&0<c.length){for(var d=0;d<c.length;d++)a.currentBlockHeight+=c[d].nativeElement.firstElementChild.offsetHeight;a.avgItemHeight=Math.floor(a.currentBlockHeight/
c.length)}a.animateItemSize={width:a.headerElem.nativeElement.offsetWidth,height:a.headerElem.nativeElement.offsetHeight};a.scrollSize={width:0,height:a.currentBlockHeight+a.headerElem.nativeElement.offsetHeight-a.clientRect.height+2};a.scrollSize.width=0<a.scrollSize.width?a.scrollSize.width:0;a.scrollSize.height=0<a.scrollSize.height?a.scrollSize.height:0;a.maxScrollPos={x:a.scrollSize.width,y:a.scrollSize.height};a.currentScrollPos.y>a.maxScrollPos.y&&a.changeVerticalScrollPos(a.maxScrollPos.y);
a.scrollBarSize={width:a.isVerScrollVisible()?a.clientRect.width-16:a.clientRect.width,height:a.isHorScrollVisible()?a.clientRect.height-16:a.clientRect.height-4};a.scrollLargeChange={x:a.scrollBarSize.width,y:a.scrollBarSize.height};a.updateBlockSize();c=a.commonService.getPadding(a.headerElem.nativeElement);d=a.commonService.getBorderWidth(a.headerElem.nativeElement);a.headerWidth=a.scrollBarSize.width-(c.left+c.right)-(d.left+d.right);clearTimeout(b)},1)};c.prototype.updateView=function(){this.blockPos.top=
this.headerElem.nativeElement.offsetHeight-this.currentScrollPos.y};c.prototype.scrollPos=function(a){a&&(this.currentScrollPos={x:Math.max(0,Math.min(a.x,this.maxScrollPos.x)),y:Math.max(0,Math.min(a.y,this.maxScrollPos.y))},this.scrollPosChanged.emit({value:this.currentScrollPos}));return{x:Math.floor(this.currentScrollPos.x),y:Math.floor(this.currentScrollPos.y)}};c.prototype.changeVerticalScrollPos=function(a){this.currentScrollPos.y=Math.max(0,Math.min(a,this.maxScrollPos.y));this.currentScrollPos.y!=
this.prevScrollPos.y&&(this.updateView(),this.scrollPosChanged.emit({value:this.scrollPos()}),this.prevScrollPos.y=this.currentScrollPos.y)};c.prototype.processMouseWheel=function(a,b){if(this.isEnabled){this.hoverItem=null;var c=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)),d=5;switch(this.mouseWheelSpeed){case integralui_core_1.IntegralUISpeedMode.VerySlow:d=15;break;case integralui_core_1.IntegralUISpeedMode.Slow:d=9;break;case integralui_core_1.IntegralUISpeedMode.Fast:d=3;break;case integralui_core_1.IntegralUISpeedMode.VeryFast:d=
1}a.preventDefault();this.isVerScrollVisible()&&(d=Math.floor(this.clientRect.height/d),this.mouseWheelSpeed==integralui_core_1.IntegralUISpeedMode.VerySlow&&0<this.avgItemHeight&&(d=this.avgItemHeight),this.changeVerticalScrollPos(this.currentScrollPos.y+d*c*-1));a.stopPropagation()}};c.prototype.isHorScrollVisible=function(){return!1};c.prototype.isVerScrollVisible=function(){return this.isEnabled&&this.isScrollAllowed&&0<this.scrollSize.height?!0:!1};c.prototype.onVerticalScrollStart=function(a){this.hoverItem=
null;this.isScrollActive=!0};c.prototype.onVerticalScrollEnd=function(a){this.isScrollActive=!1;this.updateScrollAppearance(a)};c.prototype.onVerticalScrollChanged=function(a){this.changeVerticalScrollPos(a.value)};c.prototype.scrollMouseEnter=function(a){};c.prototype.getControlStyle=function(){var a={};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};c.prototype.refresh=function(){};c.\u0275fac=function(a){return new (a||
c)(i0.\u0275\u0275directiveInject(i4.IntegralUIDataService),i0.\u0275\u0275directiveInject(i0.ElementRef),i0.\u0275\u0275directiveInject(i1.IntegralUICommonService),i0.\u0275\u0275directiveInject(i0.ComponentFactoryResolver),i0.\u0275\u0275directiveInject(i2.IntegralUIBaseService))};c.\u0275cmp=i0.\u0275\u0275defineComponent({type:c,selectors:[["iui-treelist"]],contentQueries:function(a,b,c){a&1&&i0.\u0275\u0275contentQuery(c,core_1.TemplateRef,!0);if(a&2){var e;i0.\u0275\u0275queryRefresh(e=i0.\u0275\u0275loadQuery())&&
(b.itemTemplate=e.first)}},viewQuery:function(a,b){a&1&&(i0.\u0275\u0275viewQuery(_c6,!0,core_1.ViewContainerRef),i0.\u0275\u0275viewQuery(_c6,!0,core_1.ElementRef),i0.\u0275\u0275viewQuery(_c7,!0,core_1.ElementRef),i0.\u0275\u0275viewQuery(_c8,!0,core_1.ElementRef),i0.\u0275\u0275viewQuery(_c9,!0,core_1.ElementRef),i0.\u0275\u0275viewQuery(IntegralUITreeListItem,!0),i0.\u0275\u0275viewQuery(_c10,!0,core_1.ElementRef));if(a&2){var c;i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.contentRef=
c.first);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.blockElem=c.first);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.headerElem=c.first);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.leftBlockElem=c.first);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.rightBlockElem=c.first);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.contentList=c);i0.\u0275\u0275queryRefresh(c=i0.\u0275\u0275loadQuery())&&(b.itemElems=c)}},inputs:{controlStyle:"controlStyle",
data:"data",enabled:"enabled",state:"state",dataFields:"dataFields",indent:"indent",items:"items",mouseWheelSpeed:"mouseWheelSpeed",selectedItem:"selectedItem",showScroll:"showScroll",title:"title"},outputs:{afterSelect:"afterSelect",beforeSelect:"beforeSelect",clear:"clear",itemAdding:"itemAdding",itemAdded:"itemAdded",itemRemoving:"itemRemoving",itemRemoved:"itemRemoved",scrollPosChanged:"scrollPosChanged",selectionChanged:"selectionChanged"},features:[i0.\u0275\u0275ProvidersFeature([integralui_core_1.IntegralUIBaseService,
integralui_data_service_1.IntegralUIDataService]),i0.\u0275\u0275InheritDefinitionFeature],decls:19,vars:37,consts:[[3,"ngClass","DOMMouseScroll","mousewheel","mousemove","mouseleave"],[1,"iui-treelist-header",3,"ngStyle","mousedown"],["header",""],["class","expand-icons back",4,"ngIf"],[1,"iui-treelist-header-title"],["class","iui-treelistitem-animate-select-block",3,"ngStyle",4,"ngIf"],[1,"iui-treelist-block",3,"ngStyle"],[3,"ngStyle"],["leftBlock",""],[3,"allowAnimation","enabled","text","templateRef",
"data","type",4,"ngFor","ngForOf"],["contentBlock",""],[3,"allowAnimation","enabled","text","templateRef","data","type","indent","state","mouseDown","mouseEnter","mouseLeave",4,"ngFor","ngForOf"],["rightBlock",""],["class","iui-treelist-scroll",3,"ngClass","enabled","value","max","largeChange","height","mouseenter","valueChanged","scrollStart","scrollEnd",4,"ngIf"],[1,"expand-icons","back"],[1,"iui-treelistitem-animate-select-block",3,"ngStyle"],[3,"ngClass","ngStyle"],[3,"allowAnimation","enabled",
"text","templateRef","data","type"],[3,"allowAnimation","enabled","text","templateRef","data","type","indent","state","mouseDown","mouseEnter","mouseLeave"],["itemElem",""],[1,"iui-treelist-scroll",3,"ngClass","enabled","value","max","largeChange","height","mouseenter","valueChanged","scrollStart","scrollEnd"],["verScroll",""]],template:function(a,b){a&1&&(i0.\u0275\u0275elementStart(0,"div",0),i0.\u0275\u0275listener("DOMMouseScroll",function(a){return b.processMouseWheel(a)})("mousewheel",function(a){return b.processMouseWheel(a)})("mousemove",
function(a){return b.ctrlMouseMove(a)})("mouseleave",function(a){return b.ctrlMouseLeave(a)}),i0.\u0275\u0275elementStart(1,"div",1,2),i0.\u0275\u0275listener("mousedown",function(a){return b.onHeaderMouseDown(a)}),i0.\u0275\u0275template(3,IntegralUITreeList_span_3_Template,1,0,"span",3),i0.\u0275\u0275elementStart(4,"span",4),i0.\u0275\u0275text(5),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275template(6,IntegralUITreeList_span_6_Template,2,10,"span",5),i0.\u0275\u0275template(7,IntegralUITreeList_span_7_Template,
2,11,"span",5),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementStart(8,"div",6),i0.\u0275\u0275elementStart(9,"ul",7,8),i0.\u0275\u0275template(11,IntegralUITreeList_iui_treelistitem_11_Template,1,6,"iui-treelistitem",9),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementStart(12,"ul",7,10),i0.\u0275\u0275template(14,IntegralUITreeList_iui_treelistitem_14_Template,2,8,"iui-treelistitem",11),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementStart(15,"ul",7,12),i0.\u0275\u0275template(17,IntegralUITreeList_iui_treelistitem_17_Template,
1,6,"iui-treelistitem",9),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275elementEnd(),i0.\u0275\u0275template(18,IntegralUITreeList_iui_scrollbar_18_Template,2,9,"iui-scrollbar",13),i0.\u0275\u0275elementEnd());a&2&&(i0.\u0275\u0275property("ngClass",b.getControlClass()),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction1(14,_c14,b.headerWidth+"px")),i0.\u0275\u0275advance(2),i0.\u0275\u0275property("ngIf",null!=b.headerItem),i0.\u0275\u0275advance(2),i0.\u0275\u0275textInterpolate(b.headerText),
i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngIf",b.allowAnimation&&b.isClicked),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngIf",b.allowAnimation&&b.isClicked),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction2(16,_c15,b.blockSize.width+"px",b.maxBlockHeight+"px")),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction5(19,_c16,b.leftBlockPos.top+"px",b.leftBlockPos.left+"px",b.blockSize.width+"px",b.maxBlockHeight+
"px",b.leftBlockOpacity)),i0.\u0275\u0275advance(2),i0.\u0275\u0275property("ngForOf",b.prevList),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction5(25,_c16,b.blockPos.top+"px",b.blockPos.left+"px",b.blockSize.width+"px",b.blockSize.height+"px",b.blockOpacity)),i0.\u0275\u0275advance(2),i0.\u0275\u0275property("ngForOf",b.currentList),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngStyle",i0.\u0275\u0275pureFunction5(31,_c16,b.rightBlockPos.top+"px",b.rightBlockPos.left+
"px",b.blockSize.width+"px",b.maxBlockHeight+"px",b.rightBlockOpacity)),i0.\u0275\u0275advance(2),i0.\u0275\u0275property("ngForOf",b.nextList),i0.\u0275\u0275advance(1),i0.\u0275\u0275property("ngIf",b.isVerScrollVisible()))},directives:[i3.NgClass,i3.NgStyle,i3.NgIf,i3.NgForOf,IntegralUITreeListItem,i5.IntegralUIScrollBar],encapsulation:2});return c}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUITreeList=IntegralUITreeList;
(function(){i0.\u0275setClassMetadata(IntegralUITreeList,[{type:core_1.Component,args:[{selector:"iui-treelist",template:'\n\t\t<div [ngClass]="getControlClass()" (DOMMouseScroll)="processMouseWheel($event)" (mousewheel)="processMouseWheel($event)" (mousemove)="ctrlMouseMove($event)" (mouseleave)="ctrlMouseLeave($event)">\n\t\t\t<div class="iui-treelist-header" (mousedown)="onHeaderMouseDown($event)" [ngStyle]="{ width: headerWidth + \'px\' }" #header>\n                <span class="expand-icons back" *ngIf="headerItem!=null"></span>\n                <span class="iui-treelist-header-title">{{headerText}}</span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ height: animateItemSize.height + \'px\', width: clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelist-header-animate-select iui-treelistitem-animate-select-left\': isClicked }" [ngStyle]="{ height: animateItemSize.height + \'px\' }"></span>\n\t           </span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ left: clickPos.x + \'px\', height: animateItemSize.height + \'px\', width: animateItemSize.width - clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelist-header-animate-select iui-treelistitem-animate-select-right\': isClicked }" [ngStyle]="{ height: animateItemSize.height + \'px\' }"></span>\n\t            </span>\n\t\t\t</div>\n\t\t\t<div class="iui-treelist-block" [ngStyle]="{ width: blockSize.width + \'px\', height: maxBlockHeight + \'px\' }">\n\t\t\t\t<ul #leftBlock [ngStyle]="{ top: leftBlockPos.top + \'px\', left: leftBlockPos.left + \'px\', width: blockSize.width + \'px\', height: maxBlockHeight + \'px\', opacity: leftBlockOpacity }">\n\t\t            <iui-treelistitem *ngFor="let item of prevList" [allowAnimation]="allowAnimation" [enabled]="item.data.enabled" [text]="item.data.text" [templateRef]="itemTemplate" [data]="item.data" [type]="item.data.type">\n\t\t\t\t\t</iui-treelistitem> \n\t\t\t\t</ul>\n\t\t\t\t<ul #contentBlock [ngStyle]="{ top: blockPos.top + \'px\', left: blockPos.left + \'px\', width: blockSize.width + \'px\', height: blockSize.height + \'px\', opacity: blockOpacity }">\n\t\t            <iui-treelistitem *ngFor="let item of currentList" [allowAnimation]="allowAnimation" [enabled]="item.data.enabled" [text]="item.data.text" [templateRef]="itemTemplate" [data]="item.data" [type]="item.data.type" [indent]="item.indent"  (mouseDown)="onItemMouseDown($event, item.data)" (mouseEnter)="onItemMouseEnter($event, item.data)" (mouseLeave)="onItemMouseLeave($event, item.data)" [state]="getItemState(item.data)" #itemElem>\n\t\t\t\t\t</iui-treelistitem> \n\t\t\t\t</ul>\n\t\t\t\t<ul #rightBlock [ngStyle]="{ top: rightBlockPos.top + \'px\', left: rightBlockPos.left + \'px\', width: blockSize.width + \'px\', height: maxBlockHeight + \'px\', opacity: rightBlockOpacity }">\n\t\t            <iui-treelistitem *ngFor="let item of nextList" [allowAnimation]="allowAnimation" [enabled]="item.data.enabled" [text]="item.data.text" [templateRef]="itemTemplate" [data]="item.data" [type]="item.data.type">\n\t\t\t\t\t</iui-treelistitem> \n\t\t\t\t</ul>\n\t\t\t</div>\n            <iui-scrollbar *ngIf="isVerScrollVisible()" class="iui-treelist-scroll" [ngClass]="{ \'iui-treelist-scroll-available\': isScrollAvailable, \'iui-treelist-scroll-not-available\': !isScrollAvailable }" [enabled]="enabled" [value]="currentScrollPos.y" [max]="maxScrollPos.y" [largeChange]="scrollLargeChange.y" [height]="scrollBarSize.height" (mouseenter)="scrollMouseEnter($event)" (valueChanged)="onVerticalScrollChanged($event)" (scrollStart)="onVerticalScrollStart($event)" (scrollEnd)="onVerticalScrollEnd($event)" #verScroll></iui-scrollbar>\n\t\t</div>\n\t',
inputs:["controlStyle","data","enabled","state"],providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService]}]}],function(){return[{type:i4.IntegralUIDataService},{type:i0.ElementRef},{type:i1.IntegralUICommonService},{type:i0.ComponentFactoryResolver},{type:i2.IntegralUIBaseService}]},{contentList:[{type:core_1.ViewChildren,args:[IntegralUITreeListItem]}],contentRef:[{type:core_1.ViewChild,args:["contentBlock",{read:core_1.ViewContainerRef,"static":!1}]}],
blockElem:[{type:core_1.ViewChild,args:["contentBlock",{read:core_1.ElementRef,"static":!1}]}],headerElem:[{type:core_1.ViewChild,args:["header",{read:core_1.ElementRef,"static":!1}]}],itemElems:[{type:core_1.ViewChildren,args:["itemElem",{read:core_1.ElementRef}]}],leftBlockElem:[{type:core_1.ViewChild,args:["leftBlock",{read:core_1.ElementRef,"static":!1}]}],rightBlockElem:[{type:core_1.ViewChild,args:["rightBlock",{read:core_1.ElementRef,"static":!1}]}],itemTemplate:[{type:core_1.ContentChild,
args:[core_1.TemplateRef,{"static":!1}]}],dataFields:[{type:core_1.Input}],indent:[{type:core_1.Input}],items:[{type:core_1.Input}],mouseWheelSpeed:[{type:core_1.Input}],selectedItem:[{type:core_1.Input}],showScroll:[{type:core_1.Input}],title:[{type:core_1.Input}],afterSelect:[{type:core_1.Output}],beforeSelect:[{type:core_1.Output}],clear:[{type:core_1.Output}],itemAdding:[{type:core_1.Output}],itemAdded:[{type:core_1.Output}],itemRemoving:[{type:core_1.Output}],itemRemoved:[{type:core_1.Output}],
scrollPosChanged:[{type:core_1.Output}],selectionChanged:[{type:core_1.Output}]})})();