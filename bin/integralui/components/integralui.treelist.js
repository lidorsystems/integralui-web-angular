/*
  filename: integralui.treelist.js
  version : 1.6.0
  Copyright Â© 2016-2019 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var e=function(b,d){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var b in d)d.hasOwnProperty(b)&&(c[b]=d[b])};return e(b,d)};return function(b,d){function c(){this.constructor=b}e(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),__decorate=this&&this.__decorate||function(e,b,d,c){var a=arguments.length,f=3>a?b:null===c?c=Object.getOwnPropertyDescriptor(b,d):c,h;
if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(e,b,d,c);else for(var g=e.length-1;0<=g;g--)if(h=e[g])f=(3>a?h(f):3<a?h(b,d,f):h(b,d))||f;return 3<a&&f&&Object.defineProperty(b,d,f),f},__metadata=this&&this.__metadata||function(e,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,b)};Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),IntegralUITreeListItem=function(e){function b(d,c,b){var a=e.call(this,d,c)||this;a.elemRef=d;a.commonService=c;a.baseService=b;a.templateData=[];a.clickPos={x:0,y:0};a.isClicked=!1;a.isHovered=!1;a.parentCtrl=null;return a}__extends(b,e);b.prototype.ngOnInit=function(){this.templateData.push(this.data);
this.parentCtrl=this.baseService.getComponent();this.generalClassName="iui-treelistitem";this.contentClassName=this.generalClassName+"-content";this.initStyle()};b.prototype.onMouseDown=function(d){var c=this;if(c.isEnabled){c.isClicked=!0;c.clickPos=c.commonService.getClientPos(d,c.elemRef.nativeElement.firstElementChild);var b=setTimeout(function(){c.isClicked=!1;clearTimeout(b)},500);c.mouseDown.emit(d)}d.stopPropagation()};b.prototype.onMouseEnter=function(d){this.isEnabled&&(this.state|=integralui_core_1.IntegralUIObjectState.hovered,
this.isHovered=!0,this.mouseEnter.emit(d));d.stopPropagation()};b.prototype.onMouseLeave=function(d){this.isEnabled&&(this.state&=~integralui_core_1.IntegralUIObjectState.hovered,this.mouseLeave.emit(d));this.isHovered=!1;d.stopPropagation()};__decorate([core_1.Input(),__metadata("design:type",Object)],b.prototype,"templateRef",void 0);return b=__decorate([core_1.Component({selector:"iui-treelistitem",template:'\n\t\t<li [ngClass]="{ \'iui-treelistitem-general\': !allowAnimation, \'iui-treelistitem-animate\': allowAnimation, \'iui-treelistitem-animate-enter-suspended\': allowAnimation && isHovered }" (mouseenter)="onMouseEnter($event)" (mousemove)="onMouseMove($event)" (mouseleave)="onMouseLeave($event)">\n\t\t\t<div [ngClass]="getControlClass()" style="position:relative" [ngStyle]="getControlStyle()" (click)="onClick($event)" (mousedown)="onMouseDown($event)" (mouseup)="onMouseUp($event)">\n\t\t\t\t<ng-template ngFor [ngForOf]="templateData" [ngForTemplate]="templateRef"></ng-template>  \n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ height: getSize().height + \'px\', width: clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-left\': isClicked }" [ngStyle]="{ height: getSize().height + \'px\' }"></span>\n\t           </span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ left: clickPos.x + \'px\', height: getSize().height + \'px\', width: getSize().width - clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-right\': isClicked }" [ngStyle]="{ height: getSize().height + \'px\' }"></span>\n\t            </span>\n\t\t\t</div>\n\t\t</li>\n\t',
inputs:"controlStyle data enabled icon name size state text".split(" "),outputs:"click mouseDown mouseEnter mouseLeave mouseMove mouseUp".split(" "),encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[core_1.ElementRef,integralui_common_service_1.IntegralUICommonService,integralui_core_1.IntegralUIBaseService])],b)}(integralui_core_1.IntegralUIItem);exports.IntegralUITreeListItem=IntegralUITreeListItem;
var IntegralUITreeList=function(e){function b(d,c,b,f,h){var a=e.call(this,b)||this;a.dataService=d;a.elemRef=c;a.commonService=b;a.cmpResolver=f;a.baseService=h;a.animateItemSize={width:0,height:0};a.animSpeed=300;a.prevClickedObj=null;a.prevData=null;a.itemData=null;a.nextData=null;a.clickPos={x:0,y:0};a.hoverItem=null;a.isClicked=!1;a.blockPos={top:30,left:0};a.leftBlockPos={top:30,left:-300};a.rightBlockPos={top:30,left:300};a.leftBlockWidth=0;a.blockWidth=0;a.rightBlockWidth=0;a.leftBlockOpacity=
0;a.blockOpacity=1;a.rightBlockOpacity=0;a.elemSize={width:0,height:0};a.currentSelection=null;a.headerItem=null;a.headerText="";a.tRef=null;a.afterSelect=new core_1.EventEmitter;a.beforeSelect=new core_1.EventEmitter;a.clear=new core_1.EventEmitter;a.itemAdding=new core_1.EventEmitter;a.itemAdded=new core_1.EventEmitter;a.itemRemoving=new core_1.EventEmitter;a.itemRemoved=new core_1.EventEmitter;a.selectionChanged=new core_1.EventEmitter;a.selList=[];return a}__extends(b,e);Object.defineProperty(b.prototype,
"selectedItem",{get:function(){return this.currentSelection},set:function(d){var c={cancel:!1,header:this.headerItem,item:d};this.beforeSelect.emit(c);1!=c.cancel&&this.currentSelection!=d&&(this.currentSelection=d,d?d.items&&0<d.items.length&&(this.headerItem=d,this.headerText=d.text):(this.headerItem=null,this.headerText=this.title),this.afterSelect.emit({header:this.headerItem,item:d}),this.selectionChanged.emit(null))},enumerable:!0,configurable:!0});b.prototype.ngOnInit=function(){this.baseService.setComponent(this);
this.dataService.init([{data:this.items}]);this.itemData=this.items;this.headerText=this.title;this.generalClassName="iui-treelist";this.initStyle()};b.prototype.ngAfterViewInit=function(){var d=this;d.blockPos.top=this.headerElem.nativeElement.offsetHeight;d.leftBlockPos.top=this.headerElem.nativeElement.offsetHeight;d.rightBlockPos.top=this.headerElem.nativeElement.offsetHeight;d.animateItemSize={width:this.headerElem.nativeElement.offsetWidth,height:this.headerElem.nativeElement.offsetHeight};
d.elemSize={width:d.elemRef.nativeElement.firstElementChild.clientWidth,height:d.elemRef.nativeElement.firstElementChild.clientHeight};d.leftBlockWidth=d.blockWidth=d.rightBlockWidth=d.elemSize.width;var c=setTimeout(function(){var a=d.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);a&&d.contentRef&&(d.tRef=d.contentRef.createComponent(a));clearTimeout(c)},100)};b.prototype.ngOnDestroy=function(){this.tRef&&this.tRef.destroy()};b.prototype.onItemMouseEnter=function(d,c){this.isEnabled&&
(this.hoverItem=c)};b.prototype.onItemMouseLeave=function(d,c){this.hoverItem=null};b.prototype.onItemMouseDown=function(d,c){if(this.isEnabled&&1==d.buttons&&c){var a=this;if(c.items&&0<c.items.length){a.selList.push(a.headerItem);a.nextData=c.items;var b=0,e=5/a.elemSize.width,g=.5,l=1/a.elemSize.width,k=0;if(a.allowAnimation)var m=setInterval(function(){b<a.elemSize.width?(b+=10,g-=e,k+=l,a.blockPos.left=-b,a.blockOpacity=g,a.rightBlockPos.left=a.elemSize.width-b,a.rightBlockOpacity=k):(a.selectedItem=
c,a.itemData=a.nextData,a.blockPos.left=0,a.blockOpacity=1,a.rightBlockPos.left=a.elemSize.width,a.rightBlockOpacity=0,clearInterval(m))},10);else a.selectedItem=c,a.itemData=a.nextData,a.blockPos.left=0,a.blockOpacity=1,a.rightBlockPos.left=a.elemSize.width,a.rightBlockOpacity=0}else a.selectedItem=c}};b.prototype.onHeaderMouseDown=function(d){var c=this;if(this.isEnabled&&1==d.buttons&&0<c.selList.length){var a=c.selList.length-1;c.prevData=c.selList[a]&&c.selList[a].items?c.selList[a].items:c.items;
var b=0,e=5/c.elemSize.width,g=.5,l=1/c.elemSize.width,k=0;if(c.allowAnimation){var m=setInterval(function(){b<c.elemSize.width?(b+=10,g-=e,k+=l,c.blockPos.left=b,c.blockOpacity=g,c.leftBlockPos.left=b-c.elemSize.width,c.leftBlockOpacity=k):(c.selectedItem=c.selList[a],c.itemData=c.prevData,c.selList.splice(a,1),c.blockPos.left=0,c.blockOpacity=1,c.leftBlockPos.left=-c.elemSize.width,c.leftBlockOpacity=0,clearInterval(m))},10);c.isClicked=!0;c.clickPos=c.commonService.getClientPos(d,c.headerElem.nativeElement);
var n=setTimeout(function(){c.isClicked=!1;clearTimeout(n)},500)}else c.selectedItem=c.selList[a],c.itemData=c.prevData,c.selList.splice(a,1),c.blockPos.left=0,c.blockOpacity=1,c.leftBlockPos.left=-c.elemSize.width,c.leftBlockOpacity=0}};b.prototype.getItemState=function(b){return b==this.selectedItem?integralui_core_1.IntegralUIObjectState.selected:b==this.hoverItem?integralui_core_1.IntegralUIObjectState.hovered:integralui_core_1.IntegralUIObjectState.normal};b.prototype.getControlStyle=function(){var b=
{};0<this.ctrlSize.width&&(b.width=this.ctrlSize.width+"px");0<this.ctrlSize.height&&(b.height=this.ctrlSize.height+"px");return b};__decorate([core_1.ViewChildren(IntegralUITreeListItem),__metadata("design:type",core_1.QueryList)],b.prototype,"contentList",void 0);__decorate([core_1.ViewChild("contentBlock",{read:core_1.ViewContainerRef,"static":!1}),__metadata("design:type",core_1.ViewContainerRef)],b.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("header",{read:core_1.ElementRef,"static":!1}),
__metadata("design:type",core_1.ElementRef)],b.prototype,"headerElem",void 0);__decorate([core_1.ViewChild("leftBlock",{read:core_1.ElementRef,"static":!1}),__metadata("design:type",core_1.ElementRef)],b.prototype,"leftBlockElem",void 0);__decorate([core_1.ViewChild("contentBlock",{read:core_1.ElementRef,"static":!1}),__metadata("design:type",core_1.ElementRef)],b.prototype,"blockElem",void 0);__decorate([core_1.ViewChild("rightBlock",{read:core_1.ElementRef,"static":!1}),__metadata("design:type",
core_1.ElementRef)],b.prototype,"rightBlockElem",void 0);__decorate([core_1.ContentChild(core_1.TemplateRef,{"static":!1}),__metadata("design:type",Object)],b.prototype,"itemTemplate",void 0);__decorate([core_1.Input(),__metadata("design:type",Array)],b.prototype,"items",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],b.prototype,"title",void 0);__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],b.prototype,"selectedItem",null);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"afterSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"beforeSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"clear",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"itemAdding",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],
b.prototype,"itemAdded",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"itemRemoving",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"itemRemoved",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"selectionChanged",void 0);return b=__decorate([core_1.Component({selector:"iui-treelist",template:'\n\t\t<div [ngClass]="getControlClass()">\n\t\t\t<div class="iui-treelist-header" (mousedown)="onHeaderMouseDown($event)" #header>\n                <span class="expand-icons back" *ngIf="headerItem!=null"></span>\n                <span class="iui-treelist-header-title">{{headerText}}</span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ height: animateItemSize.height + \'px\', width: clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-left\': isClicked }" [ngStyle]="{ height: animateItemSize.height + \'px\' }"></span>\n\t           </span>\n\t            <span *ngIf="allowAnimation && isClicked" class="iui-treelistitem-animate-select-block" [ngStyle]="{ left: clickPos.x + \'px\', height: animateItemSize.height + \'px\', width: animateItemSize.width - clickPos.x + \'px\' }">\n\t                <span [ngClass]="{ \'iui-treelistitem-animate-select iui-treelistitem-animate-select-right\': isClicked }" [ngStyle]="{ height: animateItemSize.height + \'px\' }"></span>\n\t            </span>\n\t\t\t</div>\n\t\t\t<ul class="iui-treelist-block" #leftBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': leftBlockPos.top + \'px\', \'left\': leftBlockPos.left + \'px\', \'width\': leftBlockWidth + \'px\', \'opacity\': leftBlockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of prevData" [allowAnimation]="allowAnimation" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t\t<ul class="iui-treelist-block" #contentBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': blockPos.top + \'px\', \'left\': blockPos.left + \'px\', \'width\': blockWidth + \'px\', \'opacity\': blockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of itemData" [allowAnimation]="allowAnimation" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item" (mouseDown)="onItemMouseDown($event, item)" (mouseEnter)="onItemMouseEnter($event, item)" (mouseLeave)="onItemMouseLeave($event, item)" [state]="getItemState(item)">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t\t<ul class="iui-treelist-block" #rightBlock [ngStyle]="{ \'position\': \'absolute\', \'top\': rightBlockPos.top + \'px\', \'left\': rightBlockPos.left + \'px\', \'width\': rightBlockWidth + \'px\', \'opacity\': rightBlockOpacity }">\n\t            <iui-treelistitem *ngFor="let item of nextData" [allowAnimation]="allowAnimation" [enabled]="item.enabled" [text]="item.text" [templateRef]="itemTemplate" [data]="item">\n\t\t\t\t</iui-treelistitem> \n\t\t\t</ul>\n\t\t</div>\n\t',
inputs:["controlStyle","data","enabled","state"],providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService]}),__metadata("design:paramtypes",[integralui_data_service_1.IntegralUIDataService,core_1.ElementRef,integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],b)}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUITreeList=IntegralUITreeList;