/*
  filename: integralui.tooltip.js
  version : 1.4.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d])};return function(b,a){function d(){this.constructor=b}e(b,a);b.prototype=null===a?Object.create(a):(d.prototype=a.prototype,new d)}}();Object.defineProperty(exports,"__esModule",{value:!0});
var core_1=require("@angular/core"),integralui_core_1=require("../components/integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUITooltipComponent=function(e){function b(a,b){var c=e.call(this,b)||this;c.elemRef=a;c.commonService=b;c.showTimer=null;c.popupTimer=null;c.mousePos={x:0,y:0};c.tooltipDisplay="none";c.tooltipPos={top:0,left:0};c.tooltipSize={width:0,height:0};c.closed=new core_1.EventEmitter;c.updateOptions();return c}__extends(b,e);Object.defineProperty(b.prototype,
"options",{get:function(){return this.tooltipOptions},set:function(a){this.updateOptions(a)},enumerable:!0,configurable:!0});b.prototype.updateOptions=function(a){this.tooltipOptions=a?{autoPopDelay:this.commonService.isFieldAvailable(a.autoPopDelay,5E3),enabled:this.commonService.isFieldAvailable(a.enabled,!0),initialDelay:this.commonService.isFieldAvailable(a.initialDelay,500),position:this.commonService.isFieldAvailable(a.position,"mouse"),showMarker:this.commonService.isFieldAvailable(a.showMarker,
!0),title:this.commonService.isFieldAvailable(a.title,"")}:{autoPopDelay:5E3,enabled:!0,initialDelay:500,position:"mouse",showMarker:!0,title:""}};b.prototype.removeTimers=function(){this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null);this.popupTimer&&(clearTimeout(this.popupTimer),this.popupTimer=null)};b.prototype.open=function(a,b){var c=this;c.tooltipPos.top=-9999999;c.tooltipDisplay="block";var d=setTimeout(function(){c.tooltipSize=c.getSize();c.tooltipDisplay="none";c.removeTimers();
c.tooltipOptions.enabled&&""!=c.tooltipOptions.title&&(c.showTimer=setTimeout(function(){c.show(a,b);c.popupTimer=setTimeout(function(){c.closed.emit(null);clearTimeout(c.popupTimer)},c.tooltipOptions.autoPopDelay);clearTimeout(c.showTimer)},c.tooltipOptions.initialDelay));clearTimeout(d)},1)};b.prototype.show=function(a,b){this.tooltipPos={top:this.mousePos.y+24,left:this.mousePos.x};switch(this.tooltipOptions.position){case "above":this.tooltipPos={top:a.top-4-this.tooltipSize.height,left:a.left+
Math.floor((b.width-this.tooltipSize.width)/2)};break;case "below":this.tooltipPos={top:a.bottom+4,left:a.left+Math.floor((b.width-this.tooltipSize.width)/2)};break;case "left":this.tooltipPos={top:a.top+Math.floor((b.height-this.tooltipSize.height)/2),left:a.left-4-this.tooltipSize.width};break;case "right":this.tooltipPos={top:a.top+Math.floor((b.height-this.tooltipSize.height)/2),left:a.right+4}}this.tooltipDisplay="block"};b.prototype.getSize=function(){return{width:this.elemRef.nativeElement.firstElementChild.offsetWidth,
height:this.elemRef.nativeElement.firstElementChild.offsetHeight}};b.prototype.updateMousePos=function(a){this.mousePos!=a&&(this.mousePos=a)};b.prototype.updateControlClass=function(){this.ctrlClass.length=0;this.ctrlClass.push("iui-tooltip");if(this.tooltipOptions.showMarker)switch(this.tooltipOptions.position){case "above":this.ctrlClass.push("iui-tooltip-marker-bottom");break;case "right":this.ctrlClass.push("iui-tooltip-marker-left");break;case "below":this.ctrlClass.push("iui-tooltip-marker-top");
break;case "left":this.ctrlClass.push("iui-tooltip-marker-right")}};b.decorators=[{type:core_1.Component,args:[{selector:"iui-tooltip",template:"\n\t\t<div class=\"iui-tooltip\" [ngClass]=\"getControlClass()\" [ngStyle]=\"{ 'display': tooltipDisplay, 'top': tooltipPos.top + 'px', 'left': tooltipPos.left + 'px' }\" style=\"opacity:1 !important\">{{tooltipOptions.title}}</div>\n\t",inputs:["controlStyle","data","state"],encapsulation:core_1.ViewEncapsulation.None}]}];b.ctorParameters=function(){return[{type:core_1.ElementRef},
{type:integralui_common_service_1.IntegralUICommonService}]};b.propDecorators={options:[{type:core_1.Input}],closed:[{type:core_1.Output}]};return b}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUITooltipComponent=IntegralUITooltipComponent;
var IntegralUITooltip=function(){function e(b,a,d){this.elemRef=b;this.cmpResolver=a;this.commonService=d;this.eventList=[];this.cmpRef=null}e.prototype.closeTooltip=function(){this.cmpRef&&(this.eventList&&this.eventList.forEach(function(b){return b.unsubscribe()}),this.cmpRef.destroy())};e.prototype.getSize=function(){return{width:this.elemRef.nativeElement.offsetWidth,height:this.elemRef.nativeElement.offsetHeight}};e.prototype.onMouseEnter=function(b){var a=this,d=a.tooltipRef?a.tooltipRef:a.settings.appRef;
if(d){a.closeTooltip();var c=a.cmpResolver.resolveComponentFactory(IntegralUITooltipComponent);c&&(a.cmpRef=d.createComponent(c),a.cmpRef&&(d=null,a.cmpRef._component?d=a.cmpRef._component:a.cmpRef._hostElement&&(d=a.cmpRef._hostElement.component),d&&(d.options=a.settings,d.updateMousePos(a.commonService.getMousePos(b)),b=this.elemRef.nativeElement.getBoundingClientRect(),d.open(b,a.getSize()),a.eventList.push(d.closed.subscribe(function(b){a.closeTooltip()})))))}};e.prototype.onMouseLeave=function(b){this.closeTooltip()};
e.prototype.onMouseMove=function(b){if(this.cmpRef)if(this.cmpRef._component){var a=this.cmpRef._component;a.updateMousePos(this.commonService.getMousePos(b))}else this.cmpRef&&this.cmpRef._hostElement&&(a=this.cmpRef._hostElement.component,a.updateMousePos(this.commonService.getMousePos(b)))};e.decorators=[{type:core_1.Directive,args:[{selector:"[iuiTooltip]"}]}];e.ctorParameters=function(){return[{type:core_1.ElementRef},{type:core_1.ComponentFactoryResolver},{type:integralui_common_service_1.IntegralUICommonService}]};
e.propDecorators={settings:[{type:core_1.Input,args:["iuiTooltip"]}],tooltipRef:[{type:core_1.Input}],onMouseEnter:[{type:core_1.HostListener,args:["mouseenter",["$event"]]}],onMouseLeave:[{type:core_1.HostListener,args:["mouseleave",["$event"]]}],onMouseMove:[{type:core_1.HostListener,args:["mousemove",["$event"]]}]};return e}();exports.IntegralUITooltip=IntegralUITooltip;